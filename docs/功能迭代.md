# 功能迭代

<!-- changelog:start -->
## 2026-01-25
### 新增
- [skills][公文写作] 新增一键嵌图 DOCX 转换脚本并补充使用说明
- [web][debug] 调试面板新增长对话稳定性预设与自动化执行
### 变更
- [skills][公文写作] 合并嵌图流程到 convert_markdown_to_docx 并移除独立嵌图脚本
- [web][debug] 调试面板模型输出轮次展示补齐总轮次/用户轮次/模型轮次三段信息
- [skills][公文写作] 一键转换脚本自动将 SVG 渲染为高分辨率 PNG 并移除手动嵌图说明
- [web][useraccounts] 用户管理设置的用户权限改为下拉选择 user/admin
- [backend][api] 事件流与会话事件移除 round 兼容字段，仅保留 user_round/model_round。
- [轮次] 明确用户轮次与模型轮次定义并在事件流监控与会话事件中补充 user_round/model_round 字段
- [web][debug] 增强长对话稳定性测试为图表与打包自动化流程
- [web][debug] 增强长对话稳定性测试题目难度与步骤
- [web][debug] 调试面板将长对话稳定性测试折叠为按钮并隐藏流式/新会话/锁定工具集选项
### 修复
- [skills][公文写作] 清理样式主题字体并同步字符样式，避免标题回退到 MS 字体
- [backend][orchestrator] 修复上下文压缩在附件场景下可能遗漏当前问题，并裁剪摘要以确保回填后占用可控
- [skills][公文写作] pandoc 输出后补齐正文/标题样式字体并统一表格边框
- [web][debug] 调试面板 Token 占用改用上下文占用并补充计费 Token 消耗展示
- [web][debug] 调试面板统计信息 Token 文案改为占用用于上下文占用提示
- [skills][公文写作] 一键嵌图脚本优先复用已有 PNG 并修正 SVG 处理逻辑
- [web][debug] 调整调试面板模型输出按模型轮次渲染并展示用户轮次，避免不同用户轮次混淆
- [docs][web] 调整 docx 图片段落行距避免遮挡
- [web][backend] 修复管理端监控线程详情解码速度统计，按轮次累计排除工具耗时，并修复管理端中文文案乱码
- [docs][web] 修复 docx 表格样式与图片排版问题
- [frontend] 美化浅色主题系统提示词预览关闭按钮悬停交互样式
- [frontend] 浅色主题系统提示词预览关闭按钮补充悬停交互
- [frontend] 浅色主题下系统提示词预览关闭按钮改为浅色样式
- [skills][公文写作] 公文写作脚本识别已有标题编号避免重复编号
- [frontend][workspace] 用户侧临时文件区 SVG 预览改用 content 接口构建
- [frontend][workspace] 用户侧临时文件区 SVG 预览改用 iframe 并补白底
- [web][workspace] LSP 工作区双击非文本文件时改为预览而非编辑
- [web][frontend][workspace] 改用 Blob MIME 修正方式提升 SVG 预览兼容性
- [frontend][workspace] 用户侧临时文件区 SVG 预览补齐 MIME 处理
- [web][workspace] 修复临时文件区 SVG 预览未正确显示的问题
- [web][frontend] 修复管理端线程详情耗时与统计信息展示，并校准用户端会话耗时为完整交互时长
- [backend][orchestrator] 补齐工具执行结果截断与输出统计辅助，修正 llm_output_delta 回放过滤测试

### 性能
- [mcp][backend] MCP 工具清单拉取增加短 TTL 缓存，降低重复刷新开销
### 文档
- [skills][公文写作] 将图片段落修正流程设为必做并提供修复脚本
- [skills][公文写作] 补充 Linux 下 pandoc resource path 分隔与示例
- [skills][公文写作] 补充 pandoc 嵌图流程与图片段落排版说明
- [docs][web] 使用 pandoc 嵌入论文图示生成 docx
- [docs][web] 修复工具管理流程图中文乱码，新增 Agent Loop 图并同步论文 docx
- [docs][系统优化] 补充节点任务拆解与发布门槛三件套
- [docs][系统优化] 深化系统优化方案的可行性评估与节点细化
- [docs][系统优化] 补充系统优化方案的深入分析与持续推进节点
- [docs][web] 补充论文多轮对话 Agent Loop 与长期稳定运行方法说明
- [docs] 修复系统优化方案与设计/API文档中审批与缓存描述的乱码与字段说明
- [docs] 更新系统优化方案节点状态并补充审批缓存/MCP 缓存说明
- [docs] 同步 exec_policy_mode 与 context_usage/tool_result 事件说明
### 安全
- [backend][exec_policy] exec_policy 高风险命令支持审批标记与会话级缓存
## 2026-01-24
### 变更
- [管理端][性能测试] 性能测试增加权限/工具解析耗时指标
- [admin] 技能管理选择技能时默认打开 SKILL.md
- [admin] 内部状态热力图问询面板使用提问图标
- [skills][eva_skills] EVA_SKILLS 技能目录与名称统一为中文（公文写作、MCP服务构建、PDF处理、PPTX生成、SVG生成、技能创建器、电子表格处理）
### 修复
- [skills][公文写作] Markdown 转 DOCX 标题字体未按配置生效的问题
### 性能
- [sandbox][command_exec] 沙盒命令执行支持异步子进程，减少高并发排队
- [sandbox] 为沙盒命令执行增加线程池与 worker 可配置项
- [backend] 缓存工具路径根目录，减少高并发文件操作的路径归一化开销
### 文档
- [docs][系统优化] 新增系统优化方案文档
- [docs] 同步论文与架构图副本
- [docs] 更新架构图 SVG 与用户前端文档中的模块路径说明
- [docs] 更新设计/系统/API 文档与性能优化说明，补充 sandbox 模式与 prompts 路径。
- [docs] 补充沙盒命令执行并发优化说明
- [docs] 补充工具路径根目录缓存优化说明与指导
- [docs] 在AGENTS.md补充功能迭代类型清单
- [docs] 迁移旧记录至功能迭代-old.md并将记录规范移至AGENTS.md
- [docs][scripts] 建立分类化变更记录规范并升级写入脚本。
### 重构
- [backend][src] 整理 src 目录结构为 core/services/ops/sandbox，并移除未使用的旧后端代理代码。
- [sandbox][backend] 沙盒服务改为 Rust sandbox 模式运行，移除 app 并将提示词迁移至 prompts/。
### 工程
- [docker][sandbox] docker compose 改为由 sandbox 先编译共享产物，主服务直接启动 wunder-server。
- [infra] 补充沙盒并发调优环境变量示例
<!-- changelog:end -->

