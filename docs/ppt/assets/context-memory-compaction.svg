<svg width="1200" height="720" viewBox="0 0 1200 720" fill="none" xmlns="http://www.w3.org/2000/svg">
<defs>
  <linearGradient id="bg-memory" x1="0" y1="0" x2="1200" y2="720" gradientUnits="userSpaceOnUse">
    <stop offset="0" stop-color="#F8FBFF"/>
    <stop offset="1" stop-color="#EEF5FF"/>
  </linearGradient>
  <filter id="shadow-memory" x="-20%" y="-20%" width="140%" height="140%">
    <feDropShadow dx="0" dy="8" stdDeviation="10" flood-color="#0F1C33" flood-opacity="0.12"/>
  </filter>
  <marker id="arrow-memory" markerWidth="10" markerHeight="10" refX="7" refY="3" orient="auto">
    <path d="M0,0 L0,6 L8,3 z" fill="#3D73E6"/>
  </marker>
  <style>
    .ttl { font: 700 34px 'Microsoft YaHei','PingFang SC','Noto Sans SC',sans-serif; fill: #1C2840; }
    .sub { font: 500 19px 'Microsoft YaHei','PingFang SC','Noto Sans SC',sans-serif; fill: #556681; }
    .h3 { font: 700 21px 'Microsoft YaHei','PingFang SC','Noto Sans SC',sans-serif; fill: #1F2A44; }
    .body { font: 500 16px 'Microsoft YaHei','PingFang SC','Noto Sans SC',sans-serif; fill: #5C6F8F; }
    .cap { font: 600 15px 'Microsoft YaHei','PingFang SC','Noto Sans SC',sans-serif; fill: #2A3F66; }
  </style>
</defs>

<rect x="18" y="18" width="1164" height="684" rx="28" fill="url(#bg-memory)" stroke="#DCE6F5"/>

<text x="600" y="86" text-anchor="middle" class="ttl">上下文压缩与长期记忆</text>
<text x="600" y="124" text-anchor="middle" class="sub">长会话通过结构化摘要与记忆注入保持稳定续航</text>

<g filter="url(#shadow-memory)">
  <rect x="70" y="180" width="600" height="370" rx="20" fill="#FFFFFF" stroke="#D8E4F5"/>
</g>
<text x="110" y="218" class="cap">压缩主流程</text>

<rect x="100" y="236" width="540" height="72" rx="12" fill="#F7FBFF" stroke="#DCE7F5"/>
<text x="130" y="268" class="h3">1. 上下文预算检查</text>
<text x="130" y="292" class="body">监测占用阈值与溢出风险</text>
<line x1="370" y1="309" x2="370" y2="330" stroke="#3D73E6" stroke-width="2.2" marker-end="url(#arrow-memory)"/>

<rect x="100" y="332" width="540" height="72" rx="12" fill="#F7FBFF" stroke="#DCE7F5"/>
<text x="130" y="364" class="h3">2. 触发结构化压缩</text>
<text x="130" y="388" class="body">生成摘要并保留关键轨迹</text>
<line x1="370" y1="405" x2="370" y2="426" stroke="#3D73E6" stroke-width="2.2" marker-end="url(#arrow-memory)"/>

<rect x="100" y="428" width="540" height="72" rx="12" fill="#F7FBFF" stroke="#DCE7F5"/>
<text x="130" y="460" class="h3">3. 重建可用上下文</text>
<text x="130" y="484" class="body">继续执行后续模型与工具调用</text>

<g filter="url(#shadow-memory)">
  <rect x="710" y="180" width="420" height="370" rx="20" fill="#FFFFFF" stroke="#D8E4F5"/>
</g>
<text x="740" y="218" class="cap">长期记忆侧链</text>

<rect x="740" y="240" width="360" height="84" rx="12" fill="#F5FAFF" stroke="#DCE7F5"/>
<text x="770" y="274" class="h3">记忆写入时机</text>
<text x="770" y="300" class="body">最终回复完成后异步总结</text>

<rect x="740" y="340" width="360" height="84" rx="12" fill="#F5FAFF" stroke="#DCE7F5"/>
<text x="770" y="374" class="h3">记忆治理策略</text>
<text x="770" y="400" class="body">条目可控、可删、可关闭注入</text>

<rect x="740" y="440" width="360" height="84" rx="12" fill="#F5FAFF" stroke="#DCE7F5"/>
<text x="770" y="474" class="h3">统计口径说明</text>
<text x="770" y="500" class="body">token 统计的是上下文占用量</text>

<g filter="url(#shadow-memory)">
  <rect x="70" y="570" width="1060" height="92" rx="16" fill="#FFFFFF" stroke="#D8E4F5"/>
</g>
<text x="600" y="610" text-anchor="middle" class="h3">压缩负责“续航”，记忆负责“延续”</text>
<text x="600" y="638" text-anchor="middle" class="body">两者配合把长对话从一次性会话变成可持续任务链路</text>
</svg>
