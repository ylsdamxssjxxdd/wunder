<svg width="1200" height="720" viewBox="0 0 1200 720" fill="none" xmlns="http://www.w3.org/2000/svg">
<defs>
<linearGradient id="gstreaming-ws-sse" x1="0" y1="0" x2="1200" y2="720" gradientUnits="userSpaceOnUse">
<stop offset="0" stop-color="#F8FCFF"/>
<stop offset="1" stop-color="#EAF6FF"/>
</linearGradient>
<filter id="shadowstreaming-ws-sse" x="-20%" y="-20%" width="140%" height="140%">
<feDropShadow dx="0" dy="8" stdDeviation="10" flood-color="#0F1C33" flood-opacity="0.12"/>
</filter>
<marker id="arrowstreaming-ws-sse" markerWidth="10" markerHeight="10" refX="7" refY="3" orient="auto">
<path d="M0,0 L0,6 L8,3 z" fill="#2E86D3"/>
</marker>
<style>
.ttl { font: 700 34px 'Microsoft YaHei','PingFang SC','Noto Sans SC',sans-serif; fill: #1C2840; }
.sub { font: 500 19px 'Microsoft YaHei','PingFang SC','Noto Sans SC',sans-serif; fill: #556681; }
.h3 { font: 700 22px 'Microsoft YaHei','PingFang SC','Noto Sans SC',sans-serif; fill: #1F2A44; }
.body { font: 500 17px 'Microsoft YaHei','PingFang SC','Noto Sans SC',sans-serif; fill: #5C6F8F; }
.cap { font: 600 16px 'Microsoft YaHei','PingFang SC','Noto Sans SC',sans-serif; fill: #2A3F66; }
.small { font: 500 14px 'Microsoft YaHei','PingFang SC','Noto Sans SC',sans-serif; fill: #6A7A95; }
</style>
</defs>
<rect x="18" y="18" width="1164" height="684" rx="28" fill="url(#gstreaming-ws-sse)" stroke="#DCE6F5"/>
<text x="600" y="86" text-anchor="middle" class="ttl">
<tspan x="600" dy="0">流式策略：WebSocket 优先，SSE 兜底</tspan>
</text>
<text x="600" y="124" text-anchor="middle" class="sub">
<tspan x="600" dy="0">兼顾实时体验、兼容接入与断线恢复</tspan>
</text>
<rect x="90" y="182" width="1020" height="90" rx="14" fill="#FFFFFF" stroke="#D7E3F4"/>
<rect x="102" y="194" width="164" height="66" rx="10" fill="#2E86D3" fill-opacity="0.14"/>
<text x="184" y="234" text-anchor="middle" class="cap">
<tspan x="184" dy="0">WS 主通道</tspan>
</text>
<rect x="290" y="198" width="166" height="58" rx="10" fill="#F9FCFF" stroke="#DCE7F5"/>
<text x="373.0" y="234" text-anchor="middle" class="body">
<tspan x="373.0" dy="0">握手 ready</tspan>
</text>
<line x1="456" y1="227" x2="468" y2="227" stroke="#2E86D3" stroke-width="2" marker-end="url(#arrowstreaming-ws-sse)"/>
<rect x="472" y="198" width="166" height="58" rx="10" fill="#F9FCFF" stroke="#DCE7F5"/>
<text x="555.0" y="234" text-anchor="middle" class="body">
<tspan x="555.0" dy="0">事件实时推送</tspan>
</text>
<line x1="638" y1="227" x2="650" y2="227" stroke="#2E86D3" stroke-width="2" marker-end="url(#arrowstreaming-ws-sse)"/>
<rect x="654" y="198" width="166" height="58" rx="10" fill="#F9FCFF" stroke="#DCE7F5"/>
<text x="737.0" y="234" text-anchor="middle" class="body">
<tspan x="737.0" dy="0">低延迟交互</tspan>
</text>
<rect x="90" y="290" width="1020" height="90" rx="14" fill="#FFFFFF" stroke="#D7E3F4"/>
<rect x="102" y="302" width="164" height="66" rx="10" fill="#2E86D3" fill-opacity="0.14"/>
<text x="184" y="342" text-anchor="middle" class="cap">
<tspan x="184" dy="0">SSE 兜底</tspan>
</text>
<rect x="290" y="306" width="166" height="58" rx="10" fill="#F9FCFF" stroke="#DCE7F5"/>
<text x="373.0" y="342" text-anchor="middle" class="body">
<tspan x="373.0" dy="0">兼容老客户端</tspan>
</text>
<line x1="456" y1="335" x2="468" y2="335" stroke="#2E86D3" stroke-width="2" marker-end="url(#arrowstreaming-ws-sse)"/>
<rect x="472" y="306" width="166" height="58" rx="10" fill="#F9FCFF" stroke="#DCE7F5"/>
<text x="555.0" y="342" text-anchor="middle" class="body">
<tspan x="555.0" dy="0">最小改造接入</tspan>
</text>
<line x1="638" y1="335" x2="650" y2="335" stroke="#2E86D3" stroke-width="2" marker-end="url(#arrowstreaming-ws-sse)"/>
<rect x="654" y="306" width="166" height="58" rx="10" fill="#F9FCFF" stroke="#DCE7F5"/>
<text x="737.0" y="342" text-anchor="middle" class="body">
<tspan x="737.0" dy="0">稳定输出</tspan>
</text>
<rect x="90" y="398" width="1020" height="90" rx="14" fill="#FFFFFF" stroke="#D7E3F4"/>
<rect x="102" y="410" width="164" height="66" rx="10" fill="#2E86D3" fill-opacity="0.14"/>
<text x="184" y="450" text-anchor="middle" class="cap">
<tspan x="184" dy="0">事件回放</tspan>
</text>
<rect x="290" y="414" width="166" height="58" rx="10" fill="#F9FCFF" stroke="#DCE7F5"/>
<text x="373.0" y="450" text-anchor="middle" class="body">
<tspan x="373.0" dy="0">stream_events</tspan>
<tspan x="373.0" dy="24">入库</tspan>
</text>
<line x1="456" y1="443" x2="468" y2="443" stroke="#2E86D3" stroke-width="2" marker-end="url(#arrowstreaming-ws-sse)"/>
<rect x="472" y="414" width="166" height="58" rx="10" fill="#F9FCFF" stroke="#DCE7F5"/>
<text x="555.0" y="450" text-anchor="middle" class="body">
<tspan x="555.0" dy="0">after_event_</tspan>
<tspan x="555.0" dy="24">id</tspan>
</text>
<line x1="638" y1="443" x2="650" y2="443" stroke="#2E86D3" stroke-width="2" marker-end="url(#arrowstreaming-ws-sse)"/>
<rect x="654" y="414" width="166" height="58" rx="10" fill="#F9FCFF" stroke="#DCE7F5"/>
<text x="737.0" y="450" text-anchor="middle" class="body">
<tspan x="737.0" dy="0">断点续传</tspan>
</text>
<rect x="100" y="520" width="330" height="96" rx="14" fill="#FFFFFF" stroke="#D7E3F4"/>
<text x="265" y="560" text-anchor="middle" class="small">
<tspan x="265" dy="0">协议统一降低前端复杂度</tspan>
</text>
<rect x="455" y="520" width="330" height="96" rx="14" fill="#FFFFFF" stroke="#D7E3F4"/>
<text x="620" y="560" text-anchor="middle" class="small">
<tspan x="620" dy="0">网络波动不丢关键事件</tspan>
</text>
<rect x="810" y="520" width="330" height="96" rx="14" fill="#FFFFFF" stroke="#D7E3F4"/>
<text x="975" y="560" text-anchor="middle" class="small">
<tspan x="975" dy="0">任务执行与连接状态解耦</tspan>
</text>
</svg>
