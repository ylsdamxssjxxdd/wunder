---
名称: official-doc-writing
描述: 公文/通知/请示/报告等官方文书的写作与排版。适用于先输出 Markdown 再转换为符合党政机关公文规范的 DOCX。
---

# 公文写作（Markdown -> DOCX）
## 概要
本技能用于将公文内容先以 Markdown 结构化输出，再通过脚本转换为标准 DOCX。优先保证结构清晰、格式可控、结果可复用。

## 快速流程
1. 明确公文要素：标题、主送、正文、附件、落款、日期、抄送、印发等。
2. 输出 Markdown 文本（结构见下）。
3. 保存为 `.md` 文件。
4. 运行 `scripts/convert_markdown_to_docx.py` 生成 DOCX。

## Markdown 结构约束
- `#` 只出现一次，为主标题，不自动编号。
- `##` 为一级标题（自动补“一、”）。
- `###` 为二级标题（自动补“（一）”）。
- `####` 为三级标题（自动补“1.”）。
- `#####` 为四级标题（自动补“（4）”）。
- 需要自定义编号时请在标题中直接写编号，转换器会保留。
- 正文不要手动硬换行，连续文本行会自动合并；空行代表新段落。
- 需要强制换行时在行末使用 `<br>`、`\\` 或两个空格。

## 版式规范（内置对齐）
- 纸张：A4。
- 页边距：上 37mm、下 35mm、左 28mm、右 26mm。
- 正文：仿宋GB2312 三号，首行左空二字，行距固定 28.9 磅。
- 标题：2号方正小标宋简体，居中。
- 一级标题：黑体三号；二级标题：楷体GB2312三号；三级/四级标题：仿宋GB2312三号。
- 数字：默认 Times New Roman。

## 版头要素（可选，置于标题之前）
使用“键：值”单行写法，转换器会识别并排版：
- `份号：000001`
- `密级：机密★20年`
- `紧急程度：特急`
- `发文机关标志：国务院文件`
- `发文字号：国办发〔2026〕6号`
- `签发人：张三`

说明：版头要素可选，缺省时不会自动插入红线。

红色分隔线触发条件：
- 当检测到版头要素且首次出现主标题时，会在主标题前插入一条红色分隔线（仅一次）。
- 文本中出现 `---`（或 `***`/`___`）会插入红线。
- 若使用 `--reference-doc` 自定义模板或 `--use-pandoc`，模板内的页眉/分隔线也可能导致“每页顶部有红线”。如遇此情况，请检查模板或移除多余分隔线。

## 主体结构建议（均为可选要素）
- 主送机关：以 `主送：` 行表示（顶格，不缩进）。
- 正文段落：保持自然段落即可，首行会自动缩进。
- 附件说明：使用 `附件：` 行。
- 落款与日期：用 `落款：` 开启右对齐块，后续非空行将右对齐直到空行。
- 抄送机关与印发：使用 `抄送：` / `印发：` 行。

## 表格
使用标准 Markdown 表格语法，转换器会生成真正的 Word 表格：
```
| 项目 | 说明 |
| --- | --- |
| 事项A | 内容A |
| 事项B | 内容B |
```

## 最小示例
```
份号：000001
密级：机密★20年
紧急程度：特急
发文机关标志：国务院文件
发文字号：国办发〔2026〕6号
签发人：张三

# 关于开展年度检查的通知

主送：各业务部门：

## 正文
为规范管理，现开展年度检查，具体要求如下：
- 检查时间：2026年3月1日至2026年3月15日
- 检查范围：全体业务部门

附件：1. 年度检查清单

落款：
XX单位
2026年2月10日

抄送：人事部、财务部。
印发：综合办公室 2026年2月10日印发
```

## 转换脚本
脚本位置：`scripts/convert_markdown_to_docx.py`

基础用法：
```
python scripts/convert_markdown_to_docx.py draft.md --output draft.docx
```

常用参数：
- `--font`：正文字体（默认 `仿宋GB2312`）
- `--font-size`：正文字号（默认 `16`）
- `--title-font`：标题字体（默认 `方正小标宋简体`）
- `--title-size`：标题字号（默认 `22`）
- `--heading1-font`：一级标题字体（默认 `黑体`）
- `--heading2-font`：二级标题字体（默认 `楷体GB2312`）
- `--heading3-font`：三级标题字体（默认 `仿宋GB2312`）
- `--heading4-font`：四级标题字体（默认 `仿宋GB2312`）
- `--heading-size`：标题字号（默认 `16`）
- `--digit-font`：数字字体（默认 `Times New Roman`）
- `--line-spacing-pt`：固定行距（默认 `28.9`）
- `--chars-per-line`：字符网格宽度（默认 `28`）
- `--no-doc-grid`：关闭字符网格
- `--no-page-number`：不插入页码
- `--page-number-font`：页码字体（默认 `宋体`）
- `--page-number-size`：页码字号（默认 `14`）
- `--use-pandoc`：使用 pandoc 转换（默认内置转换器）
- `--reference-doc`：自定义参考模板 `.docx`

## 注意事项
- 多行标题的“梯形/菱形”排列需在 Word 中微调。
- 若字体未安装，Word 会自动替换字体；在 Docker 环境需先安装字体。
- 严格版记位置、双面印刷与装订要求需在排版阶段最终校对。

## 质量检查
- 标题是否居中，版头要素是否完整。
- 主送/落款/日期是否位置正确。
- 行距、字号、页边距是否符合规范。
- 最终交付建议导出 PDF 复核。
