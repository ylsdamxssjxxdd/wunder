<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title data-i18n="page.title">WUNDER 终端</title>
    <link
      rel="icon"
      type="image/svg+xml"
      href="./third/fontawesome-free-6.7.2-web/svgs/solid/dragon.svg"
    />
    <link
      rel="stylesheet"
      href="./third/fontawesome-free-6.7.2-web/css/fontawesome.min.css"
    />
    <link
      rel="stylesheet"
      href="./third/fontawesome-free-6.7.2-web/css/solid.min.css"
    />
    <link rel="stylesheet" href="./app.css?v=20260124-04" />
  </head>
  <body>
    <div class="app">
      <aside class="sidebar">
        <button id="sidebarTitle" class="sidebar-title" type="button">
          <i class="fa-solid fa-dragon"></i>
          <span data-i18n="sidebar.title">WUNDER 终端</span>
        </button>
        <div class="sidebar-nav">
          <div class="nav-group" data-group="system">
            <button class="nav-group-btn" type="button">
              <i class="fa-solid fa-server"></i>
              <span data-i18n="sidebar.group.system">系统</span>
              <i class="fa-solid fa-chevron-down nav-group-caret" aria-hidden="true"></i>
            </button>
            <div class="nav-children">
              <button id="navMonitor" class="nav-btn active">
                <i class="fa-solid fa-heart"></i>
                <span data-i18n="panel.monitor">内部状态</span>
              </button>
              <button id="navUsers" class="nav-btn">
                <i class="fa-solid fa-robot"></i>
                <span data-i18n="panel.users">线程管理</span>
              </button>
              <button id="navUserAccounts" class="nav-btn">
                <i class="fa-solid fa-user-gear"></i>
                <span data-i18n="panel.userAccounts">用户管理</span>
              </button>
              <button id="navOrgUnits" class="nav-btn">
                <i class="fa-solid fa-sitemap"></i>
                <span data-i18n="panel.orgUnits">单位管理</span>
              </button>
              <button id="navMemory" class="nav-btn">
                <i class="fa-solid fa-brain"></i>
                <span data-i18n="panel.memory">记忆管理</span>
              </button>
              <button id="navLlm" class="nav-btn">
                <i class="fa-solid fa-sliders"></i>
                <span data-i18n="panel.llm">模型配置</span>
              </button>
              <button id="navSettings" class="nav-btn">
                <i class="fa-solid fa-gear"></i>
                <span data-i18n="panel.settings">系统设置</span>
              </button>
            </div>
          </div>
          <div class="nav-group" data-group="tools">
            <button class="nav-group-btn" type="button">
              <i class="fa-solid fa-toolbox"></i>
              <span data-i18n="sidebar.group.tools">工具</span>
              <i class="fa-solid fa-chevron-down nav-group-caret" aria-hidden="true"></i>
            </button>
            <div class="nav-children">
              <button id="navBuiltin" class="nav-btn">
                <i class="fa-solid fa-tools"></i>
                <span data-i18n="panel.builtin">内置工具</span>
              </button>
              <button id="navMcp" class="nav-btn">
                <i class="fa-solid fa-plug"></i>
                <span data-i18n="panel.mcp">MCP 服务</span>
              </button>
              <button id="navKnowledge" class="nav-btn">
                <i class="fa-solid fa-book"></i>
                <span data-i18n="panel.knowledge">知识库</span>
              </button>
              <button id="navA2aServices" class="nav-btn">
                <i class="fa-solid fa-diagram-project"></i>
                <span data-i18n="panel.a2aServices">A2A 服务</span>
              </button>
              <button id="navSkills" class="nav-btn">
                <i class="fa-solid fa-wand-magic-sparkles"></i>
                <span data-i18n="panel.skills">技能管理</span>
              </button>
            </div>
          </div>
          <div class="nav-group" data-group="debug">
            <button class="nav-group-btn" type="button">
              <i class="fa-solid fa-bug"></i>
              <span data-i18n="sidebar.group.debug">调试</span>
              <i class="fa-solid fa-chevron-down nav-group-caret" aria-hidden="true"></i>
            </button>
            <div class="nav-children">
              <button id="navThroughput" class="nav-btn">
                <i class="fa-solid fa-gauge-high"></i>
                <span data-i18n="panel.throughput">吞吐量测试</span>
              </button>
              <button id="navPerformance" class="nav-btn">
                <i class="fa-solid fa-chart-line"></i>
                <span data-i18n="panel.performance">性能测试</span>
              </button>
              <button id="navPrompt" class="nav-btn">
                <i class="fa-solid fa-file-lines"></i>
                <span data-i18n="panel.prompt">系统提示词</span>
              </button>
              <button id="navEvaluation" class="nav-btn">
                <i class="fa-solid fa-list-check"></i>
                <span data-i18n="panel.evaluation">能力评估</span>
              </button>
              <button id="navDebug" class="nav-btn">
                <i class="fa-solid fa-bug"></i>
                <span data-i18n="panel.debug">调试面板</span>
              </button>
              <button id="navLsp" class="nav-btn">
                <i class="fa-solid fa-code"></i>
                <span data-i18n="panel.lsp">LSP</span>
              </button>
            </div>
          </div>
          <div class="nav-group" data-group="docs">
            <button class="nav-group-btn" type="button">
              <i class="fa-solid fa-book-open"></i>
              <span data-i18n="sidebar.group.docs">文档</span>
              <i class="fa-solid fa-chevron-down nav-group-caret" aria-hidden="true"></i>
            </button>
            <div class="nav-children">
              <button id="navIntro" class="nav-btn">
                <i class="fa-solid fa-display"></i>
                <span data-i18n="panel.intro">幻灯片</span>
              </button>
              <button id="navPaper" class="nav-btn">
                <i class="fa-solid fa-file-lines"></i>
                <span data-i18n="panel.paper">论文</span>
              </button>
              <button id="navApiDocs" class="nav-btn">
                <i class="fa-solid fa-file-code"></i>
                <span data-i18n="panel.apiDocs">接口</span>
              </button>
            </div>
          </div>
        </div>
      </aside>
      <main class="content">
        <section id="monitorPanel" class="panel active">
          <div class="list-header">
            <h1 data-i18n="panel.monitor">内部状态</h1>
            <div class="header-actions monitor-header-actions">
              <div class="header-input monitor-time-filter">
                <label data-i18n="monitor.filter.title">筛选时间</label>
                <label class="monitor-filter-toggle">
                  <input id="monitorTimeFilterToggle" type="checkbox" />
                  <span data-i18n="monitor.filter.enable">启用</span>
                </label>
                <input id="monitorTimeStart" type="datetime-local" />
                <span class="monitor-time-sep">-</span>
                <input id="monitorTimeEnd" type="datetime-local" />
              </div>
              <div class="header-input monitor-time-range">
                <label for="monitorTimeRange" data-i18n="monitor.range.label">监视时间</label>
                <input
                  id="monitorTimeRange"
                  type="number"
                  min="0.1"
                  step="0.1"
                  placeholder="默认 3"
                  data-i18n-placeholder="monitor.range.placeholder"
                />
                <span class="monitor-time-unit" data-i18n="monitor.range.unit">小时</span>
              </div>
              <button id="monitorRefreshBtn" class="secondary btn-with-icon">
                <i class="fa-solid fa-arrows-rotate"></i>
                <span data-i18n="common.refresh">刷新</span>
              </button>
            </div>
          </div>
          <div class="tips" data-i18n="monitor.tip">展示系统资源占用与服务运行状态。</div>
          <div class="monitor-layout">
              <div class="monitor-dashboard">
                <div class="monitor-block monitor-block-summary">
                  <div class="monitor-block-title" data-i18n="monitor.block.summary.title">
                    系统与服务状态
                  </div>
                  <div class="monitor-summary">
                    <div>
                      <div class="monitor-section-title" data-i18n="monitor.section.system">
                        系统状态
                      </div>
                      <table class="monitor-kv-table">
                        <tbody>
                          <tr>
                            <th>CPU</th>
                            <td><strong id="metricCpu">-</strong></td>
                          </tr>
                          <tr>
                            <th data-i18n="monitor.metric.memory">内存</th>
                            <td>
                              <strong id="metricMemory">-</strong>
                              <div id="metricMemoryDetail" class="monitor-subtext"></div>
                            </td>
                          </tr>
                          <tr>
                            <th data-i18n="monitor.metric.load">负载 1/5/15</th>
                            <td>
                              <strong
                                ><span id="metricLoad1">-</span> / <span id="metricLoad5">-</span> /
                                <span id="metricLoad15">-</span></strong
                              >
                            </td>
                          </tr>
                          <tr>
                            <th data-i18n="monitor.metric.uptime">运行时长</th>
                            <td><strong id="metricUptime">-</strong></td>
                          </tr>
                          <tr>
                            <th data-i18n="monitor.metric.disk">磁盘</th>
                            <td>
                              <strong id="metricDisk">-</strong>
                              <div id="metricDiskDetail" class="monitor-subtext"></div>
                            </td>
                          </tr>
                          <tr>
                            <th data-i18n="monitor.metric.logUsage">日志占用</th>
                            <td><strong id="metricLogUsage">-</strong></td>
                          </tr>
                          <tr>
                            <th data-i18n="monitor.metric.workspaceUsage">工作区占用</th>
                            <td><strong id="metricWorkspaceUsage">-</strong></td>
                          </tr>
                          <tr>
                            <th data-i18n="monitor.metric.process">进程资源</th>
                            <td>
                              <strong
                                ><span id="metricProcessMemory">-</span> /
                                <span id="metricProcessCpu">-</span></strong
                              >
                              <div class="monitor-subtext" data-i18n="monitor.metric.process.detail">
                                内存 / CPU
                              </div>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                    <div>
                      <div class="monitor-section-title" data-i18n="monitor.section.service">
                        服务状态
                      </div>
                      <table class="monitor-kv-table">
                        <tbody>
                          <tr>
                            <th data-i18n="monitor.metric.sessions.active">活动线程</th>
                            <td><strong id="metricServiceActive">-</strong></td>
                          </tr>
                          <tr>
                            <th data-i18n="monitor.metric.sessions.history">历史线程</th>
                            <td><strong id="metricServiceHistory">-</strong></td>
                          </tr>
                          <tr>
                            <th data-i18n="monitor.metric.sessions.finished">已完成</th>
                            <td><strong id="metricServiceFinished">-</strong></td>
                          </tr>
                          <tr>
                            <th data-i18n="monitor.metric.sessions.failed">已失败</th>
                            <td><strong id="metricServiceError">-</strong></td>
                          </tr>
                          <tr>
                            <th data-i18n="monitor.metric.sessions.cancelled">已取消</th>
                            <td><strong id="metricServiceCancelled">-</strong></td>
                          </tr>
                          <tr>
                            <th data-i18n="monitor.metric.sessions.total">总线程</th>
                            <td><strong id="metricServiceTotal">-</strong></td>
                          </tr>
                          <tr>
                            <th data-i18n="monitor.metric.sessions.avgTokens">平均 Token 占用</th>
                            <td><strong id="metricServiceTokenAvg">-</strong></td>
                          </tr>
                          <tr>
                            <th data-i18n="monitor.metric.sessions.avg">平均耗时</th>
                            <td><strong id="metricServiceAvg">-</strong></td>
                          </tr>
                          <tr>
                            <th data-i18n="monitor.metric.sessions.prefillSpeed">平均预填充速度</th>
                            <td><strong id="metricServicePrefillSpeed">-</strong></td>
                          </tr>
                          <tr>
                            <th data-i18n="monitor.metric.sessions.decodeSpeed">平均解码速度</th>
                            <td><strong id="metricServiceDecodeSpeed">-</strong></td>
                          </tr>
                          <tr>
                            <th data-i18n="monitor.metric.sessions.tokens">Token 总占用</th>
                            <td><strong id="metricServiceTokenTotal">-</strong></td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                    <div>
                      <div class="monitor-section-title" data-i18n="monitor.section.userDashboard">
                        用户看板
                      </div>
                      <table class="monitor-kv-table">
                        <tbody>
                          <tr>
                            <th data-i18n="monitor.metric.users.count">用户数</th>
                            <td><strong id="metricUserCount">-</strong></td>
                          </tr>
                          <tr>
                            <th data-i18n="monitor.metric.users.sessions">会话数</th>
                            <td><strong id="metricUserSessions">-</strong></td>
                          </tr>
                          <tr>
                            <th data-i18n="monitor.metric.users.records">历史记录</th>
                            <td><strong id="metricUserRecords">-</strong></td>
                          </tr>
                          <tr>
                            <th data-i18n="monitor.metric.users.tools">工具调用</th>
                            <td><strong id="metricUserTools">-</strong></td>
                          </tr>
                          <tr>
                            <th data-i18n="monitor.metric.users.active">活动线程</th>
                            <td><strong id="metricUserActive">-</strong></td>
                          </tr>
                          <tr>
                            <th data-i18n="monitor.metric.users.tokens">Token 占用</th>
                            <td><strong id="metricUserTokens">-</strong></td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
                <div class="monitor-block monitor-block-tools">
                  <div id="toolHeatmapTitle" class="monitor-block-title">
                    <i class="fa-solid fa-diagram-project"></i>
                    <span data-role="title" data-i18n="monitor.chart.toolHeatmap.default">
                      近 3 小时工具调用热力图
                    </span>
                  </div>
                  <div id="toolHeatmapWrap" class="tool-heatmap-scroll">
                    <div id="toolHeatmapGrid" class="tool-heatmap"></div>
                  </div>
                  <div id="toolHeatmapEmpty" class="tool-heatmap-empty" data-i18n="monitor.toolHeatmap.empty">
                    暂无工具调用
                  </div>
                </div>
              <div class="monitor-block monitor-block-token">
                <div id="serviceTokenTitle" class="monitor-block-title" data-i18n="monitor.chart.tokenTrend.default">
                  每 3 小时 Token 总占用趋势
                </div>
                <div id="serviceTokenChartWrap" class="monitor-chart-scroll">
                  <div id="serviceTokenChart" class="monitor-chart monitor-chart-content"></div>
                </div>
              </div>
              <div class="monitor-block monitor-block-status">
                <div id="serviceStatusTitle" class="monitor-block-title" data-i18n="monitor.chart.statusRatio.default">
                  近 3 小时线程状态占比
                </div>
                <div id="serviceStatusChart" class="monitor-chart"></div>
              </div>
            </div>
          </div>
        </section>
        <section id="introPanel" class="panel">
          <div class="list-header">
            <h1 data-i18n="intro.title">幻灯片</h1>
            <div class="header-actions">
              <button id="introFullscreenBtn" class="secondary btn-with-icon" type="button">
                <i class="fa-solid fa-expand"></i><span data-i18n="intro.fullscreen">全屏</span>
              </button>
            </div>
          </div>
          <div class="tips" data-i18n="intro.tip">
            这里嵌入系统介绍 PPT，适合现场演示或全屏播放。按 T 可返回目录页。
          </div>
          <div id="introFrameWrap" class="intro-frame-wrap">
            <iframe
              id="introFrame"
              class="intro-frame"
        src="/wunder/ppt/index.html?v=20260110-09"
              title="wunder 系统介绍"
              data-i18n-title="intro.frame.title"
              loading="lazy"
              allowfullscreen
            ></iframe>
          </div>
        </section>
        <section id="usersPanel" class="panel">
          <div class="user-management">
            <div class="list-header">
              <h1 data-i18n="users.title">用户管理</h1>
              <div class="header-actions">
                <div class="header-input">
                  <label for="userSearchInput" data-i18n="users.search.label">搜索用户</label>
                  <input
                    id="userSearchInput"
                    type="text"
                    placeholder="输入用户ID"
                    data-i18n-placeholder="common.placeholder.userId"
                  />
                </div>
                <button id="userRefreshBtn" class="secondary btn-with-icon">
                  <i class="fa-solid fa-arrows-rotate"></i>
                  <span data-i18n="common.refresh">刷新</span>
                </button>
                <button id="userThroughputCleanupBtn" class="secondary btn-with-icon">
                  <i class="fa-solid fa-broom"></i>
                  <span data-i18n="users.cleanup.throughput">清理压测线程</span>
                </button>
              </div>
            </div>
            <div class="tips" data-i18n="users.tip">
              统计各用户历史对话记录、会话与工具调用次数，点击历史对话记录可查看该用户全部会话。
            </div>
            <div class="management-layout user-layout">
              <div class="management-list">
                <div class="list-header">
                  <label data-i18n="users.stats.title">用户统计</label>
                </div>
                <div class="monitor-section-body monitor-paged">
                  <div class="monitor-table-scroll">
                    <table class="monitor-table user-table">
                      <colgroup>
                        <col class="col-user-id" />
                        <col class="col-chat" />
                        <col class="col-session" />
                        <col class="col-tool" />
                        <col class="col-active" />
                        <col class="col-action" />
                      </colgroup>
                      <thead>
                        <tr>
                          <th data-i18n="users.table.user">用户</th>
                          <th data-i18n="users.table.records">历史对话记录</th>
                          <th data-i18n="users.table.sessions">会话次数</th>
                          <th data-i18n="users.table.tokens">Token 占用</th>
                          <th data-i18n="users.table.active">活动线程</th>
                          <th data-i18n="users.table.actions">操作</th>
                        </tr>
                      </thead>
                      <tbody id="userStatsBody"></tbody>
                    </table>
                    <div id="userStatsEmpty" class="muted" data-i18n="users.empty">暂无用户数据</div>
                  </div>
                  <div id="userStatsPagination" class="monitor-pagination">
                    <div id="userStatsPageInfo" class="monitor-pagination-info"></div>
                    <div class="monitor-pagination-controls">
                      <button id="userStatsPrevBtn" class="secondary" type="button" data-i18n="pagination.prev">
                        上一页
                      </button>
                      <button id="userStatsNextBtn" class="secondary" type="button" data-i18n="pagination.next">
                        下一页
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <div class="management-detail user-detail">
                <div class="detail-header">
                  <div>
                    <div id="userDetailTitle" class="detail-title" data-i18n="users.all">全部用户</div>
                    <div id="userDetailMeta" class="muted"></div>
                  </div>
                </div>
                <div class="monitor-table-wrap">
                  <div class="monitor-sections">
                    <div class="monitor-section">
                      <div class="monitor-section-title" data-i18n="monitor.section.active">活动线程</div>
                      <div class="monitor-section-body monitor-paged">
                        <div class="monitor-table-scroll">
                          <table class="monitor-table">
                            <colgroup>
                              <col class="col-start" />
                              <col class="col-session" />
                              <col class="col-user" />
                              <col class="col-question" />
                              <col class="col-status" />
                              <col class="col-token" />
                              <col class="col-elapsed" />
                              <col class="col-stage" />
                              <col class="col-action" />
                            </colgroup>
                            <thead>
                              <tr>
                                <th data-i18n="monitor.table.start">开始时间</th>
                                <th data-i18n="monitor.table.session">会话</th>
                                <th data-i18n="monitor.table.user">用户</th>
                                <th data-i18n="monitor.table.question">问题</th>
                                <th data-i18n="monitor.table.status">状态</th>
                                <th data-i18n="monitor.table.token">Token</th>
                                <th data-i18n="monitor.table.elapsed">耗时</th>
                                <th data-i18n="monitor.table.stage">阶段</th>
                                <th data-i18n="monitor.table.action">操作</th>
                              </tr>
                            </thead>
                            <tbody id="monitorTableBody"></tbody>
                          </table>
                          <div id="monitorEmpty" class="muted" data-i18n="monitor.empty.active">暂无活动线程。</div>
                        </div>
                        <div id="monitorActivePagination" class="monitor-pagination">
                          <div
                            id="monitorActivePageInfo"
                            class="monitor-pagination-info"
                            data-i18n="pagination.info.empty"
                          >
                            共 0 条 · 第 1 / 1 页 · 每页 100 条
                          </div>
                          <div class="monitor-pagination-controls">
                            <button id="monitorActivePrevBtn" class="secondary" type="button" data-i18n="pagination.prev">
                              上一页
                            </button>
                            <button id="monitorActiveNextBtn" class="secondary" type="button" data-i18n="pagination.next">
                              下一页
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="monitor-section">
                      <div class="monitor-section-title" data-i18n="monitor.section.history">历史线程</div>
                      <div class="monitor-section-body monitor-paged">
                        <div class="monitor-table-scroll">
                          <table class="monitor-table">
                            <colgroup>
                              <col class="col-start" />
                              <col class="col-session" />
                              <col class="col-user" />
                              <col class="col-question" />
                              <col class="col-status" />
                              <col class="col-token" />
                              <col class="col-elapsed" />
                              <col class="col-stage" />
                              <col class="col-action" />
                            </colgroup>
                            <thead>
                              <tr>
                                <th data-i18n="monitor.table.start">开始时间</th>
                                <th data-i18n="monitor.table.session">会话</th>
                                <th data-i18n="monitor.table.user">用户</th>
                                <th data-i18n="monitor.table.question">问题</th>
                                <th data-i18n="monitor.table.status">状态</th>
                                <th data-i18n="monitor.table.token">Token</th>
                                <th data-i18n="monitor.table.elapsed">耗时</th>
                                <th data-i18n="monitor.table.stage">阶段</th>
                                <th data-i18n="monitor.table.action">操作</th>
                              </tr>
                            </thead>
                            <tbody id="monitorHistoryBody"></tbody>
                          </table>
                          <div id="monitorHistoryEmpty" class="muted" data-i18n="monitor.empty.history">暂无历史线程。</div>
                        </div>
                        <div id="monitorHistoryPagination" class="monitor-pagination">
                          <div
                            id="monitorHistoryPageInfo"
                            class="monitor-pagination-info"
                            data-i18n="pagination.info.empty"
                          >
                            共 0 条 · 第 1 / 1 页 · 每页 100 条
                          </div>
                          <div class="monitor-pagination-controls">
                            <button id="monitorHistoryPrevBtn" class="secondary" type="button" data-i18n="pagination.prev">
                              上一页
                            </button>
                            <button id="monitorHistoryNextBtn" class="secondary" type="button" data-i18n="pagination.next">
                              下一页
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
                <section id="userAccountsPanel" class="panel">
          <div class="user-management user-account-management">
            <div class="list-header">
              <h1 data-i18n="userAccounts.title">用户管理</h1>
              <div class="header-actions">
                <div class="header-input">
                  <label for="userAccountSearchInput" data-i18n="userAccounts.search.label">搜索用户</label>
                  <input
                    id="userAccountSearchInput"
                    type="text"
                    placeholder="用户ID或邮箱"
                    data-i18n-placeholder="userAccounts.search.placeholder"
                  />
                </div>
                <button id="userAccountRefreshBtn" class="secondary btn-with-icon">
                  <i class="fa-solid fa-arrows-rotate"></i>
                  <span data-i18n="common.refresh">刷新</span>
                </button>
                <button id="userAccountSeedBtn" class="secondary btn-with-icon">
                  <i class="fa-solid fa-flask"></i>
                  <span data-i18n="userAccounts.action.seed">新增测试用户</span>
                </button>
                <button id="userAccountCreateBtn" class="btn-with-icon">
                  <i class="fa-solid fa-user-plus"></i>
                  <span data-i18n="userAccounts.action.create">新增用户</span>
                </button>
              </div>
            </div>
            <div class="tips" data-i18n="userAccounts.tip">
              管理账号状态、所属单位、额度与工具权限。
            </div>
            <div class="monitor-section-body monitor-paged">
              <div class="monitor-table-scroll">
                <table class="monitor-table user-account-table">
                  <colgroup>
                    <col class="col-user-id" />
                    <col class="col-user-email" />
                    <col class="col-user-unit" />
                    <col class="col-user-status" />
                    <col class="col-user-quota" />
                    <col class="col-user-login" />
                    <col class="col-user-action" />
                  </colgroup>
                  <thead>
                    <tr>
                      <th data-i18n="userAccounts.table.user">用户</th>
                      <th data-i18n="userAccounts.table.email">邮箱</th>
                      <th data-i18n="userAccounts.table.unit">所属单位</th>
                      <th data-i18n="userAccounts.table.status">状态</th>
                      <th data-i18n="userAccounts.table.quota">额度</th>
                      <th data-i18n="userAccounts.table.lastLogin">最近登录</th>
                      <th data-i18n="userAccounts.table.actions">操作</th>
                    </tr>
                  </thead>
                  <tbody id="userAccountTableBody"></tbody>
                </table>
                <div id="userAccountEmpty" class="muted" data-i18n="userAccounts.empty">
                  暂无用户
                </div>
              </div>
              <div id="userAccountPagination" class="monitor-pagination">
                <div id="userAccountPageInfo" class="monitor-pagination-info"></div>
                <div class="monitor-pagination-controls">
                  <button id="userAccountPrevBtn" class="secondary" type="button" data-i18n="pagination.prev">
                    上一页
                  </button>
                  <button id="userAccountNextBtn" class="secondary" type="button" data-i18n="pagination.next">
                    下一页
                  </button>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section id="orgUnitsPanel" class="panel">
          <div class="list-header">
            <h1 data-i18n="orgUnits.title">单位管理</h1>
            <div class="header-actions">
              <button id="orgUnitRefreshBtn" class="secondary btn-with-icon">
                <i class="fa-solid fa-arrows-rotate"></i>
                <span data-i18n="common.refresh">刷新</span>
              </button>
              <button id="orgUnitCreateBtn" class="btn-with-icon">
                <i class="fa-solid fa-plus"></i>
                <span data-i18n="orgUnits.action.create">新增单位</span>
              </button>
            </div>
          </div>
          <div class="tips" data-i18n="orgUnits.tip">
            维护单位层级结构与负责人，支持新增、调整与删除。
          </div>
          <div class="management-layout org-units-layout">
            <div class="management-list">
              <div class="list-header">
                <label data-i18n="orgUnits.tree.title">单位结构</label>
              </div>
              <div id="orgUnitTree" class="org-unit-tree"></div>
            </div>
            <div class="management-detail org-unit-detail">
              <div class="detail-header">
                <div>
                  <div id="orgUnitDetailTitle" class="detail-title" data-i18n="orgUnits.detail.empty">
                    未选择单位
                  </div>
                  <div id="orgUnitDetailMeta" class="muted"></div>
                </div>
                <div class="detail-actions">
                  <button id="orgUnitAddChildBtn" class="secondary btn-with-icon">
                    <i class="fa-solid fa-plus"></i>
                    <span data-i18n="orgUnits.action.addChild">新增下级</span>
                  </button>
                  <button id="orgUnitDeleteBtn" class="danger btn-with-icon">
                    <i class="fa-solid fa-trash"></i>
                    <span data-i18n="common.delete">删除</span>
                  </button>
                </div>
              </div>
              <div class="form-section">
                <div class="form-row">
                  <label for="orgUnitFormName" data-i18n="orgUnits.form.name">单位名称</label>
                  <input id="orgUnitFormName" type="text" />
                </div>
                <div class="form-row">
                  <label for="orgUnitFormParent" data-i18n="orgUnits.form.parent">上级单位</label>
                  <select id="orgUnitFormParent"></select>
                </div>
                <div class="form-row">
                  <label for="orgUnitFormSortOrder" data-i18n="orgUnits.form.sortOrder">排序</label>
                  <input id="orgUnitFormSortOrder" type="number" min="0" step="1" />
                </div>
                <div class="form-row">
                  <label for="orgUnitFormLeaders" data-i18n="orgUnits.form.leaders">负责人</label>
                  <input
                    id="orgUnitFormLeaders"
                    type="text"
                    placeholder="用户ID逗号分隔"
                    data-i18n-placeholder="orgUnits.form.leaders.placeholder"
                  />
                  <div class="muted" data-i18n="orgUnits.form.leaders.hint">
                    填写负责人的用户ID，逗号分隔。
                  </div>
                </div>
                <div class="form-row">
                  <label data-i18n="orgUnits.form.path">路径</label>
                  <div id="orgUnitFormPath" class="muted">-</div>
                </div>
                <div class="form-row">
                  <label data-i18n="orgUnits.form.level">层级</label>
                  <div id="orgUnitFormLevel" class="muted">-</div>
                </div>
                <div class="org-unit-actions">
                  <button id="orgUnitSaveBtn" class="btn-with-icon" type="button">
                    <i class="fa-solid fa-floppy-disk"></i>
                    <span data-i18n="common.save">保存</span>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </section>
<section id="memoryPanel" class="panel">
          <div class="user-management">
            <div class="list-header">
              <h1 data-i18n="memory.title">记忆管理</h1>
              <div class="header-actions">
                <div class="header-input">
                  <label for="memorySearchInput" data-i18n="memory.search.label">搜索用户</label>
                  <input
                    id="memorySearchInput"
                    type="text"
                    placeholder="输入用户ID"
                    data-i18n-placeholder="common.placeholder.userId"
                  />
                </div>
                <button id="memoryRefreshBtn" class="secondary btn-with-icon">
                  <i class="fa-solid fa-arrows-rotate"></i>
                  <span data-i18n="common.refresh">刷新</span>
                </button>
              </div>
            </div>
            <div class="tips" data-i18n="memory.tip">
              记忆管理用于管理用户长期记忆数据，开启后会将历史记忆追加到系统提示词末尾，并在每次最终回复后自动总结。
            </div>
            <div class="management-layout memory-layout">
              <div class="management-list">
                <div class="list-header">
                  <label data-i18n="memory.users.title">用户列表</label>
                </div>
                <div class="monitor-section-body monitor-paged">
                  <div class="monitor-table-scroll">
                    <table class="monitor-table memory-table">
                      <colgroup>
                        <col class="col-memory-user" />
                        <col class="col-memory-count" />
                        <col class="col-memory-updated" />
                        <col class="col-memory-enabled" />
                        <col class="col-memory-action" />
                      </colgroup>
                      <thead>
                        <tr>
                          <th data-i18n="memory.table.user">用户</th>
                          <th data-i18n="memory.table.count">记录数</th>
                          <th data-i18n="memory.table.updatedAt">更新时间</th>
                          <th data-i18n="memory.table.enabled">启用</th>
                          <th data-i18n="memory.table.actions">操作</th>
                        </tr>
                      </thead>
                      <tbody id="memoryUsersBody"></tbody>
                    </table>
                    <div id="memoryUsersEmpty" class="muted" data-i18n="memory.users.empty">暂无用户</div>
                  </div>
                  <div id="memoryUsersPagination" class="monitor-pagination">
                    <div id="memoryUsersPageInfo" class="monitor-pagination-info"></div>
                    <div class="monitor-pagination-controls">
                      <button id="memoryUsersPrevBtn" class="secondary" type="button" data-i18n="pagination.prev">
                        上一页
                      </button>
                      <button id="memoryUsersNextBtn" class="secondary" type="button" data-i18n="pagination.next">
                        下一页
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <div class="management-detail memory-status">
                <div class="detail-header">
                  <div>
                    <div class="detail-title" data-i18n="memory.status.title">记忆管理运行状态</div>
                    <div id="memoryStatusMeta" class="muted"></div>
                  </div>
                </div>
                <div class="monitor-table-wrap">
                  <div class="monitor-sections memory-status-sections">
                    <div class="monitor-section">
                      <div class="monitor-section-title" data-i18n="memory.queue.active.title">活动队列</div>
                      <div class="monitor-section-body monitor-paged">
                        <div class="monitor-table-scroll">
                          <table class="monitor-table memory-queue-table">
                            <colgroup>
                              <col class="col-memory-queue-time" />
                              <col class="col-memory-queue-session" />
                              <col class="col-memory-queue-user" />
                              <col class="col-memory-queue-status" />
                              <col class="col-memory-queue-elapsed" />
                              <col class="col-memory-queue-action" />
                            </colgroup>
                            <thead>
                              <tr>
                                <th data-i18n="memory.queue.table.start">开始时间</th>
                                <th data-i18n="memory.queue.table.session">会话</th>
                                <th data-i18n="memory.queue.table.user">用户</th>
                                <th data-i18n="memory.queue.table.status">状态</th>
                                <th data-i18n="memory.queue.table.elapsed">耗时</th>
                                <th data-i18n="memory.queue.table.action">操作</th>
                              </tr>
                            </thead>
                            <tbody id="memoryStatusActiveBody"></tbody>
                          </table>
                          <div id="memoryStatusActiveEmpty" class="muted" data-i18n="memory.status.emptyActive">
                            暂无活动任务。
                          </div>
                        </div>
                        <div id="memoryStatusActivePagination" class="monitor-pagination">
                          <div id="memoryStatusActivePageInfo" class="monitor-pagination-info"></div>
                          <div class="monitor-pagination-controls">
                            <button id="memoryStatusActivePrevBtn" class="secondary" type="button" data-i18n="pagination.prev">
                              上一页
                            </button>
                            <button id="memoryStatusActiveNextBtn" class="secondary" type="button" data-i18n="pagination.next">
                              下一页
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="monitor-section">
                      <div class="monitor-section-title" data-i18n="memory.queue.history.title">历史队列</div>
                      <div class="monitor-section-body monitor-paged">
                        <div class="monitor-table-scroll">
                          <table class="monitor-table memory-queue-table">
                            <colgroup>
                              <col class="col-memory-queue-time" />
                              <col class="col-memory-queue-session" />
                              <col class="col-memory-queue-user" />
                              <col class="col-memory-queue-status" />
                              <col class="col-memory-queue-elapsed" />
                              <col class="col-memory-queue-action" />
                            </colgroup>
                            <thead>
                              <tr>
                                <th data-i18n="memory.queue.table.start">开始时间</th>
                                <th data-i18n="memory.queue.table.session">会话</th>
                                <th data-i18n="memory.queue.table.user">用户</th>
                                <th data-i18n="memory.queue.table.status">状态</th>
                                <th data-i18n="memory.queue.table.elapsed">耗时</th>
                                <th data-i18n="memory.queue.table.action">操作</th>
                              </tr>
                            </thead>
                            <tbody id="memoryStatusHistoryBody"></tbody>
                          </table>
                          <div id="memoryStatusHistoryEmpty" class="muted" data-i18n="memory.status.emptyHistory">
                            暂无历史任务。
                          </div>
                        </div>
                        <div id="memoryStatusHistoryPagination" class="monitor-pagination">
                          <div id="memoryStatusHistoryPageInfo" class="monitor-pagination-info"></div>
                          <div class="monitor-pagination-controls">
                            <button id="memoryStatusHistoryPrevBtn" class="secondary" type="button" data-i18n="pagination.prev">
                              上一页
                            </button>
                            <button id="memoryStatusHistoryNextBtn" class="secondary" type="button" data-i18n="pagination.next">
                              下一页
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section id="debugPanel" class="panel">
          <div class="list-header">
            <h1 data-i18n="debug.title">请求调试</h1>
            <div class="header-actions debug-header-actions">
              <div class="header-input">
                <label for="userId" data-i18n="debug.label.userId">user_id</label>
                <input id="userId" type="text" />
              </div>
              <div class="header-input">
                <label for="sessionId" data-i18n="debug.label.sessionId">session_id（可选）</label>
                <input
                  id="sessionId"
                  type="text"
                  placeholder="留空自动生成"
                  data-i18n-placeholder="debug.placeholder.sessionId"
                />
              </div>
              <div class="header-input">
                <label for="debugModelName" data-i18n="debug.label.model">模型配置</label>
                <select id="debugModelName">
                  <option value="" data-i18n="llm.default">默认模型</option>
                </select>
              </div>
              <button
                id="debugHistoryBtn"
                class="secondary btn-with-icon"
                type="button"
                aria-label="历史"
                title="历史"
                data-i18n-aria-label="debug.history"
                data-i18n-title="debug.history"
              >
                <i class="fa-solid fa-clock-rotate-left"></i>
              </button>
            </div>
          </div>
          <div class="tips" data-i18n="debug.tip">
            本页面用于快速测试 /wunder 接口（SSE 或非流式）。请确保后端服务已启动，并且地址可访问。
            如果使用 file:// 打开页面，浏览器可能拦截跨域请求，请使用本地静态服务或开启 CORS。
          </div>
          <div class="debug-layout">
            <div class="debug-form">
              <div class="form-section debug-form-section">
                <div id="debugWorkspaceMount">
                  <div id="workspaceSharedBlock" class="form-row">
                  <div class="workspace-header">
                    <label data-i18n="workspace.temp.title">临时工作区</label>
                    <div class="workspace-actions">
                      <button
                        id="workspaceUpBtn"
                        class="secondary btn-with-icon icon-only"
                        type="button"
                        title="上级"
                        aria-label="上级"
                        data-i18n-title="workspace.action.up"
                        data-i18n-aria-label="workspace.action.up"
                      >
                        <i class="fa-solid fa-arrow-up"></i>
                      </button>
                      <button
                        id="workspaceRefreshBtn"
                        class="secondary btn-with-icon icon-only"
                        type="button"
                        title="刷新"
                        aria-label="刷新"
                        data-i18n-title="common.refresh"
                        data-i18n-aria-label="common.refresh"
                      >
                        <i class="fa-solid fa-arrows-rotate"></i>
                      </button>
                      <button
                        id="workspaceClearBtn"
                        class="secondary btn-with-icon icon-only"
                        type="button"
                        title="清空"
                        aria-label="清空"
                        data-i18n-title="workspace.action.clear"
                        data-i18n-aria-label="workspace.action.clear"
                      >
                        <i class="fa-solid fa-trash"></i>
                      </button>
                      <button
                        id="workspaceUploadBtn"
                        class="btn-with-icon icon-only"
                        type="button"
                        title="上传"
                        aria-label="上传"
                        data-i18n-title="workspace.action.upload"
                        data-i18n-aria-label="workspace.action.upload"
                      >
                        <i class="fa-solid fa-upload"></i>
                      </button>
                      <button
                        id="workspaceDownloadAllBtn"
                        class="secondary btn-with-icon icon-only"
                        type="button"
                        title="全下"
                        aria-label="全下"
                        data-i18n-title="workspace.action.downloadAll"
                        data-i18n-aria-label="workspace.action.downloadAll"
                      >
                        <i class="fa-solid fa-download"></i>
                      </button>
                    </div>
                  </div>
                  <div id="workspacePath" class="workspace-path">/</div>
                  <div class="workspace-toolbar">
                    <div class="workspace-search">
                      <i class="fa-solid fa-magnifying-glass"></i>
                      <input
                        id="workspaceSearchInput"
                        type="text"
                        placeholder="搜索工作区（名称）"
                        data-i18n-placeholder="workspace.search.placeholder"
                      />
                    </div>
                    <div class="workspace-sort">
                      <select id="workspaceSortSelect">
                        <option value="name" data-i18n="workspace.sort.name">名称排序</option>
                        <option value="updated_time" data-i18n="workspace.sort.updated">更新时间</option>
                        <option value="size" data-i18n="workspace.sort.size">大小</option>
                      </select>
                      <button
                        id="workspaceSortOrderBtn"
                        class="secondary btn-with-icon icon-only"
                        type="button"
                        title="排序方向"
                        aria-label="排序方向"
                        data-i18n-title="workspace.sort.order"
                        data-i18n-aria-label="workspace.sort.order"
                      >
                        <i class="fa-solid fa-arrow-up-short-wide"></i>
                      </button>
                    </div>
                    <div id="workspaceSelectionMeta" class="workspace-selection-meta muted"></div>
                  </div>
                  <div id="workspaceUploadProgress" class="workspace-upload-progress" aria-live="polite">
                    <div class="workspace-upload-bar">
                      <div id="workspaceUploadProgressBar" class="workspace-upload-bar-fill"></div>
                    </div>
                    <div id="workspaceUploadProgressText" class="workspace-upload-text"></div>
                  </div>
                  <div id="workspaceList" class="workspace-list"></div>
                  </div>
                </div>
              <div class="form-row debug-attachments">
                <div class="debug-attachments-header">
                  <label data-i18n="debug.attachments.title">附件</label>
                  <div id="debugAttachmentMeta" class="muted"></div>
                </div>
                <div id="debugAttachmentList" class="debug-attachments-list" data-i18n="debug.attachments.empty">
                  暂未附加文件或图片
                </div>
              </div>

              <div id="debugStabilityPanel" class="form-row debug-stability is-hidden">
                <div class="debug-stability-header">
                  <label data-i18n="debug.stability.title">长对话稳定性</label>
                  <div class="debug-stability-actions">
                    <button id="debugStabilityRun" class="btn-with-icon" type="button">
                      <i class="fa-solid fa-play"></i>
                      <span data-i18n="debug.stability.run">运行</span>
                    </button>
                    <button id="debugStabilityStop" class="secondary btn-with-icon" type="button">
                      <i class="fa-solid fa-stop"></i>
                      <span data-i18n="debug.stability.stop">停止</span>
                    </button>
                  </div>
                </div>
                <div class="debug-stability-controls">
                  <div class="header-input">
                    <label for="debugStabilityPreset" data-i18n="debug.stability.preset">预设</label>
                    <select id="debugStabilityPreset"></select>
                  </div>
                  <label class="debug-stability-toggle">
                    <input id="debugStabilityStream" type="checkbox" checked />
                    <span data-i18n="debug.stability.stream">流式</span>
                  </label>
                  <label class="debug-stability-toggle">
                    <input id="debugStabilityNewSession" type="checkbox" checked />
                    <span data-i18n="debug.stability.newSession">新会话</span>
                  </label>
                  <label class="debug-stability-toggle">
                    <input id="debugStabilityUseTools" type="checkbox" checked />
                    <span data-i18n="debug.stability.toolLock">锁定工具集</span>
                  </label>
                </div>
                <div id="debugStabilitySteps" class="debug-stability-steps"></div>
                <div id="debugStabilityStatus" class="debug-stability-status muted" data-i18n="debug.stability.ready">准备就绪</div>
              </div>

              <!-- 问题输入区域 -->
              <div class="form-row question-row">
                <label for="question" data-i18n="debug.label.question">question</label>
                <textarea
                  id="question"
                  placeholder="请输入需要测试的问题"
                  data-i18n-placeholder="debug.question.placeholder"
                ></textarea>
              </div>
              <!-- 操作按钮：发送、停止 -->
              <div class="actions debug-actions">
                <button
                  id="debugStabilityToggleBtn"
                  class="secondary btn-with-icon icon-only"
                  type="button"
                  title="长对话稳定性测试"
                  aria-label="长对话稳定性测试"
                  aria-expanded="false"
                  aria-controls="debugStabilityPanel"
                  data-i18n-title="debug.stability.title"
                  data-i18n-aria-label="debug.stability.title"
                >
                  <i class="fa-solid fa-shield-halved"></i>
                </button>
                <button
                  id="debugCompactionBtn"
                  class="secondary btn-with-icon icon-only"
                  type="button"
                  title="上下文压缩"
                  aria-label="上下文压缩"
                  data-i18n-title="debug.compaction.action"
                  data-i18n-aria-label="debug.compaction.action"
                >
                  <i class="fa-solid fa-compress"></i>
                </button>
                <button
                  id="debugNewSessionBtn"
                  class="secondary btn-with-icon icon-only"
                  type="button"
                  title="新会话"
                  aria-label="新会话"
                  data-i18n-title="debug.action.newSession"
                  data-i18n-aria-label="debug.action.newSession"
                >
                  <i class="fa-solid fa-plus"></i>
                </button>
                <button
                  id="debugUploadBtn"
                  class="secondary btn-with-icon icon-only"
                  type="button"
                  title="上传附件"
                  aria-label="上传附件"
                  data-i18n-title="debug.action.upload"
                  data-i18n-aria-label="debug.action.upload"
                >
                  <i class="fa-solid fa-paperclip"></i>
                </button>
                <button
                  id="sendBtn"
                  class="btn-with-icon icon-only"
                  type="button"
                  title="发送"
                  aria-label="发送"
                  data-i18n-title="debug.action.send"
                  data-i18n-aria-label="debug.action.send"
                >
                  <i class="fa-solid fa-paper-plane"></i>
                </button>
              </div>
              </div>
            </div>
            <div class="panel-logs">
              <div class="log-card">
                <div class="log-card-header">
                  <label data-i18n="debug.log.events">事件日志</label>
                  <span class="log-waiting" data-i18n="debug.log.running">进行中</span>
                </div>
                <div id="eventLog" class="log log-collapsible"></div>
              </div>
              <div class="log-card">
                <div class="log-card-header">
                  <label data-i18n="debug.log.requests">请求日志</label>
                  <span class="log-waiting" data-i18n="debug.log.running">进行中</span>
                </div>
                <div id="requestLog" class="log log-collapsible"></div>
              </div>
              <div class="log-card">
                <div class="log-card-header">
                  <label data-i18n="debug.log.output">模型输出</label>
                  <div class="header-input">
                    <label for="modelOutputRoundSelect" data-i18n="debug.log.round">轮次</label>
                    <select id="modelOutputRoundSelect"></select>
                    <button
                      id="modelOutputPreviewBtn"
                      class="model-output-preview-toggle"
                      type="button"
                      aria-label="预览"
                      title="预览"
                      data-i18n-aria-label="debug.output.preview"
                      data-i18n-title="debug.output.preview"
                    >
                      <i class="fa-solid fa-eye"></i>
                    </button>
                    <button
                      id="modelOutputPlanBtn"
                      class="model-output-preview-toggle plan-board-toggle"
                      type="button"
                      aria-label="计划看板"
                      title="计划看板"
                      data-i18n-aria-label="debug.output.plan"
                      data-i18n-title="debug.output.plan"
                    >
                      <i class="fa-solid fa-table"></i>
                    </button>
                  </div>
                </div>
                <div id="modelOutput" class="log">
                  <div id="modelOutputA2ui" class="a2ui-output"></div>
                  <pre id="modelOutputText" class="model-output-text"></pre>
                </div>
              </div>
              <div class="log-card">
                <label data-i18n="debug.log.stats">统计信息</label>
                <div id="finalAnswer" class="answer"></div>
              </div>
            </div>
          </div>
        </section>
        <section id="settingsPanel" class="panel">
          <div class="list-header">
            <h1 data-i18n="settings.title">System Settings</h1>
            <div class="header-actions">
              <button id="settingsResetBtn" class="secondary btn-with-icon" type="button">
                <i class="fa-solid fa-rotate-left"></i>
                <span data-i18n="settings.reset">Reset</span>
              </button>
              <button id="settingsAdvancedBtn" class="secondary btn-with-icon" type="button">
                <i class="fa-solid fa-sliders"></i>
                <span data-i18n="settings.advanced.title">Advanced</span>
              </button>
              <button id="settingsSaveBtn" class="btn-with-icon" type="button">
                <i class="fa-solid fa-floppy-disk"></i>
                <span data-i18n="settings.save">Save</span>
              </button>
            </div>
          </div>
          <div class="tips" data-i18n="settings.tip">System settings are stored locally and in the server config.</div>
          <div class="settings-layout">
            <div class="settings-card settings-card-general">
              <div class="settings-card-title">
                <i class="fa-solid fa-gear"></i>
                <span data-i18n="settings.card.general">General</span>
              </div>
              <div class="settings-card-body">
                <div class="settings-grid">
                  <div class="form-row">
                    <label for="settingsDefaultUserId" data-i18n="settings.label.defaultUserId">Default user_id</label>
                    <input id="settingsDefaultUserId" type="text" placeholder="demo_user" />
                  </div>
                  <div class="form-row">
                    <label for="settingsDefaultPanel" data-i18n="settings.label.defaultPanel">Default panel</label>
                    <select id="settingsDefaultPanel">
                      <option value="monitor" data-i18n="panel.monitor">Monitor</option>
                      <option value="users" data-i18n="panel.users">Sessions</option>
                      <option value="memory" data-i18n="panel.memory">Memory</option>
                      <option value="llm" data-i18n="panel.llm">LLM</option>
                      <option value="settings" data-i18n="panel.settings">Settings</option>
                      <option value="builtin" data-i18n="panel.builtin">Builtin</option>
                      <option value="mcp" data-i18n="panel.mcp">MCP</option>
                      <option value="knowledge" data-i18n="panel.knowledge">Knowledge</option>
                      <option value="a2aServices" data-i18n="panel.a2aServices">A2A</option>
                      <option value="skills" data-i18n="panel.skills">Skills</option>
                      <option value="throughput" data-i18n="panel.throughput">Throughput</option>
                      <option value="performance" data-i18n="panel.performance">Performance</option>
                      <option value="prompt" data-i18n="panel.prompt">Prompt</option>
                      <option value="evaluation" data-i18n="panel.evaluation">Evaluation</option>
                      <option value="debug" data-i18n="panel.debug">Debug</option>
                      <option value="lsp" data-i18n="panel.lsp">LSP</option>
                      <option value="intro" data-i18n="panel.intro">Intro</option>
                      <option value="apiDocs" data-i18n="panel.apiDocs">API Docs</option>
                    </select>
                  </div>
                  <div class="form-row">
                    <label for="settingsLanguage" data-i18n="settings.label.language">Language</label>
                    <select id="settingsLanguage">
                      <option value="zh-CN" data-i18n="language.zh-CN">简体中文</option>
                      <option value="en-US" data-i18n="language.en-US">English</option>
                    </select>
                  </div>
                  <div class="form-row">
                    <label for="settingsMonitorInterval" data-i18n="settings.label.monitorInterval">Monitor interval (ms)</label>
                    <input id="settingsMonitorInterval" type="number" min="500" step="100" />
                  </div>
                  <div class="form-row">
                    <label for="settingsPromptDelay" data-i18n="settings.label.promptDelay">Prompt refresh delay (ms)</label>
                    <input id="settingsPromptDelay" type="number" min="50" step="50" />
                  </div>
                </div>
                <div class="settings-hint" data-i18n="settings.hint.general">
                  Save to apply polling interval. Default panel requires a refresh.
                </div>
              </div>
            </div>
            <div class="settings-card settings-card-server">
              <div class="settings-card-title">
                <i class="fa-solid fa-server"></i>
                <span data-i18n="settings.card.server">Server</span>
              </div>
              <div class="settings-card-body">
                <div class="settings-grid settings-grid--auto">
                  <div class="form-row">
                    <label for="settingsMaxActiveSessions" data-i18n="settings.label.maxActiveSessions">Max active sessions</label>
                    <input id="settingsMaxActiveSessions" type="number" min="1" step="1" />
                  </div>
                  <div class="form-row">
                    <label for="settingsStreamChunkSize" data-i18n="settings.label.streamChunkSize">Stream chunk size</label>
                    <input
                      id="settingsStreamChunkSize"
                      type="number"
                      min="0"
                      step="128"
                      placeholder="1024"
                      data-i18n-placeholder="settings.placeholder.streamChunkSize"
                    />
                  </div>
                  <div class="form-row">
                    <label for="settingsLogLevel" data-i18n="settings.label.logLevel">Log level</label>
                    <select id="settingsLogLevel">
                      <option value="trace">TRACE</option>
                      <option value="debug">DEBUG</option>
                      <option value="info">INFO</option>
                      <option value="warn">WARN</option>
                      <option value="error">ERROR</option>
                    </select>
                  </div>
                  <div class="form-row">
                    <label for="settingsMonitorEventLimit" data-i18n="settings.label.monitorEventLimit">Monitor events</label>
                    <input id="settingsMonitorEventLimit" type="number" min="0" step="10" />
                  </div>
                  <div class="form-row">
                    <label for="settingsMonitorPayloadLimit" data-i18n="settings.label.monitorPayloadLimit">Payload max chars</label>
                    <input id="settingsMonitorPayloadLimit" type="number" min="0" step="256" />
                  </div>
                  <div class="form-row form-row-span">
                    <label for="settingsMonitorDropTypes" data-i18n="settings.label.monitorDropTypes">Drop event types</label>
                    <textarea
                      id="settingsMonitorDropTypes"
                      placeholder="llm_output_delta"
                      data-i18n-placeholder="settings.placeholder.monitorDropTypes"
                    ></textarea>
                    <div class="settings-field-hint" data-i18n="settings.hint.monitorDropTypes">
                      One type per line.
                    </div>
                  </div>
                </div>
                <div class="settings-hint" data-i18n="settings.hint.server">
                  Controls concurrency and stream chunk size. Log/monitor limits usually require a restart.
                </div>
              </div>
            </div>
            <div class="settings-card settings-card-security">
              <div class="settings-card-title">
                <i class="fa-solid fa-shield-halved"></i>
                <span data-i18n="settings.card.security">Security</span>
                <div class="settings-card-badges">
                  <span class="settings-badge settings-badge--runtime" data-i18n="settings.badge.runtime">Live</span>
                </div>
              </div>
              <div class="settings-card-body">
                <div class="settings-grid settings-grid--auto">
                  <div class="form-row form-row-span">
                    <label for="settingsAllowCommands" data-i18n="settings.label.allowCommands">Allow commands</label>
                    <textarea
                      id="settingsAllowCommands"
                      placeholder="*"
                      data-i18n-placeholder="settings.placeholder.allowCommands"
                    ></textarea>
                    <div class="settings-field-hint" data-i18n="settings.hint.allowCommands">
                      One item per line. Use * to allow all.
                    </div>
                  </div>
                  <div class="form-row form-row-span">
                    <label for="settingsAllowPaths" data-i18n="settings.label.allowPaths">Allow paths</label>
                    <textarea
                      id="settingsAllowPaths"
                      placeholder="./skills"
                      data-i18n-placeholder="settings.placeholder.allowPaths"
                    ></textarea>
                    <div class="settings-field-hint" data-i18n="settings.hint.allowPaths">
                      Whitelist extra directories for tools.
                    </div>
                  </div>
                  <div class="form-row form-row-span">
                    <label for="settingsDenyGlobs" data-i18n="settings.label.denyGlobs">Deny globs</label>
                    <textarea
                      id="settingsDenyGlobs"
                      placeholder="**/.git/**"
                      data-i18n-placeholder="settings.placeholder.denyGlobs"
                    ></textarea>
                    <div class="settings-field-hint" data-i18n="settings.hint.denyGlobs">
                      Glob patterns to block sensitive paths.
                    </div>
                  </div>
                </div>
                <div class="settings-hint" data-i18n="settings.hint.security">
                  API Key is managed in Advanced settings.
                </div>
              </div>
            </div>
            <div class="settings-card settings-card-sandbox">
              <div class="settings-card-title">
                <i class="fa-solid fa-cube"></i>
                <span data-i18n="settings.card.sandbox">Sandbox</span>
                <div class="settings-card-badges">
                  <span class="settings-badge settings-badge--runtime" data-i18n="settings.badge.runtime">Live</span>
                </div>
              </div>
              <div class="settings-card-body">
                <div class="settings-grid settings-grid--auto">
                  <div class="form-row form-row-span">
                    <label for="settingsSandboxEnabled" data-i18n="settings.label.sandbox">Sandbox</label>
                    <label class="checkbox-row">
                      <input id="settingsSandboxEnabled" type="checkbox" checked />
                      <span data-i18n="settings.option.sandboxEnabled">Enable sandbox execution</span>
                    </label>
                  </div>
                  <div class="form-row">
                    <label for="settingsSandboxEndpoint" data-i18n="settings.label.sandboxEndpoint">Sandbox endpoint</label>
                    <input
                      id="settingsSandboxEndpoint"
                      type="text"
                      placeholder="http://sandbox:9001"
                      data-i18n-placeholder="settings.placeholder.sandboxEndpoint"
                    />
                  </div>
                  <div class="form-row">
                    <label for="settingsSandboxContainerRoot" data-i18n="settings.label.sandboxContainerRoot">Container root</label>
                    <input
                      id="settingsSandboxContainerRoot"
                      type="text"
                      placeholder="/workspaces"
                      data-i18n-placeholder="settings.placeholder.sandboxContainerRoot"
                    />
                  </div>
                  <div class="form-row">
                    <label for="settingsSandboxNetwork" data-i18n="settings.label.sandboxNetwork">Network mode</label>
                    <input
                      id="settingsSandboxNetwork"
                      type="text"
                      placeholder="bridge"
                      data-i18n-placeholder="settings.placeholder.sandboxNetwork"
                    />
                  </div>
                  <div class="form-row">
                    <label for="settingsSandboxReadonly" data-i18n="settings.label.sandboxReadonly">Readonly rootfs</label>
                    <label class="checkbox-row">
                      <input id="settingsSandboxReadonly" type="checkbox" />
                      <span data-i18n="settings.option.sandboxReadonly">Enable readonly rootfs</span>
                    </label>
                  </div>
                  <div class="form-row">
                    <label for="settingsSandboxIdleTtl" data-i18n="settings.label.sandboxIdleTtl">Idle TTL (s)</label>
                    <input id="settingsSandboxIdleTtl" type="number" min="0" step="10" />
                  </div>
                  <div class="form-row">
                    <label for="settingsSandboxTimeout" data-i18n="settings.label.sandboxTimeout">Timeout (s)</label>
                    <input id="settingsSandboxTimeout" type="number" min="0" step="10" />
                  </div>
                  <div class="form-row">
                    <label for="settingsSandboxCpu" data-i18n="settings.label.sandboxCpu">CPU</label>
                    <input id="settingsSandboxCpu" type="number" min="0" step="0.1" />
                  </div>
                  <div class="form-row">
                    <label for="settingsSandboxMemory" data-i18n="settings.label.sandboxMemory">Memory (MB)</label>
                    <input id="settingsSandboxMemory" type="number" min="0" step="64" />
                  </div>
                  <div class="form-row">
                    <label for="settingsSandboxPids" data-i18n="settings.label.sandboxPids">PIDs</label>
                    <input id="settingsSandboxPids" type="number" min="0" step="1" />
                  </div>
                </div>
                <div class="settings-hint" data-i18n="settings.hint.sandbox">
                  Adjust sandbox endpoint and resource limits for command/ptc tools.
                </div>
              </div>
            </div>
          </div>
        </section><section id="mcpPanel" class="panel">
            <div class="list-header">
              <h1 data-i18n="mcp.title">MCP 服务管理</h1>
              <div class="header-actions">
                <button id="mcpRefreshAllBtn" class="secondary btn-with-icon">
                  <i class="fa-solid fa-arrows-rotate"></i>
                  <span data-i18n="mcp.refresh.all">全部刷新</span>
                </button>
                <button id="mcpImportBtn" class="secondary btn-with-icon">
                  <i class="fa-solid fa-file-import"></i>
                  <span data-i18n="mcp.import.action">导入服务</span>
                </button>
              </div>
            </div>
          <div class="tips" data-i18n="mcp.tip">
            录入 MCP 服务后可连接列出工具，并选择是否启用。启用的工具会注入系统提示词。
          </div>
          <div class="management-layout">
            <div class="management-list">
              <div class="list-header">
                <label data-i18n="mcp.list.title">服务列表</label>
              </div>
              <div id="mcpServerList" class="list-body"></div>
            </div>
            <div class="management-detail">
              <div class="detail-header">
                <div>
                  <div id="mcpDetailTitle" class="detail-title" data-i18n="mcp.detail.none">未选择服务</div>
                  <div id="mcpDetailMeta" class="muted"></div>
                  <div id="mcpDetailDesc" class="muted"></div>
                </div>
              </div>
              <div class="detail-actions">
                <div class="actions">
                  <button id="mcpConnectBtn" class="btn-with-icon">
                    <i class="fa-solid fa-link"></i>连接
                  </button>
                  <button id="mcpEnableAllBtn" class="secondary btn-with-icon">
                    <i class="fa-solid fa-check-double"></i><span data-i18n="mcp.tools.enableAll">全选</span>
                  </button>
                  <button id="mcpDisableAllBtn" class="secondary btn-with-icon">
                    <i class="fa-solid fa-ban"></i><span data-i18n="mcp.tools.disableAll">全不选</span>
                  </button>
                </div>
                <div class="actions">
                  <button id="mcpEditBtn" class="secondary btn-with-icon">
                    <i class="fa-solid fa-pen-to-square"></i><span data-i18n="mcp.action.edit">编辑服务</span>
                  </button>
                  <button id="mcpDeleteBtn" class="danger btn-with-icon">
                    <i class="fa-solid fa-trash"></i><span data-i18n="mcp.action.delete">删除服务</span>
                  </button>
                </div>
              </div>
              <div class="muted" data-i18n="mcp.tip.allowTools">勾选后将写入 allow_tools，仅启用选中的工具。</div>
              <div id="mcpToolList" class="tool-list"></div>
            </div>
          </div>
        </section>
        <section id="lspPanel" class="panel">
          <div class="list-header lsp-list-header">
            <div class="lsp-title-group">
              <h1 data-i18n="lsp.title">LSP 服务</h1>
              <button id="lspStatusIndicator" class="status-indicator status-indicator-compact" type="button">
                <span class="status-dot"></span>
              </button>
              <label class="checkbox-row checkbox-compact lsp-title-toggle">
                <input id="lspEnabled" type="checkbox" />
                <span data-i18n="lsp.config.enabled">启用 LSP</span>
              </label>
            </div>
            <div class="header-actions lsp-header-actions">
              <button id="lspConfigBtn" class="btn-with-icon" type="button">
                <i class="fa-solid fa-sliders"></i>
                <span data-i18n="lsp.action.config">LSP 配置</span>
              </button>
              <div class="lsp-inline-controls">
                <label for="lspTestUserId" class="lsp-inline-label" data-i18n="lsp.workspace.userId">user_id</label>
                <input id="lspTestUserId" type="text" placeholder="demo_user" />
              </div>
            </div>
          </div>
          <div class="tips" data-i18n="lsp.tip">
            配置并启用 LSP 服务后，可为模型提供代码导航、符号检索与诊断能力。
          </div>
          <div class="lsp-layout lsp-layout-main">
            <div class="lsp-column lsp-column-main">
              <div class="settings-card lsp-workspace-card">
                <div class="settings-card-title">
                  <i class="fa-solid fa-folder-tree"></i>
                  <span data-i18n="lsp.workspace.title">LSP 调试工作区</span>
                </div>
                <div id="lspWorkspaceMount" class="lsp-workspace-mount"></div>
                <div class="muted" data-i18n="lsp.workspace.tip">
                  复用调试面板的临时文件区，保存文件后自动触发 LSP 刷新。
                </div>
              </div>
              <div class="settings-card lsp-result-card">
                <div class="settings-card-title lsp-result-header">
                  <i class="fa-solid fa-terminal"></i>
                  <span data-i18n="lsp.result.title">LSP 结果</span>
                  <span id="lspResultMeta" class="muted lsp-result-meta"></span>
                  <span
                    id="lspResultStatus"
                    class="lsp-result-status"
                    data-status="idle"
                    aria-live="polite"
                  >
                    <span class="status-dot"></span>
                    <span id="lspResultStatusText" class="lsp-result-status-text" data-i18n="lsp.result.status.idle">空闲</span>
                  </span>
                </div>
                <pre id="lspTestResult" class="tool-schema"></pre>
              </div>
            </div>
            <div class="lsp-column lsp-column-editor">
              <div class="settings-card lsp-editor-card">
                <div class="settings-card-title lsp-editor-header">
                  <div>
                    <div id="lspEditorTitle" class="detail-title">编辑文件</div>
                    <div id="lspEditorPath" class="muted"></div>
                  </div>
                  <div class="lsp-editor-actions">
                    <button
                      id="lspEditorUndo"
                      class="secondary btn-with-icon icon-only"
                      type="button"
                      title="撤销"
                      aria-label="撤销"
                      data-i18n-title="common.undo"
                      data-i18n-aria-label="common.undo"
                    >
                      <i class="fa-solid fa-rotate-left"></i>
                    </button>
                    <button
                      id="lspEditorRedo"
                      class="secondary btn-with-icon icon-only"
                      type="button"
                      title="恢复"
                      aria-label="恢复"
                      data-i18n-title="common.redo"
                      data-i18n-aria-label="common.redo"
                    >
                      <i class="fa-solid fa-rotate-right"></i>
                    </button>
                    <button
                      id="lspEditorSave"
                      class="btn-with-icon icon-only"
                      type="button"
                      title="保存"
                      aria-label="保存"
                      data-i18n-title="common.save"
                      data-i18n-aria-label="common.save"
                    >
                      <i class="fa-solid fa-floppy-disk"></i>
                    </button>
                  </div>
                </div>
                <div id="lspEditorStatus" class="muted mcp-test-status"></div>
                <div class="lsp-editor-body">
                  <pre id="lspEditorHighlight" class="lsp-editor-highlight"></pre>
                  <textarea
                    id="lspEditorContent"
                    class="workspace-editor-text"
                    placeholder="选择文件开始编辑"
                    data-i18n-placeholder="lsp.workspace.editor.placeholder"
                  ></textarea>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section id="a2aServicesPanel" class="panel">
          <div class="list-header">
            <h1 data-i18n="a2aServices.title">A2A 服务管理</h1>
            <div class="header-actions">
              <button id="a2aServiceAddBtn" class="secondary btn-with-icon">
                <i class="fa-solid fa-plus"></i><span data-i18n="a2aServices.action.add">新增服务</span>
              </button>
            </div>
          </div>
          <div class="tips" data-i18n="a2aServices.tip">
            配置 A2A 服务并缓存 AgentCard，启用后可作为工具注入系统提示词。
          </div>
          <div class="management-layout">
            <div class="management-list">
              <div class="list-header">
                <label data-i18n="a2aServices.list.title">服务列表</label>
              </div>
              <div id="a2aServiceList" class="list-body"></div>
            </div>
            <div class="management-detail">
              <div class="detail-header">
                <div>
                  <div id="a2aServiceDetailTitle" class="detail-title" data-i18n="a2aServices.detail.none">
                    未选择服务
                  </div>
                  <div id="a2aServiceDetailMeta" class="muted"></div>
                  <div id="a2aServiceDetailDesc" class="muted"></div>
                </div>
              </div>
              <div class="detail-actions">
                <div class="actions">
                  <label class="checkbox-row checkbox-compact">
                    <input id="a2aServiceEnabled" type="checkbox" />
                    <span data-i18n="a2aServices.field.enabled">启用服务</span>
                  </label>
                  <button id="a2aServiceConnectBtn" class="btn-with-icon">
                    <i class="fa-solid fa-link"></i><span data-i18n="a2aServices.action.connect">连接</span>
                  </button>
                </div>
                <div class="actions">
                  <button id="a2aServiceEditBtn" class="secondary btn-with-icon">
                    <i class="fa-solid fa-pen-to-square"></i><span data-i18n="a2aServices.action.edit">编辑服务</span>
                  </button>
                  <button id="a2aServiceDeleteBtn" class="danger btn-with-icon">
                    <i class="fa-solid fa-trash"></i><span data-i18n="a2aServices.action.delete">删除服务</span>
                  </button>
                </div>
              </div>
              <div class="agentcard-section">
                <div class="agentcard-section-title" data-i18n="a2aServices.card.title">AgentCard</div>
                <div class="agentcard-section-title" data-i18n="a2a.agentCard.section.basic">基础信息</div>
                <div id="a2aServiceCardBasic"></div>
                <div class="agentcard-section-title" data-i18n="a2a.agentCard.section.capabilities">能力</div>
                <div id="a2aServiceCardCapabilities"></div>
                <div class="agentcard-section-title" data-i18n="a2a.agentCard.section.interfaces">接口</div>
                <div id="a2aServiceCardInterfaces" class="agentcard-list"></div>
                <div class="agentcard-section-title" data-i18n="a2a.agentCard.section.skills">Skills</div>
                <div id="a2aServiceCardSkills" class="agentcard-list"></div>
                <div class="agentcard-section-title" data-i18n="a2a.agentCard.section.tools">工具</div>
                <div id="a2aServiceCardTools" class="agentcard-tool-groups"></div>
              </div>
            </div>
          </div>
        </section>
        <section id="builtinPanel" class="panel">
          <div class="list-header">
            <h1 data-i18n="builtin.title">内置工具</h1>
            <button id="refreshBuiltinBtn" class="secondary btn-with-icon">
              <i class="fa-solid fa-arrows-rotate"></i>
              <span data-i18n="builtin.refresh">刷新工具</span>
            </button>
          </div>
          <div class="tips" data-i18n="builtin.tip">
            勾选后将注入系统提示词，不勾选则不加入。
          </div>
          <div class="skills-panel">
            <div id="builtinToolsList" class="tool-list"></div>
          </div>
        </section>
        <section id="skillsPanel" class="panel">
          <div class="list-header">
            <h1 data-i18n="skills.title">技能管理</h1>
            <div class="header-actions">
              <button id="addSkillBtn" class="secondary btn-with-icon">
                <i class="fa-solid fa-plus"></i><span data-i18n="skills.action.add">添加技能</span>
              </button>
              <button id="refreshSkillsBtn" class="secondary btn-with-icon">
                <i class="fa-solid fa-arrows-rotate"></i><span data-i18n="skills.action.refresh">刷新技能</span>
              </button>
            </div>
          </div>
          <div class="tips" data-i18n="skills.tip">从技能目录读取可用技能，勾选后会注入系统提示词。</div>
          <div class="skills-layout">
            <div class="skills-sidebar">
              <div class="skills-section-title" data-i18n="skills.list.title">技能列表</div>
              <div id="skillsList" class="skills-list"></div>
            </div>
            <div class="skills-detail">
              <div class="skills-detail-pane">
                <div class="detail-header">
                  <div>
                    <div
                      id="skillDetailTitle"
                      class="detail-title"
                      data-i18n="skills.detail.unselected"
                    >
                      未选择技能
                    </div>
                    <div id="skillDetailMeta" class="muted"></div>
                  </div>
                </div>
                <div class="skills-section-title" data-i18n="skills.detail.structure">
                  技能目录结构
                </div>
                <div id="skillFileTree" class="skill-file-tree"></div>
              </div>
              <div class="skills-detail-pane">
                <div class="detail-header">
                  <div>
                    <div class="detail-title" data-i18n="skills.editor.title">文件修改区</div>
                    <div id="skillEditorPath" class="muted" data-i18n="skills.file.unselected">
                      未选择文件
                    </div>
                  </div>
                  <div class="detail-actions">
                    <button id="skillFileSaveBtn" class="btn-with-icon btn-compact">
                      <i class="fa-solid fa-floppy-disk"></i>
                      <span data-i18n="common.save">保存</span>
                    </button>
                  </div>
                </div>
                <div id="skillEditorBody" class="skill-editor-body">
                  <pre id="skillFileHighlight" class="skill-editor-highlight"></pre>
                  <textarea
                    id="skillFileContent"
                    class="skill-editor-text"
                    placeholder="选择文件后可编辑"
                    data-i18n-placeholder="skills.file.placeholder"
                  ></textarea>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section id="knowledgePanel" class="panel">
          <div class="list-header">
            <h1 data-i18n="knowledge.title">知识库</h1>
            <div class="header-actions">
              <button id="knowledgeAddBtn" class="secondary btn-with-icon">
                <i class="fa-solid fa-plus"></i><span data-i18n="knowledge.action.add">新增</span>
              </button>
              <button id="knowledgeRefreshBtn" class="secondary btn-with-icon">
                <i class="fa-solid fa-arrows-rotate"></i><span data-i18n="knowledge.action.refresh">刷新</span>
              </button>
            </div>
          </div>
          <div class="tips" data-i18n="knowledge.tip">
            配置不同知识库目录并提供检索工具，新增或编辑时在弹窗中完成。
          </div>
          <div class="management-layout knowledge-layout">
            <div class="management-list">
              <div class="list-header">
                <label data-i18n="knowledge.list.title">知识库列表</label>
              </div>
              <div id="knowledgeBaseList" class="list-body"></div>
            </div>
            <div class="management-detail knowledge-detail">
                <div class="detail-header">
                  <div>
                    <div id="knowledgeDetailTitle" class="detail-title" data-i18n="knowledge.detail.empty">未选择知识库</div>
                    <div id="knowledgeDetailMeta" class="muted"></div>
                    <div id="knowledgeDetailDesc" class="muted"></div>
                  </div>
                  <div class="detail-actions">
                    <button
                      id="knowledgeFileUploadBtn"
                      class="secondary btn-with-icon btn-compact icon-only"
                      data-i18n-title="common.upload"
                      data-i18n-aria-label="common.upload"
                    >
                      <i class="fa-solid fa-upload"></i>
                    </button>
                    <button
                      id="knowledgeFileNewBtn"
                      class="secondary btn-with-icon btn-compact icon-only"
                      data-i18n-title="common.new"
                      data-i18n-aria-label="common.new"
                    >
                      <i class="fa-solid fa-plus"></i>
                    </button>
                    <button
                      id="knowledgeFileSaveBtn"
                      class="btn-with-icon btn-compact icon-only"
                      data-i18n-title="common.save"
                      data-i18n-aria-label="common.save"
                    >
                      <i class="fa-solid fa-floppy-disk"></i>
                    </button>
                    <button
                      id="knowledgeDocUploadBtn"
                      class="secondary btn-with-icon btn-compact icon-only"
                      data-i18n-title="common.upload"
                      data-i18n-aria-label="common.upload"
                    >
                      <i class="fa-solid fa-upload"></i>
                    </button>
                    <button
                      id="knowledgeDocRebuildAllBtn"
                      class="secondary btn-with-icon btn-compact icon-only"
                      data-i18n-title="knowledge.action.rebuild"
                      data-i18n-aria-label="knowledge.action.rebuild"
                    >
                      <i class="fa-solid fa-rotate"></i>
                    </button>
                    <button
                      id="knowledgeTestBtn"
                      class="secondary btn-with-icon btn-compact icon-only"
                      data-i18n-title="knowledge.action.test"
                      data-i18n-aria-label="knowledge.action.test"
                    >
                      <i class="fa-solid fa-vial"></i>
                    </button>
                    <button
                      id="knowledgeEditBtn"
                      class="secondary btn-with-icon btn-compact icon-only"
                      data-i18n-title="common.edit"
                      data-i18n-aria-label="common.edit"
                    >
                      <i class="fa-solid fa-pen"></i>
                    </button>
                    <button
                      id="knowledgeDeleteBtn"
                      class="danger btn-with-icon btn-compact icon-only"
                      data-i18n-title="knowledge.action.delete"
                      data-i18n-aria-label="knowledge.action.delete"
                    >
                      <i class="fa-solid fa-trash"></i>
                    </button>
                </div>
              </div>
              <div class="knowledge-section form-section">
                <div class="knowledge-content">
                  <div class="llm-card knowledge-files-card">
                    <div id="knowledgeFileLayout" class="knowledge-file-layout">
                        <div class="knowledge-file-pane">
                        <input
                          id="knowledgeFileUploadInput"
                          type="file"
                          multiple
                          hidden
                        />
                        <div id="knowledgeFileList" class="knowledge-file-list"></div>
                      </div>
                        <div class="knowledge-file-editor">
                          <div id="knowledgeFileName" class="muted" data-i18n="knowledge.file.none">未选择文档</div>
                          <div class="knowledge-editor-wrapper">
                            <div
                              id="knowledgeFileHighlight"
                              class="knowledge-editor-highlight"
                              aria-hidden="true"
                            ></div>
                            <textarea
                              id="knowledgeFileContent"
                              placeholder="在此编辑 Markdown 内容"
                              data-i18n-placeholder="knowledge.file.placeholder"
                            ></textarea>
                          </div>
                        </div>
                    </div>
                    <div id="knowledgeVectorLayout" class="knowledge-vector-layout" hidden>
                      <div class="knowledge-vector-pane">
                        <div id="knowledgeDocList" class="knowledge-doc-list"></div>
                      </div>
                      <div class="knowledge-vector-detail">
                        <div class="knowledge-doc-header">
                          <div>
                            <div id="knowledgeDocTitle" class="detail-title" data-i18n="knowledge.doc.none">
                              未选择文档
                            </div>
                            <div id="knowledgeDocMeta" class="muted"></div>
                          </div>
                          <div class="detail-actions">
                            <button
                              id="knowledgeDocToggleBtn"
                              class="secondary btn-with-icon btn-compact icon-only"
                              data-i18n-title="knowledge.doc.action.show"
                              data-i18n-aria-label="knowledge.doc.action.show"
                              type="button"
                            >
                              <i class="fa-solid fa-file-lines"></i>
                            </button>
                            <button
                              id="knowledgeDocChunkSelectAllBtn"
                              class="secondary btn-with-icon btn-compact icon-only"
                              data-i18n-title="knowledge.chunk.action.selectAll"
                              data-i18n-aria-label="knowledge.chunk.action.selectAll"
                              type="button"
                            >
                              <i class="fa-solid fa-square-check"></i>
                            </button>
                            <button
                              id="knowledgeDocEmbedBtn"
                              class="btn-with-icon btn-compact icon-only"
                              data-i18n-title="knowledge.doc.action.embed"
                              data-i18n-aria-label="knowledge.doc.action.embed"
                              type="button"
                            >
                              <i class="fa-solid fa-cube"></i>
                            </button>
                            <button
                              id="knowledgeDocChunkDeleteBtn"
                              class="danger btn-with-icon btn-compact icon-only"
                              data-i18n-title="knowledge.doc.action.deleteChunks"
                              data-i18n-aria-label="knowledge.doc.action.deleteChunks"
                              type="button"
                            >
                              <i class="fa-solid fa-trash"></i>
                            </button>
                          </div>
                        </div>
                        <div class="knowledge-vector-content">
                          <div class="knowledge-doc-chunks-pane">
                            <div class="knowledge-doc-section-title" data-i18n="knowledge.doc.section.chunks">
                              切片列表
                            </div>
                            <div id="knowledgeDocChunks" class="knowledge-doc-chunk-list"></div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section id="llmPanel" class="panel">
          <div class="list-header">
            <h1 data-i18n="panel.llm">模型配置</h1>
            <button id="saveLlmBtn" class="btn-with-icon">
              <i class="fa-solid fa-floppy-disk"></i><span data-i18n="llm.action.save">保存配置</span>
            </button>
          </div>
          <div class="tips" data-i18n="llm.tip">配置模型服务地址、密钥与生成参数，保存后立即生效。</div>
          <div class="management-layout llm-layout">
            <div class="management-list llm-list">
              <div class="list-header">
                <label data-i18n="llm.list.title">配置列表</label>
                <button id="llmAddBtn" class="secondary btn-with-icon" type="button">
                  <i class="fa-solid fa-plus"></i><span data-i18n="llm.action.add">新增</span>
                </button>
              </div>
              <div id="llmConfigList" class="list-body"></div>
            </div>
            <div class="management-detail llm-detail">
              <div class="detail-header">
                <div>
                  <div id="llmDetailTitle" class="detail-title" data-i18n="llm.detail.emptyTitle">未选择配置</div>
                  <div id="llmDetailMeta" class="muted"></div>
                </div>
                <div class="detail-actions">
                  <button id="llmSetDefaultBtn" class="secondary btn-with-icon" type="button">
                    <i class="fa-solid fa-star"></i><span data-i18n="llm.action.setDefault">设为默认</span>
                  </button>
                  <button id="llmDeleteBtn" class="danger btn-with-icon" type="button">
                    <i class="fa-solid fa-trash"></i><span data-i18n="common.delete">删除</span>
                  </button>
                </div>
              </div>
              <div class="llm-panel form-section">
                <div class="llm-card">
                  <div class="llm-card-title">
                    <i class="fa-solid fa-gear"></i><span data-i18n="llm.section.basic">基础设置</span>
                  </div>
                  <div class="form-row">
                    <label for="llmConfigName" data-i18n="llm.field.name">配置名称</label>
                    <input
                      id="llmConfigName"
                      type="text"
                      placeholder="例如：main"
                      data-i18n-placeholder="llm.placeholder.name"
                    />
                  </div>
                  <div class="form-row">
                    <label for="llmModelType" data-i18n="llm.field.modelType">模型类型</label>
                    <select id="llmModelType">
                      <option value="llm" data-i18n="llm.modelType.llm">LLM</option>
                      <option value="embedding" data-i18n="llm.modelType.embedding">Embedding</option>
                    </select>
                  </div>
                  <div class="grid">
                    <div class="form-row">
                      <label for="llmProvider" data-i18n="llm.field.provider">provider</label>
                      <select id="llmProvider">
                        <option value="openai_compatible">openai_compatible</option>
                      </select>
                    </div>
                    <div class="form-row">
                      <label for="llmModel" data-i18n="llm.field.model">model</label>
                      <input
                        id="llmModel"
                        type="text"
                        placeholder="例如：gpt-4.1"
                        data-i18n-placeholder="llm.placeholder.model"
                      />
                    </div>
                  </div>
                  <div class="form-row">
                    <label for="llmBaseUrl" data-i18n="llm.field.baseUrl">base_url</label>
                    <input id="llmBaseUrl" type="text" placeholder="https://api.example.com" />
                  </div>
                  <div class="form-row">
                    <label for="llmApiKey" data-i18n="llm.field.apiKey">api_key（选填）</label>
                    <input id="llmApiKey" type="text" placeholder="sk-..." />
                  </div>
                </div>
                <div class="llm-card">
                  <div class="llm-card-title">
                    <i class="fa-solid fa-sliders"></i><span data-i18n="llm.section.generation">生成参数</span>
                  </div>
                  <div class="grid">
                    <div id="llmTemperatureRow" class="form-row">
                      <label for="llmTemperature" data-i18n="llm.field.temperature">temperature</label>
                      <input id="llmTemperature" type="number" min="0" max="2" step="0.1" />
                    </div>
                    <div class="form-row">
                      <label for="llmTimeout" data-i18n="llm.field.timeout">timeout_s</label>
                      <input id="llmTimeout" type="number" min="1" step="1" />
                    </div>
                  </div>
                  <div class="grid">
                    <div class="form-row">
                      <label for="llmRetry" data-i18n="llm.field.retry">retry</label>
                      <input id="llmRetry" type="number" min="0" step="1" />
                    </div>
                    <div id="llmMaxOutputRow" class="form-row">
                      <label for="llmMaxOutput" data-i18n="llm.field.maxOutput">最大输出长度（选填）</label>
                      <input
                        id="llmMaxOutput"
                        type="number"
                        min="1"
                        step="1"
                        placeholder="例如：4096"
                        data-i18n-placeholder="llm.placeholder.maxOutput"
                      />
                    </div>
                  </div>
                  <div id="llmMaxRoundsRow" class="form-row">
                    <label for="llmMaxRounds" data-i18n="llm.field.maxRounds">最大执行轮次</label>
                    <input
                      id="llmMaxRounds"
                      type="number"
                      min="1"
                      step="1"
                      placeholder="例如：10"
                      data-i18n-placeholder="llm.placeholder.maxRounds"
                    />
                  </div>
                  <div id="llmMaxContextRow" class="form-row">
                    <label for="llmMaxContext" data-i18n="llm.field.maxContext">最大上下文（选填）</label>
                    <div class="form-row-inline">
                      <input
                        id="llmMaxContext"
                        type="number"
                        min="1"
                        step="1"
                        placeholder="例如：128000"
                        data-i18n-placeholder="llm.placeholder.maxContext"
                      />
                      <button
                        id="llmProbeContextBtn"
                        type="button"
                        class="secondary btn-with-icon"
                      >
                        <i class="fa-solid fa-magnifying-glass"></i><span data-i18n="llm.action.probeContext">自动探测</span>
                      </button>
                    </div>
                  </div>
                </div>
                <div id="llmCapabilitiesCard" class="llm-card">
                  <div class="llm-card-title">
                    <i class="fa-solid fa-wand-magic-sparkles"></i><span data-i18n="llm.section.capabilities">能力选项</span>
                  </div>
                  <div class="form-row">
                    <div class="checkbox-row-group">
                      <label class="checkbox-row checkbox-compact">
                        <input id="llmVision" type="checkbox" />
                        <span data-i18n="llm.option.vision">支持视觉</span>
                      </label>
                      <label class="checkbox-row checkbox-compact">
                        <input id="llmStreamIncludeUsage" type="checkbox" />
                        <span data-i18n="llm.option.streamUsage">流式返回 usage</span>
                      </label>
                    </div>
                  </div>
                  <div class="form-row">
                    <label for="llmToolCallMode" data-i18n="llm.field.toolCallMode">工具调用方式</label>
                    <select id="llmToolCallMode">
                      <option value="tool_call" data-i18n="llm.toolCallMode.toolCall">tool_call</option>
                      <option value="function_call" data-i18n="llm.toolCallMode.functionCall">function_call</option>
                    </select>
                  </div>
                </div>
                <div id="llmCompactionCard" class="llm-card">
                  <div class="llm-card-title">
                    <i class="fa-solid fa-compress"></i><span data-i18n="llm.section.compaction">上下文压缩</span>
                  </div>
                  <div class="grid">
                    <div class="form-row">
                      <label for="llmHistoryCompactionRatio" data-i18n="llm.field.historyRatio">历史压缩阈值比例</label>
                      <input
                        id="llmHistoryCompactionRatio"
                        type="number"
                        min="0"
                        max="1"
                        step="0.05"
                        placeholder="0.8"
                        data-i18n-placeholder="llm.placeholder.historyRatio"
                      />
                    </div>
                    <div class="form-row">
                      <label for="llmHistoryCompactionReset" data-i18n="llm.field.historyReset">压缩重置策略</label>
                      <select id="llmHistoryCompactionReset">
                        <option value="zero" data-i18n="llm.compaction.reset.zero">zero（清零）</option>
                        <option value="current" data-i18n="llm.compaction.reset.current">current（重置为当前）</option>
                        <option value="keep" data-i18n="llm.compaction.reset.keep">keep（不重置）</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section id="promptPanel" class="panel">
          <div class="list-header">
            <h1 data-i18n="panel.prompt">系统提示词</h1>
            <div class="header-actions">
              <div class="header-input">
                <label for="promptUserId" data-i18n="prompt.label.userId">user_id</label>
                <input id="promptUserId" type="text" />
              </div>
              <button id="loadPromptBtn" class="secondary btn-with-icon">
                <i class="fa-solid fa-arrows-rotate"></i><span data-i18n="prompt.action.refresh">刷新提示词</span>
              </button>
              <div id="promptBuildTime" class="muted" data-i18n="prompt.buildTime.empty">构建耗时：--</div>
            </div>
          </div>
          <div class="tips" data-i18n="prompt.tip">
            用于查看当前智能体的系统提示词，左侧勾选工具会同步注入提示词并影响调试面板请求。
          </div>
          <div class="prompt-content">
            <div class="prompt-sidebar">
              <div class="prompt-section">
                <div class="prompt-section-title">
                  <i class="fa-solid fa-tools"></i><span data-i18n="prompt.section.builtin">内置工具</span>
                </div>
                <div id="promptBuiltinTools" class="prompt-tool-list"></div>
              </div>
              <div class="prompt-section">
                <div class="prompt-section-title">
                  <i class="fa-solid fa-plug"></i><span data-i18n="prompt.section.mcp">MCP 工具</span>
                </div>
                <div id="promptMcpTools" class="prompt-tool-list"></div>
              </div>
              <div class="prompt-section">
                <div class="prompt-section-title">
                  <i class="fa-solid fa-book"></i><span data-i18n="prompt.section.knowledge">知识库工具</span>
                </div>
                <div id="promptKnowledgeTools" class="prompt-tool-list"></div>
              </div>
              <div class="prompt-section">
                <div class="prompt-section-title">
                  <i class="fa-solid fa-wand-magic-sparkles"></i><span data-i18n="prompt.section.skills">技能</span>
                </div>
                <div id="promptSkills" class="prompt-tool-list"></div>
              </div>
            </div>
            <div class="prompt-secondary">
              <div class="prompt-section">
                <div class="prompt-section-title">
                  <i class="fa-solid fa-diagram-project"></i><span data-i18n="prompt.section.a2a">A2A 工具</span>
                </div>
                <div id="promptA2aTools" class="prompt-tool-list"></div>
              </div>
              <div class="prompt-section">
                <div class="prompt-section-header">
                  <div class="prompt-section-title">
                    <i class="fa-solid fa-toolbox"></i><span data-i18n="prompt.section.userTools">自建工具</span>
                  </div>
                  <button
                    id="promptUserToolAdd"
                    class="icon-btn"
                    type="button"
                    title="新增自建工具"
                    data-i18n-title="prompt.userTool.add"
                    data-i18n-aria-label="prompt.userTool.add"
                  >
                    <i class="fa-solid fa-plus"></i>
                  </button>
                </div>
                <div id="promptUserTools" class="prompt-tool-list"></div>
              </div>
              <div class="prompt-section">
                <div class="prompt-section-title">
                  <i class="fa-solid fa-infinity"></i><span data-i18n="prompt.section.shared">共享工具</span>
                </div>
                <div id="promptSharedTools" class="prompt-tool-list"></div>
              </div>
            </div>
            <div class="prompt-view">
              <div id="systemPrompt" class="log"></div>
            </div>
          </div>
        </section>
        <section id="throughputPanel" class="panel">
          <div class="list-header">
            <h1 data-i18n="panel.throughput">吞吐量测试</h1>
            <div class="header-actions throughput-header-actions">
              <button id="throughputToggleBtn" class="btn-with-icon" type="button">
                <i class="fa-solid fa-play" data-role="icon"></i>
                <span data-role="label" data-i18n="throughput.action.start">开始压测</span>
              </button>
              <button id="throughputRefreshBtn" class="secondary btn-with-icon" type="button">
                <i class="fa-solid fa-arrows-rotate"></i>
                <span data-i18n="common.refresh">刷新</span>
              </button>
              <button id="throughputHistoryBtn" class="secondary btn-with-icon" type="button">
                <i class="fa-solid fa-clock-rotate-left"></i>
                <span data-i18n="throughput.action.history">压测历史</span>
              </button>
              <div class="header-input throughput-export-input">
                <label data-i18n="throughput.export.format">导出格式</label>
                <select id="throughputExportFormat">
                  <option value="html" data-i18n="throughput.export.format.html">HTML</option>
                  <option value="json" data-i18n="throughput.export.format.json">JSON</option>
                  <option value="csv" data-i18n="throughput.export.format.csv">CSV</option>
                </select>
              </div>
              <button id="throughputExportBtn" class="secondary btn-with-icon" type="button">
                <i class="fa-solid fa-download"></i>
                <span data-i18n="throughput.action.export">导出报告</span>
              </button>
              <div
                id="throughputStatusIndicator"
                class="status-indicator"
                data-status="idle"
                aria-live="polite"
              >
                <span class="status-dot"></span>
                <span class="status-text" data-i18n="throughput.status.idle">暂无任务</span>
              </div>
            </div>
          </div>
          <div class="tips" data-i18n="throughput.tip">
            服务端从 1 并发开始按步增逐级压测，直到最大并发；步增为 0 时仅压测最大并发，用于绘制性能曲线与稳定性表现。
          </div>
          <div class="throughput-layout">
            <div class="throughput-form">
              <div class="form-section throughput-form-section">
                <div class="form-row">
                  <label for="throughputConcurrencyList" data-i18n="throughput.form.concurrencyList">并发列表</label>
                  <input
                    id="throughputConcurrencyList"
                    type="text"
                    placeholder="1,2,4,8,16"
                    data-i18n-placeholder="throughput.form.concurrencyListPlaceholder"
                  />
                  <div class="muted" data-i18n="throughput.form.concurrencyListHint">
                    用逗号分隔，并发数需大于 0 且不超过 500。
                  </div>
                </div>
                <div class="form-row">
                  <label data-i18n="throughput.form.dataset">测试题库</label>
                  <div class="muted" data-i18n="throughput.form.datasetHint">
                    使用内置 50 条问题，压测时随机抽取。
                  </div>
                </div>
                <div class="form-row">
                  <label for="throughputUserPrefix" data-i18n="throughput.form.userPrefix">user_id 前缀</label>
                  <input
                    id="throughputUserPrefix"
                    type="text"
                    placeholder="throughput_user"
                    data-i18n-placeholder="throughput.form.userPrefixPlaceholder"
                  />
                </div>
                <div class="form-row">
                  <label for="throughputModelSelect" data-i18n="throughput.field.model">当前模型</label>
                  <select id="throughputModelSelect" class="throughput-model-select">
                    <option value="" data-i18n="llm.default">默认模型</option>
                  </select>
                </div>
                <div class="form-row">
                  <label for="throughputMaxTokens" data-i18n="throughput.form.maxTokens">最大输出 Token</label>
                  <input id="throughputMaxTokens" type="number" min="1" step="1" />
                  <div class="muted" data-i18n="throughput.form.maxTokensHint">
                    限制单次请求的最大输出 Token 数，默认 256。
                  </div>
                </div>
                <div class="form-row">
                  <label for="throughputTimeout" data-i18n="throughput.form.timeout">单次请求超时（秒）</label>
                  <input id="throughputTimeout" type="number" min="0" step="0.1" />
                  <div class="muted" data-i18n="throughput.form.timeoutHint">0 表示不启用超时。</div>
                </div>
                <div class="form-row">
                  <label data-i18n="throughput.form.defaults">默认配置</label>
                  <div class="muted" data-i18n="throughput.form.defaultsHint">
                    使用默认模型与管理员启用工具，stream 固定为 true。
                  </div>
                </div>
                <div id="throughputFormStatus" class="muted"></div>
              </div>
            </div>
            <div class="throughput-results">
              <div class="monitor-block throughput-summary-block">
                <div class="monitor-block-title">
                  <i class="fa-solid fa-gauge-high"></i>
                  <span data-i18n="throughput.summary.title">压测概览</span>
                  <span id="throughputStatusBadge" class="monitor-status throughput-status-badge">-</span>
                  <span id="throughputStatusHint" class="muted throughput-status-hint"></span>
                </div>
                <div class="monitor-summary throughput-summary">
                  <div>
                      <div class="monitor-section-title" data-i18n="throughput.section.run">任务状态</div>
                      <table class="monitor-kv-table">
                        <tbody>
                          <tr>
                          <th data-i18n="throughput.field.status">状态</th>
                          <td><strong id="throughputStatusText">-</strong></td>
                        </tr>
                        <tr>
                          <th data-i18n="throughput.field.startedAt">开始时间</th>
                          <td><strong id="throughputStartedAt">-</strong></td>
                        </tr>
                        <tr>
                          <th data-i18n="throughput.field.elapsed">已运行</th>
                          <td><strong id="throughputElapsed">-</strong></td>
                          </tr>
                          <tr>
                            <th data-i18n="throughput.field.maxConcurrency">最大并发</th>
                            <td><strong id="throughputMaxConcurrencyValue">-</strong></td>
                          </tr>
                          <tr>
                            <th data-i18n="throughput.field.concurrencyList">并发列表</th>
                            <td><strong id="throughputConcurrencyListValue">-</strong></td>
                          </tr>
                          <tr>
                          <th data-i18n="throughput.field.model">当前模型</th>
                          <td><strong id="throughputModelValue">-</strong></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <div>
                    <div class="monitor-section-title" data-i18n="throughput.section.requests">请求指标</div>
                    <table class="monitor-kv-table">
                      <tbody>
                        <tr>
                          <th data-i18n="throughput.metric.total">总请求</th>
                          <td><strong id="throughputTotal">-</strong></td>
                        </tr>
                        <tr>
                          <th data-i18n="throughput.metric.success">成功</th>
                          <td><strong id="throughputSuccess">-</strong></td>
                        </tr>
                        <tr>
                          <th data-i18n="throughput.metric.error">失败</th>
                          <td><strong id="throughputError">-</strong></td>
                        </tr>
                        <tr>
                          <th data-i18n="throughput.metric.rps">RPS</th>
                          <td><strong id="throughputRps">-</strong></td>
                        </tr>
                        <tr>
                          <th data-i18n="throughput.metric.avgLatency">平均耗时</th>
                          <td><strong id="throughputAvgLatency">-</strong></td>
                        </tr>
                        <tr>
                          <th data-i18n="throughput.metric.firstTokenLatency">首包延迟</th>
                          <td><strong id="throughputFirstTokenLatency">-</strong></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <div>
                    <div class="monitor-section-title" data-i18n="throughput.section.tokens">Token 统计</div>
                    <table class="monitor-kv-table">
                      <tbody>
                        <tr>
                          <th data-i18n="throughput.metric.totalPrefillSpeed">总预填充速度</th>
                          <td><strong id="throughputTotalPrefillSpeed">-</strong></td>
                        </tr>
                        <tr>
                          <th data-i18n="throughput.metric.totalDecodeSpeed">总解码速度</th>
                          <td><strong id="throughputTotalDecodeSpeed">-</strong></td>
                        </tr>
                        <tr>
                          <th data-i18n="throughput.metric.singlePrefillSpeed">单预填充速度</th>
                          <td><strong id="throughputSinglePrefillSpeed">-</strong></td>
                        </tr>
                        <tr>
                          <th data-i18n="throughput.metric.singleDecodeSpeed">单解码速度</th>
                          <td><strong id="throughputSingleDecodeSpeed">-</strong></td>
                        </tr>
                        <tr>
                          <th data-i18n="throughput.metric.totalTokens">总计</th>
                          <td><strong id="throughputTotalTokens">-</strong></td>
                        </tr>
                        <tr>
                          <th data-i18n="throughput.metric.avgTokens">平均</th>
                          <td><strong id="throughputAvgTokens">-</strong></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
              <div class="throughput-charts">
                <div class="monitor-block throughput-chart-card throughput-chart-wide">
                  <div class="monitor-block-title" data-i18n="throughput.chart.performance">
                    性能曲线
                  </div>
                  <div id="throughputCurveChart" class="monitor-chart"></div>
                </div>
              </div>
              <div class="monitor-block throughput-threads">
                <div class="monitor-block-title">
                  <i class="fa-solid fa-list-ul"></i>
                  <span data-i18n="throughput.threads.title">线程监视</span>
                  <div class="throughput-thread-filters" role="group">
                    <button
                      id="throughputThreadFilterAll"
                      class="tab-btn active"
                      type="button"
                      data-i18n="throughput.threads.filter.all"
                    >
                      全部
                    </button>
                    <button
                      id="throughputThreadFilterActive"
                      class="tab-btn"
                      type="button"
                      data-i18n="throughput.threads.filter.active"
                    >
                      活动中
                    </button>
                    <button
                      id="throughputThreadFilterFinished"
                      class="tab-btn"
                      type="button"
                      data-i18n="throughput.threads.filter.finished"
                    >
                      已完成
                    </button>
                    <button
                      id="throughputThreadFilterFailed"
                      class="tab-btn"
                      type="button"
                      data-i18n="throughput.threads.filter.failed"
                    >
                      已失败
                    </button>
                  </div>
                </div>
                <div class="monitor-table-wrap">
                  <div class="monitor-table-scroll">
                    <table class="monitor-table throughput-thread-table">
                      <colgroup>
                        <col class="col-start" />
                        <col class="col-session" />
                        <col class="col-user" />
                        <col class="col-question" />
                        <col class="col-status" />
                        <col class="col-token" />
                        <col class="col-elapsed" />
                        <col class="col-stage" />
                      </colgroup>
                      <thead>
                        <tr>
                          <th data-i18n="monitor.table.start">开始时间</th>
                          <th data-i18n="monitor.table.session">会话</th>
                          <th data-i18n="monitor.table.user">用户</th>
                          <th data-i18n="monitor.table.question">问题</th>
                          <th data-i18n="monitor.table.status">状态</th>
                          <th data-i18n="monitor.table.token">Token</th>
                          <th data-i18n="monitor.table.elapsed">耗时</th>
                          <th data-i18n="monitor.table.stage">阶段</th>
                        </tr>
                      </thead>
                      <tbody id="throughputThreadBody"></tbody>
                    </table>
                    <div id="throughputThreadEmpty" class="muted" data-i18n="throughput.threads.empty">
                      暂无线程
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section id="performancePanel" class="panel">
          <div class="list-header">
            <h1 data-i18n="panel.performance">性能测试</h1>
            <div class="header-actions performance-header-actions">
              <button id="performanceStartBtn" class="btn-with-icon" type="button">
                <i class="fa-solid fa-play" data-role="icon"></i>
                <span data-role="label" data-i18n="performance.action.start">开始测试</span>
              </button>
              <button id="performanceResetBtn" class="secondary btn-with-icon" type="button">
                <i class="fa-solid fa-eraser"></i>
                <span data-i18n="performance.action.clear">清空结果</span>
              </button>
              <div
                id="performanceStatusIndicator"
                class="status-indicator"
                data-status="idle"
                aria-live="polite"
              >
                <span class="status-dot"></span>
                <span class="status-text" data-i18n="performance.indicator.idle">空闲</span>
              </div>
            </div>
          </div>
          <div class="tips" data-i18n="performance.tip">
            测试不涉及模型调用，仅验证系统提示词构建、文件操作、命令执行与日志写入在不同并发下的耗时变化。
          </div>
          <div class="performance-layout">
            <div class="performance-form">
              <div class="form-section">
                <div class="form-row">
                  <label for="performanceMaxConcurrency" data-i18n="performance.form.maxConcurrency">最大并发</label>
                  <input id="performanceMaxConcurrency" type="number" min="1" step="1" />
                </div>
                <div class="form-row">
                  <label for="performanceStep" data-i18n="performance.form.step">并发步增</label>
                  <input id="performanceStep" type="number" min="1" step="1" />
                </div>
                <div class="muted" data-i18n="performance.form.hint">
                  从并发 1 开始，按步增测试到最大并发。
                </div>
                <div id="performanceFormStatus" class="muted"></div>
              </div>
              <div class="performance-history">
                <div class="list-header">
                  <h2 data-i18n="performance.history.title">性能测试历史</h2>
                  <div id="performanceHistoryMeta" class="muted"></div>
                </div>
                <div class="monitor-table-scroll">
                  <table class="monitor-table performance-history-table">
                    <colgroup>
                      <col class="col-time" />
                      <col class="col-max" />
                      <col class="col-step" />
                      <col class="col-samples" />
                    </colgroup>
                    <thead>
                      <tr>
                        <th data-i18n="performance.history.startedAt">开始时间</th>
                        <th data-i18n="performance.history.maxConcurrency">最大并发</th>
                        <th data-i18n="performance.history.step">步增</th>
                        <th data-i18n="performance.history.samples">采样数</th>
                      </tr>
                    </thead>
                    <tbody id="performanceHistoryList"></tbody>
                  </table>
                  <div id="performanceHistoryEmpty" class="muted" data-i18n="performance.history.empty">
                    暂无历史记录
                  </div>
                </div>
              </div>
            </div>
            <div class="performance-results">
              <div class="monitor-block performance-chart-card">
                <div class="monitor-block-title" data-i18n="performance.chart.title">性能曲线</div>
                <div id="performanceChart" class="monitor-chart"></div>
              </div>
              <div class="monitor-block performance-table-block">
                <div class="monitor-block-title" data-i18n="performance.table.title">耗时明细</div>
                <div id="performanceTableScroll" class="monitor-table-scroll">
                  <table class="monitor-table performance-table">
                    <thead>
                      <tr>
                        <th data-i18n="performance.table.concurrency">并发数</th>
                        <th data-i18n="performance.metric.promptBuild">系统提示词构建</th>
                        <th data-i18n="performance.metric.fileOps">文件操作</th>
                        <th data-i18n="performance.metric.commandExec">命令执行</th>
                        <th data-i18n="performance.metric.toolAccess">权限/工具解析</th>
                        <th data-i18n="performance.metric.logWrite">日志写入</th>
                      </tr>
                    </thead>
                    <tbody id="performanceTableBody"></tbody>
                  </table>
                  <div id="performanceTableEmpty" class="muted" data-i18n="performance.table.empty">
                    暂无数据
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section id="evaluationPanel" class="panel">
          <div class="list-header">
            <h1 data-i18n="panel.evaluation">能力评估</h1>
            <div class="header-actions evaluation-header-actions">
              <button id="evaluationActionBtn" class="btn-with-icon" type="button">
                <i class="fa-solid fa-play"></i>
                <span data-i18n="evaluation.action.start">开始评估</span>
              </button>
              <div
                id="evaluationStatusIndicator"
                class="status-indicator"
                data-status="idle"
                aria-live="polite"
              >
                <span class="status-dot"></span>
                <span class="status-text" data-i18n="evaluation.indicator.idle">空闲</span>
              </div>
            </div>
          </div>
          <div class="tips" data-i18n="evaluation.tip">
            用于评估智能体在工具调用、逻辑推理、常识问答与复杂任务上的表现。
          </div>
          <div class="evaluation-layout">
            <div class="evaluation-side">
              <div class="evaluation-form">
                <div class="form-section">
                  <div class="evaluation-form-grid">
                    <div class="form-row">
                      <label for="evaluationUserId" data-i18n="evaluation.form.userId">user_id</label>
                      <input
                        id="evaluationUserId"
                        type="text"
                        placeholder="user_001"
                        data-i18n-placeholder="common.placeholder.userId"
                      />
                    </div>
                    <div class="form-row">
                      <label for="evaluationModelSelect" data-i18n="evaluation.form.modelName">模型名称</label>
                      <select id="evaluationModelSelect" class="evaluation-model-select"></select>
                    </div>
                    <div class="form-row">
                      <label for="evaluationLanguage" data-i18n="evaluation.form.language">语言</label>
                      <select id="evaluationLanguage"></select>
                    </div>
                    <div class="form-row">
                      <label for="evaluationCaseSet" data-i18n="evaluation.form.caseSet">用例集</label>
                      <select id="evaluationCaseSet"></select>
                    </div>
                  </div>
                  <div class="form-row">
                    <label data-i18n="evaluation.form.dimensions">评估维度</label>
                    <div class="evaluation-dimension-select">
                      <label class="checkbox-inline">
                        <input id="evaluationDimTool" type="checkbox" checked />
                        <span data-i18n="evaluation.form.dim.tool">工具调用</span>
                      </label>
                      <label class="checkbox-inline">
                        <input id="evaluationDimLogic" type="checkbox" checked />
                        <span data-i18n="evaluation.form.dim.logic">逻辑推理</span>
                      </label>
                      <label class="checkbox-inline">
                        <input id="evaluationDimCommon" type="checkbox" checked />
                        <span data-i18n="evaluation.form.dim.common">常识问答</span>
                      </label>
                      <label class="checkbox-inline">
                        <input id="evaluationDimComplex" type="checkbox" checked />
                        <span data-i18n="evaluation.form.dim.complex">复杂任务</span>
                      </label>
                    </div>
                  </div>
                  <div id="evaluationFormStatus" class="muted"></div>
                </div>
              </div>
              <div class="evaluation-history">
                <div class="list-header">
                  <h2 data-i18n="evaluation.history.title">历史记录</h2>
                </div>
                <div class="monitor-table-scroll">
                  <table class="monitor-table evaluation-history-table">
                    <thead>
                      <tr>
                        <th data-i18n="evaluation.history.table.runId">Run ID</th>
                        <th data-i18n="evaluation.history.table.status">状态</th>
                        <th data-i18n="evaluation.history.table.score">总分</th>
                        <th data-i18n="evaluation.history.table.startedAt">开始时间</th>
                        <th data-i18n="evaluation.history.table.model">模型</th>
                        <th data-i18n="evaluation.history.table.action">操作</th>
                      </tr>
                    </thead>
                    <tbody id="evaluationHistoryBody"></tbody>
                  </table>
                </div>
                <div id="evaluationHistoryEmpty" class="muted" data-i18n="evaluation.history.empty">
                  暂无历史记录
                </div>
              </div>
            </div>
            <div class="evaluation-main">
              <div class="evaluation-results">
                <div class="monitor-block evaluation-summary-card">
                  <div class="monitor-block-title">
                    <i class="fa-solid fa-flag-checkered"></i>
                    <span data-i18n="evaluation.summary.title">当前评估</span>
                    <span id="evaluationRunSpinner" class="evaluation-run-spinner" aria-hidden="true"></span>
                    <span id="evaluationRunStatus" class="monitor-status">-</span>
                  </div>
                  <table class="monitor-kv-table">
                    <tbody>
                      <tr>
                        <th data-i18n="evaluation.summary.runId">Run ID</th>
                        <td><strong id="evaluationRunId">-</strong></td>
                      </tr>
                      <tr>
                        <th data-i18n="evaluation.summary.startedAt">开始时间</th>
                        <td><strong id="evaluationRunStartedAt">-</strong></td>
                      </tr>
                      <tr>
                        <th data-i18n="evaluation.summary.elapsed">耗时</th>
                        <td><strong id="evaluationRunElapsed">-</strong></td>
                      </tr>
                      <tr>
                        <th data-i18n="evaluation.summary.totalScore">总分</th>
                        <td><strong id="evaluationTotalScore">-</strong></td>
                      </tr>
                    </tbody>
                  </table>
                  <div class="evaluation-dimension-grid">
                    <div class="evaluation-dimension-item">
                      <span data-i18n="evaluation.form.dim.tool">工具调用</span>
                      <strong id="evaluationScoreTool">-</strong>
                    </div>
                    <div class="evaluation-dimension-item">
                      <span data-i18n="evaluation.form.dim.logic">逻辑推理</span>
                      <strong id="evaluationScoreLogic">-</strong>
                    </div>
                    <div class="evaluation-dimension-item">
                      <span data-i18n="evaluation.form.dim.common">常识问答</span>
                      <strong id="evaluationScoreCommon">-</strong>
                    </div>
                    <div class="evaluation-dimension-item">
                      <span data-i18n="evaluation.form.dim.complex">复杂任务</span>
                      <strong id="evaluationScoreComplex">-</strong>
                    </div>
                  </div>
                  <div class="evaluation-progress">
                    <div class="evaluation-progress-bar">
                      <span id="evaluationProgressFill"></span>
                    </div>
                    <div id="evaluationProgressText" class="muted">0/0</div>
                  </div>
                  <div id="evaluationCurrentCase" class="muted evaluation-current-case"></div>
                  <div id="evaluationRunHint" class="muted evaluation-run-hint"></div>
                </div>
                <div class="monitor-block evaluation-cases">
                  <div class="monitor-block-title">
                    <i class="fa-solid fa-list-check"></i>
                    <span data-i18n="evaluation.cases.title">用例明细</span>
                  </div>
                  <div class="monitor-table-scroll">
                    <table class="monitor-table evaluation-case-table">
                      <thead>
                        <tr>
                          <th data-i18n="evaluation.cases.table.caseId">用例</th>
                          <th data-i18n="evaluation.cases.table.dimension">维度</th>
                          <th data-i18n="evaluation.cases.table.status">状态</th>
                          <th data-i18n="evaluation.cases.table.score">得分</th>
                        </tr>
                      </thead>
                      <tbody id="evaluationCaseBody"></tbody>
                    </table>
                  </div>
                  <div id="evaluationCaseEmpty" class="muted" data-i18n="evaluation.cases.empty">
                    暂无用例
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>
        <section id="apiDocsPanel" class="panel" data-api-docs-src="/docs/api-docs.json?v=20260126-01">
          <div class="list-header">
            <h1 data-i18n="panel.apiDocs">接口</h1>
          </div>
          <div class="tips" data-i18n="apiDocs.tip">
            用于快速了解 /wunder 接口接入方式、关键字段与常用接口清单。完整字段请参考 docs/API文档.md。
          </div>
          <div class="api-docs-layout">
            <div class="api-docs-side">
              <div class="api-docs-card">
                <div class="api-docs-card-title">
                  <i class="fa-solid fa-compass"></i>
                  <span data-i18n="apiDocs.card.overview">概览</span>
                </div>
                <div class="api-docs-kv">
                  <div class="api-docs-kv-row">
                    <span class="api-docs-kv-label" data-i18n="apiDocs.field.base">Base URL</span>
                    <code id="apiDocsBaseUrl" class="api-docs-kv-value"></code>
                  </div>
                  <div class="api-docs-kv-row">
                    <span class="api-docs-kv-label" data-i18n="apiDocs.field.auth">鉴权</span>
                    <span class="api-docs-kv-value" data-i18n="apiDocs.value.auth">
                      X-API-Key 或 Authorization: Bearer &lt;key&gt;
                    </span>
                  </div>
                  <div class="api-docs-kv-row">
                    <span class="api-docs-kv-label" data-i18n="apiDocs.field.contentType">Content-Type</span>
                    <span class="api-docs-kv-value">application/json</span>
                  </div>
                </div>
                <div class="api-docs-note is-warning" data-i18n="apiDocs.note.concurrent">
                  同一 user_id 同时只允许一个进行中会话，重复请求会返回 429。
                </div>
              </div>
              <div class="api-docs-card api-docs-list-card">
                <div class="api-docs-card-title">
                  <i class="fa-solid fa-list"></i>
                  <span data-i18n="apiDocs.card.list">接口列表</span>
                </div>
                <div id="apiDocsEndpointList" class="api-docs-endpoint-list api-docs-endpoint-groups"></div>
              </div>
            </div>
            <div class="api-docs-main">
              <div class="api-docs-card api-docs-detail-card">
                <div class="api-docs-card-title">
                  <i class="fa-solid fa-circle-info"></i>
                  <span data-i18n="apiDocs.card.detail">接口详情</span>
                </div>
                <div id="apiDocsDetail" class="api-docs-detail"></div>
              </div>
            </div>
          </div>
        </section>
        <section id="paperPanel" class="panel" data-paper-src="/docs/paper.md?v=20260122-03">
          <div class="list-header">
            <h1 data-i18n="paper.title">论文阅读</h1>
            <div class="header-actions">
              <div class="paper-meta">
                <span class="paper-meta-label" data-i18n="paper.meta.source">来源</span>
                <span class="paper-meta-value">/docs/paper.md</span>
              </div>
              <div class="paper-meta">
                <span class="paper-meta-label" data-i18n="paper.meta.updated">更新</span>
                <span class="paper-meta-value">2026-01-22</span>
              </div>
            </div>
          </div>
          <div class="tips" data-i18n="paper.tip">
            用于在管理端快速阅读《智能体调度平台的设计与实现》论文，支持目录跳转与代码块展示。
          </div>
          <div class="paper-layout">
            <div class="paper-side">
              <div class="paper-card">
                <div class="paper-card-title">
                  <i class="fa-solid fa-list"></i>
                  <span data-i18n="paper.toc">目录</span>
                </div>
                <nav id="paperToc" class="paper-toc"></nav>
              </div>
            </div>
            <div class="paper-main">
              <div class="paper-card paper-content-card">
                <article id="paperContent" class="paper-content"></article>
              </div>
            </div>
          </div>
        </section>
      </main>
    </div>
    <div id="settingsAdvancedModal" class="modal">
      <div class="modal-card">
        <div class="modal-header">
          <div class="detail-title" data-i18n="settings.advanced.title">高级设置</div>
          <button
            id="settingsAdvancedModalClose"
            class="icon-btn"
            type="button"
            aria-label="关闭"
            data-i18n-aria-label="common.close"
          >
            ×
          </button>
        </div>
        <div class="modal-body">
          <div class="settings-advanced-layout">
            <div class="settings-card settings-advanced-card">
              <div class="settings-card-title">
                <i class="fa-solid fa-key"></i>
                <span data-i18n="settings.card.api">API & Auth</span>
              </div>
              <div class="settings-card-body">
                <div class="settings-grid settings-advanced-grid">
                  <div class="form-row">
                    <label for="apiKey" data-i18n="settings.label.apiKey">API Key</label>
                    <div class="api-key-field settings-api-key-field">
                      <input
                        id="apiKey"
                        type="password"
                        placeholder="可选"
                        data-i18n-placeholder="settings.placeholder.optional"
                      />
                      <button
                        id="apiKeyToggle"
                        class="api-key-toggle"
                        type="button"
                        aria-label="显示 API Key"
                        title="显示 API Key"
                        data-i18n-aria-label="ui.apiKey.show"
                        data-i18n-title="ui.apiKey.show"
                      >
                        <i class="fa-solid fa-eye"></i>
                      </button>
                    </div>
                  </div>
                </div>
                <div class="settings-hint" data-i18n="settings.hint.advanced">
                  API base 固定为当前访问地址，API Key 默认从服务端配置加载。
                </div>
              </div>
            </div>
            <div class="settings-card settings-card-cors settings-advanced-card">
              <div class="settings-card-title">
                <i class="fa-solid fa-globe"></i>
                <span data-i18n="settings.card.cors">CORS</span>
                <div class="settings-card-badges">
                  <span class="settings-badge settings-badge--restart" data-i18n="settings.badge.restart">Restart</span>
                </div>
              </div>
              <div class="settings-card-body">
                <div class="settings-grid settings-grid--auto">
                  <div class="form-row form-row-span">
                    <label for="settingsCorsOrigins" data-i18n="settings.label.corsOrigins">Allow origins</label>
                    <textarea
                      id="settingsCorsOrigins"
                      placeholder="*"
                      data-i18n-placeholder="settings.placeholder.corsOrigins"
                    ></textarea>
                  </div>
                  <div class="form-row form-row-span">
                    <label for="settingsCorsMethods" data-i18n="settings.label.corsMethods">Allow methods</label>
                    <textarea
                      id="settingsCorsMethods"
                      placeholder="*"
                      data-i18n-placeholder="settings.placeholder.corsMethods"
                    ></textarea>
                  </div>
                  <div class="form-row form-row-span">
                    <label for="settingsCorsHeaders" data-i18n="settings.label.corsHeaders">Allow headers</label>
                    <textarea
                      id="settingsCorsHeaders"
                      placeholder="*"
                      data-i18n-placeholder="settings.placeholder.corsHeaders"
                    ></textarea>
                  </div>
                  <div class="form-row">
                    <label for="settingsCorsCredentials" data-i18n="settings.label.corsCredentials">Credentials</label>
                    <label class="checkbox-row">
                      <input id="settingsCorsCredentials" type="checkbox" />
                      <span data-i18n="settings.option.corsCredentials">Allow credentials</span>
                    </label>
                  </div>
                </div>
                <div class="settings-hint" data-i18n="settings.hint.cors">
                  CORS changes take effect after restart.
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-actions">
          <button id="settingsAdvancedCancel" class="secondary btn-with-icon" type="button">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.close">关闭</span>
          </button>
          <button id="settingsAdvancedSave" class="btn-with-icon" type="button">
            <i class="fa-solid fa-floppy-disk"></i><span data-i18n="common.save">保存</span>
          </button>
        </div>
      </div>
    </div>
    <div id="mcpModal" class="modal">
      <div class="modal-card">
        <div class="modal-header">
          <div id="mcpModalTitle" class="detail-title" data-i18n="mcp.modal.editTitle">编辑 MCP 服务</div>
          <button id="mcpModalClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div class="form-row">
            <label for="mcpName" data-i18n="mcp.form.name">服务名称</label>
            <input
              id="mcpName"
              type="text"
              placeholder="例如：local_tools"
              data-i18n-placeholder="mcp.placeholder.name"
            />
          </div>
          <div class="form-row">
            <label for="mcpDisplayName" data-i18n="mcp.form.displayName">显示名称（可选）</label>
            <input
              id="mcpDisplayName"
              type="text"
              placeholder="用于前端展示"
              data-i18n-placeholder="mcp.placeholder.displayName"
            />
          </div>
          <div class="form-row">
            <label for="mcpEndpoint" data-i18n="mcp.form.endpoint">服务地址</label>
            <input id="mcpEndpoint" type="text" placeholder="http://127.0.0.1:9000/mcp" />
          </div>
          <div class="form-row">
            <label for="mcpTransport" data-i18n="mcp.form.transport">传输类型</label>
            <select id="mcpTransport">
              <option value="">auto</option>
              <option value="sse">sse</option>
              <option value="http">http</option>
              <option value="streamable-http">streamable-http</option>
            </select>
          </div>
          <div class="form-row">
            <label for="mcpDescription" data-i18n="mcp.form.description">服务描述（可选）</label>
            <textarea
              id="mcpDescription"
              placeholder="用于记录服务作用"
              data-i18n-placeholder="mcp.placeholder.description"
            ></textarea>
          </div>
          <div class="form-row">
            <label for="mcpHeaders" data-i18n="mcp.form.headers">请求头（JSON，可选）</label>
            <textarea id="mcpHeaders" placeholder='{"Authorization":"Bearer sk-..."}'></textarea>
            <div id="mcpHeadersError" class="error-text"></div>
          </div>
          <div class="form-row">
            <label>
              <input id="mcpEnabled" type="checkbox" checked />
              <span data-i18n="mcp.form.enabled">启用服务</span>
            </label>
          </div>
          <div class="form-row">
            <label for="mcpStructPreview" data-i18n="mcp.form.preview">JSON 结构体预览（可复制）</label>
            <textarea id="mcpStructPreview" class="code-preview" readonly></textarea>
          </div>
        </div>
        <div class="modal-actions">
          <button id="mcpModalCancel" class="secondary btn-with-icon">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.cancel">取消</span>
          </button>
          <button id="mcpModalSave" class="btn-with-icon">
            <i class="fa-solid fa-check"></i><span data-i18n="common.save">保存</span>
          </button>
        </div>
      </div>
    </div>
    <div id="mcpImportModal" class="modal">
      <div class="modal-card">
        <div class="modal-header">
          <div class="detail-title" data-i18n="mcp.import.title">导入 MCP 结构体</div>
          <button id="mcpImportClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div class="form-row">
            <label for="mcpImportInput" data-i18n="mcp.import.label">MCP 结构体（JSON）</label>
            <textarea
              id="mcpImportInput"
              placeholder='{"mcpServers":{"WebSearch":{"type":"sse","baseUrl":"https://...","headers":{"Authorization":"Bearer sk-..."}}}}'
            ></textarea>
          </div>
        </div>
        <div class="modal-actions">
          <button id="mcpImportCancel" class="secondary btn-with-icon">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.cancel">取消</span>
          </button>
          <button id="mcpImportConfirm" class="btn-with-icon">
            <i class="fa-solid fa-file-import"></i><span data-i18n="common.import">导入</span>
          </button>
        </div>
      </div>
    </div>
    <div id="a2aServiceModal" class="modal">
      <div class="modal-card">
        <div class="modal-header">
          <div id="a2aServiceModalTitle" class="detail-title" data-i18n="a2aServices.modal.editTitle">
            编辑 A2A 服务
          </div>
          <button id="a2aServiceModalClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div class="form-row">
            <label for="a2aServiceName" data-i18n="a2aServices.field.name">服务 ID</label>
            <input id="a2aServiceName" type="text" placeholder="agent-a2a" />
          </div>
          <div class="form-row">
            <label for="a2aServiceDisplayName" data-i18n="a2aServices.field.displayName">展示名</label>
            <input id="a2aServiceDisplayName" type="text" placeholder="外部智能体" />
          </div>
          <div class="form-row">
            <label for="a2aServiceType" data-i18n="a2aServices.field.type">服务类型</label>
            <select id="a2aServiceType">
              <option value="internal" data-i18n="a2aServices.type.internal">内部（Wunder）</option>
              <option value="external" data-i18n="a2aServices.type.external">外部（其它 A2A）</option>
            </select>
          </div>
          <div class="form-row">
            <label for="a2aServiceEndpoint" data-i18n="a2aServices.field.endpoint">A2A Endpoint</label>
            <input id="a2aServiceEndpoint" type="text" placeholder="https://example.com/a2a" />
          </div>
          <div id="a2aServiceUserIdRow" class="form-row">
            <label for="a2aServiceUserId" data-i18n="a2aServices.field.userId">内部 user_id</label>
            <input
              id="a2aServiceUserId"
              type="text"
              placeholder="demo_user"
              data-i18n-placeholder="a2aServices.placeholder.userId"
            />
            <div class="muted" data-i18n="a2aServices.tip.userId">
              内部 A2A 需固定 user_id，挂载工具后无需模型传入。
            </div>
          </div>
          <div class="form-row">
            <label for="a2aServiceDescription" data-i18n="a2aServices.field.description">描述</label>
            <textarea
              id="a2aServiceDescription"
              placeholder="服务用途说明"
              data-i18n-placeholder="a2aServices.placeholder.description"
            ></textarea>
          </div>
          <div class="form-row">
            <label for="a2aServiceHeaders" data-i18n="a2aServices.field.headers">额外 Headers JSON</label>
            <textarea
              id="a2aServiceHeaders"
              class="code-preview"
              placeholder='{"X-API-Key":"demo"}'
            ></textarea>
            <div id="a2aServiceHeadersError" class="error-text"></div>
          </div>
        </div>
        <div class="modal-actions">
          <button id="a2aServiceModalCancel" class="secondary btn-with-icon">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.cancel">取消</span>
          </button>
          <button id="a2aServiceModalSave" class="btn-with-icon">
            <i class="fa-solid fa-floppy-disk"></i><span data-i18n="common.save">保存</span>
          </button>
        </div>
      </div>
    </div>
    <div id="skillModal" class="modal">
      <div class="modal-card">
        <div class="modal-header">
          <div id="skillModalTitle" class="detail-title" data-i18n="skills.detail.title">技能详情</div>
          <button id="skillModalClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div id="skillModalMeta" class="muted"></div>
          <pre id="skillModalContent" class="skill-content"></pre>
        </div>
        <div class="modal-actions">
          <button id="skillModalCloseBtn" class="secondary btn-with-icon">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.close">关闭</span>
          </button>
        </div>
      </div>
    </div>
    <div id="knowledgeModal" class="modal">
      <div class="modal-card">
        <div class="modal-header">
          <div id="knowledgeModalTitle" class="detail-title" data-i18n="knowledge.modal.addTitle">知识库配置</div>
          <button id="knowledgeModalClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div class="form-row">
            <label for="knowledgeModalName" data-i18n="knowledge.modal.field.name">名称</label>
            <input
              id="knowledgeModalName"
              type="text"
              placeholder="知识库工具名称"
              data-i18n-placeholder="knowledge.modal.placeholder.name"
            />
          </div>
          <div id="knowledgeModalTypeRow" class="form-row">
            <label for="knowledgeModalType" data-i18n="knowledge.modal.field.type">类型</label>
            <select id="knowledgeModalType">
              <option value="literal" data-i18n="knowledge.type.literal">字面知识库</option>
              <option value="vector" data-i18n="knowledge.type.vector">向量知识库</option>
            </select>
          </div>
          <div id="knowledgeModalEmbeddingRow" class="form-row" hidden>
            <label for="knowledgeModalEmbeddingModel" data-i18n="knowledge.modal.field.embeddingModel">嵌入模型</label>
            <select id="knowledgeModalEmbeddingModel"></select>
          </div>
          <div id="knowledgeModalChunkRow" class="grid knowledge-modal-grid" hidden>
            <div class="form-row">
              <label for="knowledgeModalChunkSize" data-i18n="knowledge.modal.field.chunkSize">切片长度</label>
              <input
                id="knowledgeModalChunkSize"
                type="number"
                min="100"
                step="1"
                placeholder="800"
                data-i18n-placeholder="knowledge.modal.placeholder.chunkSize"
              />
            </div>
            <div class="form-row">
              <label for="knowledgeModalChunkOverlap" data-i18n="knowledge.modal.field.chunkOverlap">切片重叠</label>
              <input
                id="knowledgeModalChunkOverlap"
                type="number"
                min="0"
                step="1"
                placeholder="100"
                data-i18n-placeholder="knowledge.modal.placeholder.chunkOverlap"
              />
            </div>
          </div>
          <div id="knowledgeModalSearchRow" class="grid knowledge-modal-grid" hidden>
            <div class="form-row">
              <label for="knowledgeModalTopK" data-i18n="knowledge.modal.field.topK">Top K</label>
              <input
                id="knowledgeModalTopK"
                type="number"
                min="1"
                step="1"
                placeholder="5"
                data-i18n-placeholder="knowledge.modal.placeholder.topK"
              />
            </div>
            <div class="form-row">
              <label for="knowledgeModalScoreThreshold" data-i18n="knowledge.modal.field.scoreThreshold">相似度阈值</label>
              <input
                id="knowledgeModalScoreThreshold"
                type="number"
                min="0"
                max="1"
                step="0.01"
                placeholder="0.5"
                data-i18n-placeholder="knowledge.modal.placeholder.scoreThreshold"
              />
            </div>
          </div>
          <div id="knowledgeModalRootRow" class="form-row">
            <label for="knowledgeModalRoot" data-i18n="knowledge.modal.field.root">目录</label>
            <input
              id="knowledgeModalRoot"
              type="text"
              placeholder="可留空，自动创建 ./knowledge/<名称>"
              data-i18n-placeholder="knowledge.modal.placeholder.root"
            />
            <div
              id="knowledgeModalRootHint"
              class="muted"
              data-i18n="knowledge.modal.tip.vectorRoot"
              hidden
            >
              向量知识库目录由系统自动生成
            </div>
          </div>
          <div class="form-row">
            <label for="knowledgeModalDesc" data-i18n="knowledge.modal.field.description">描述</label>
            <textarea
              id="knowledgeModalDesc"
              placeholder="知识库用途说明"
              data-i18n-placeholder="knowledge.modal.placeholder.description"
            ></textarea>
          </div>
          <div class="form-row">
            <label class="checkbox-row">
              <input id="knowledgeModalEnabled" type="checkbox" checked />
              <span data-i18n="common.enabled">启用</span>
            </label>
          </div>
        </div>
        <div class="modal-actions">
          <button id="knowledgeModalCancel" class="secondary btn-with-icon">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.cancel">取消</span>
          </button>
          <button id="knowledgeModalSave" class="btn-with-icon">
            <i class="fa-solid fa-check"></i><span data-i18n="common.save">保存</span>
          </button>
        </div>
      </div>
    </div>
    <div id="knowledgeChunkModal" class="modal">
      <div class="modal-card">
        <div class="modal-header">
          <div id="knowledgeChunkModalTitle" class="detail-title" data-i18n="knowledge.chunk.modal.title">编辑切片</div>
          <button id="knowledgeChunkModalClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div class="form-row">
            <label for="knowledgeChunkModalContent" data-i18n="knowledge.chunk.modal.field.content">切片内容</label>
            <textarea
              id="knowledgeChunkModalContent"
              rows="8"
              placeholder="编辑切片内容"
              data-i18n-placeholder="knowledge.chunk.modal.placeholder.content"
            ></textarea>
          </div>
        </div>
        <div class="modal-actions">
          <button id="knowledgeChunkModalCancel" class="secondary btn-with-icon">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.cancel">取消</span>
          </button>
          <button id="knowledgeChunkModalSave" class="btn-with-icon">
            <i class="fa-solid fa-check"></i><span data-i18n="common.save">保存</span>
          </button>
        </div>
      </div>
    </div>
    <div id="knowledgeDocModal" class="modal">
      <div class="modal-card modal-card-lg">
        <div class="modal-header">
          <div id="knowledgeDocModalTitle" class="detail-title" data-i18n="knowledge.doc.modal.title">原文档</div>
          <button id="knowledgeDocModalClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div id="knowledgeDocModalMeta" class="muted"></div>
          <div id="knowledgeDocModalContent" class="knowledge-doc-modal-content"></div>
        </div>
        <div class="modal-actions">
          <button id="knowledgeDocModalCloseBtn" class="secondary btn-with-icon">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.close">关闭</span>
          </button>
        </div>
      </div>
    </div>
    <div id="knowledgeTestModal" class="modal">
      <div class="modal-card modal-card-lg">
        <div class="modal-header">
          <div id="knowledgeTestModalTitle" class="detail-title" data-i18n="knowledge.test.title">向量知识库测试</div>
          <button id="knowledgeTestModalClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div class="knowledge-test-layout">
            <div class="knowledge-test-input">
              <label for="knowledgeTestQuestion" data-i18n="knowledge.test.question">问题</label>
              <textarea
                id="knowledgeTestQuestion"
                rows="8"
                placeholder="请输入测试问题"
                data-i18n-placeholder="knowledge.test.question.placeholder"
              ></textarea>
              <div class="knowledge-test-actions">
                <button id="knowledgeTestRunBtn" class="btn-with-icon">
                  <i class="fa-solid fa-play"></i><span data-i18n="knowledge.test.action.run">测试</span>
                </button>
                <div id="knowledgeTestStatus" class="muted"></div>
              </div>
            </div>
            <div class="knowledge-test-results">
              <div class="knowledge-doc-section-title" data-i18n="knowledge.test.result.title">召回结果</div>
              <div id="knowledgeTestResult" class="knowledge-test-result-list"></div>
            </div>
          </div>
        </div>
        <div class="modal-actions">
          <button id="knowledgeTestModalCloseBtn" class="secondary btn-with-icon">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.close">关闭</span>
          </button>
        </div>
      </div>
    </div>
    <div id="userKnowledgeModal" class="modal">
      <div class="modal-card">
        <div class="modal-header">
          <div id="userKnowledgeModalTitle" class="detail-title" data-i18n="userTools.knowledge.modal.title">知识库配置</div>
          <button id="userKnowledgeModalClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div class="form-row">
            <label for="userKnowledgeModalName" data-i18n="userTools.knowledge.modal.field.name">名称</label>
            <input
              id="userKnowledgeModalName"
              type="text"
              placeholder="知识库名称"
              data-i18n-placeholder="userTools.knowledge.modal.placeholder.name"
            />
          </div>
          <div class="form-row">
            <label for="userKnowledgeModalDesc" data-i18n="userTools.knowledge.modal.field.description">描述</label>
            <textarea
              id="userKnowledgeModalDesc"
              placeholder="知识库用途说明"
              data-i18n-placeholder="userTools.knowledge.modal.placeholder.description"
            ></textarea>
          </div>
          <div class="form-row">
            <label class="checkbox-row">
              <input id="userKnowledgeModalEnabled" type="checkbox" checked />
              <span data-i18n="common.enabled">启用</span>
            </label>
          </div>
          <div class="form-row">
            <label class="checkbox-row">
              <input id="userKnowledgeModalShared" type="checkbox" />
              <span data-i18n="common.shared">共享</span>
            </label>
          </div>
          <div class="muted" data-i18n="userTools.knowledge.modal.tip">
            目录固定在 data/user_tools/&lt;user&gt;/knowledge/&lt;名称&gt;，保存后自动生成。
          </div>
        </div>
        <div class="modal-actions">
          <button id="userKnowledgeModalCancel" class="secondary btn-with-icon">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.cancel">取消</span>
          </button>
          <button id="userKnowledgeModalSave" class="btn-with-icon">
            <i class="fa-solid fa-check"></i><span data-i18n="common.save">保存</span>
          </button>
        </div>
      </div>
    </div>
    <div id="userToolModal" class="modal">
      <div class="modal-card modal-card-lg user-tool-modal-card">
        <div class="modal-header">
          <div class="detail-title" data-i18n="userTools.title">自建工具</div>
          <button id="userToolModalClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div class="user-tool-layout">
            <div class="user-tool-sidebar">
              <div class="user-tool-sidebar-title" data-i18n="userTools.category.title">工具分类</div>
              <button id="userToolTabMcp" class="tab-btn active" type="button" data-i18n="userTools.tab.mcp">MCP 工具</button>
              <button id="userToolTabSkills" class="tab-btn" type="button" data-i18n="userTools.tab.skills">技能工具</button>
              <button id="userToolTabKnowledge" class="tab-btn" type="button" data-i18n="userTools.tab.knowledge">知识库工具</button>
            </div>
            <div class="user-tool-content">
              <div id="userToolPaneMcp" class="user-tool-pane active">
                <div class="list-header">
                  <label data-i18n="userTools.mcp.title">我的 MCP 服务</label>
                  <div class="header-actions">
                    <button id="userMcpRefreshAllBtn" class="secondary btn-with-icon btn-compact" type="button">
                      <i class="fa-solid fa-arrows-rotate"></i><span data-i18n="mcp.refresh.all">全部刷新</span>
                    </button>
                    <button id="userMcpImportBtn" class="secondary btn-with-icon btn-compact" type="button">
                      <i class="fa-solid fa-file-import"></i><span data-i18n="mcp.import.action">导入服务</span>
                    </button>
                  </div>
                </div>
                <div class="tips" data-i18n="userTools.mcp.tip">
                  配置个人 MCP 服务并选择共享工具，工具会以 user_id@server@tool 形式注入系统提示词。
                </div>
                <div class="management-layout">
                  <div class="management-list">
                    <div class="list-header">
                      <label data-i18n="mcp.list.title">服务列表</label>
                    </div>
                    <div id="userMcpServerList" class="list-body"></div>
                  </div>
                  <div class="management-detail">
                    <div class="detail-header">
                      <div>
                        <div id="userMcpDetailTitle" class="detail-title" data-i18n="mcp.detail.none">未选择服务</div>
                        <div id="userMcpDetailMeta" class="muted"></div>
                        <div id="userMcpDetailDesc" class="muted"></div>
                      </div>
                    </div>
                    <div class="detail-actions">
                      <div class="actions">
                        <button id="userMcpConnectBtn" class="btn-with-icon">
                          <i class="fa-solid fa-link"></i>连接
                        </button>
                        <button id="userMcpEnableAllBtn" class="secondary btn-with-icon">
                          <i class="fa-solid fa-check-double"></i><span data-i18n="mcp.tools.enableAll">全选</span>
                        </button>
                        <button id="userMcpDisableAllBtn" class="secondary btn-with-icon">
                          <i class="fa-solid fa-ban"></i><span data-i18n="mcp.tools.disableAll">全不选</span>
                        </button>
                      </div>
                      <div class="actions">
                        <button id="userMcpEditBtn" class="secondary btn-with-icon">
                          <i class="fa-solid fa-pen-to-square"></i><span data-i18n="mcp.action.edit">编辑服务</span>
                        </button>
                        <button id="userMcpDeleteBtn" class="danger btn-with-icon">
                          <i class="fa-solid fa-trash"></i><span data-i18n="mcp.action.delete">删除服务</span>
                        </button>
                      </div>
                    </div>
                    <div class="muted" data-i18n="userTools.mcp.tip.tools">勾选启用/共享后将出现在系统提示词工具列表中。</div>
                    <div id="userMcpToolList" class="tool-list"></div>
                  </div>
                </div>
              </div>
              <div id="userToolPaneSkills" class="user-tool-pane">
                <div class="list-header">
                  <label data-i18n="userTools.skills.title">技能管理</label>
                  <div class="header-actions">
                    <button id="userSkillUploadBtn" class="secondary btn-with-icon btn-compact" type="button">
                      <i class="fa-solid fa-plus"></i><span data-i18n="userTools.skills.action.upload">上传技能包</span>
                    </button>
                    <button id="userSkillRefreshBtn" class="secondary btn-with-icon btn-compact" type="button">
                      <i class="fa-solid fa-arrows-rotate"></i><span data-i18n="common.refresh">刷新</span>
                    </button>
                  </div>
                </div>
                <div class="tips" data-i18n="userTools.skills.tip">
                  技能名称会以 user_id@技能名 展示，勾选共享即可让其他用户使用。
                </div>
                <input id="userSkillUploadInput" type="file" accept=".zip,.skill" hidden />
                <div id="userSkillsList" class="skills-list"></div>
              </div>
              <div id="userToolPaneKnowledge" class="user-tool-pane">
                <div class="list-header">
                  <label data-i18n="userTools.knowledge.title">知识库管理</label>
                  <div class="header-actions">
                    <button id="userKnowledgeAddBtn" class="secondary btn-with-icon btn-compact" type="button">
                      <i class="fa-solid fa-plus"></i><span data-i18n="knowledge.action.add">新增</span>
                    </button>
                    <button id="userKnowledgeRefreshBtn" class="secondary btn-with-icon btn-compact" type="button">
                      <i class="fa-solid fa-arrows-rotate"></i><span data-i18n="common.refresh">刷新</span>
                    </button>
                  </div>
                </div>
                <div class="tips" data-i18n="userTools.knowledge.tip">
                  知识库目录固定在 data/user_tools/&lt;user&gt;/knowledge，工具名称会以 user_id@知识库名 展示，新增或编辑在弹窗中完成。
                </div>
                <div class="management-layout knowledge-layout">
                  <div class="management-list">
                    <div class="list-header">
                      <label data-i18n="knowledge.list.title">知识库列表</label>
                    </div>
                    <div id="userKnowledgeBaseList" class="list-body"></div>
                  </div>
                  <div class="management-detail knowledge-detail">
                    <div class="detail-header">
                      <div>
                        <div id="userKnowledgeDetailTitle" class="detail-title" data-i18n="knowledge.detail.empty">未选择知识库</div>
                        <div id="userKnowledgeDetailMeta" class="muted"></div>
                        <div id="userKnowledgeDetailDesc" class="muted"></div>
                      </div>
                      <div class="detail-actions">
                        <button id="userKnowledgeEditBtn" class="secondary btn-with-icon btn-compact">
                          <i class="fa-solid fa-pen"></i><span data-i18n="common.edit">编辑</span>
                        </button>
                        <button id="userKnowledgeDeleteBtn" class="danger btn-with-icon btn-compact">
                          <i class="fa-solid fa-trash"></i><span data-i18n="knowledge.action.delete">删除知识库</span>
                        </button>
                      </div>
                    </div>
                    <div class="knowledge-section form-section">
                      <div class="knowledge-content">
                        <div class="llm-card knowledge-files-card">
                          <div class="knowledge-file-layout">
                            <div class="knowledge-file-pane">
                              <div class="knowledge-file-toolbar">
                                <button id="userKnowledgeFileUploadBtn" class="secondary btn-with-icon btn-compact">
                                  <i class="fa-solid fa-upload"></i><span data-i18n="common.upload">上传</span>
                                </button>
                                <button id="userKnowledgeFileNewBtn" class="secondary btn-with-icon btn-compact">
                                  <i class="fa-solid fa-file-circle-plus"></i><span data-i18n="common.new">新建</span>
                                </button>
                                <button id="userKnowledgeFileSaveBtn" class="btn-with-icon btn-compact">
                                  <i class="fa-solid fa-floppy-disk"></i><span data-i18n="common.save">保存</span>
                                </button>
                              </div>
                              <div id="userKnowledgeFileList" class="knowledge-file-list"></div>
                            </div>
                              <div class="knowledge-file-editor">
                                <div id="userKnowledgeFileName" class="muted" data-i18n="knowledge.file.none">未选择文档</div>
                                <div class="knowledge-editor-wrapper">
                                  <div
                                    id="userKnowledgeFileHighlight"
                                    class="knowledge-editor-highlight"
                                    aria-hidden="true"
                                  ></div>
                                  <textarea id="userKnowledgeFileContent"></textarea>
                                </div>
                              </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <input id="userKnowledgeFileUploadInput" type="file" hidden />
              </div>
              <div id="userToolSaveStatus" class="muted"></div>
            </div>
          </div>
        </div>
        <div class="modal-actions">
          <button id="userToolModalCloseBtn" class="secondary btn-with-icon" type="button">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.close">关闭</span>
          </button>
        </div>
      </div>
    </div>
    <div id="userMcpModal" class="modal">
      <div class="modal-card">
        <div class="modal-header">
          <div id="userMcpModalTitle" class="detail-title" data-i18n="userTools.mcp.modal.editTitle">编辑 MCP 服务</div>
          <button id="userMcpModalClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div class="form-row">
            <label for="userMcpName" data-i18n="mcp.form.name">服务名称</label>
            <input
              id="userMcpName"
              type="text"
              placeholder="例如：local_tools"
              data-i18n-placeholder="mcp.placeholder.name"
            />
          </div>
          <div class="form-row">
            <label for="userMcpDisplayName" data-i18n="mcp.form.displayName">显示名称（可选）</label>
            <input
              id="userMcpDisplayName"
              type="text"
              placeholder="用于前端展示"
              data-i18n-placeholder="mcp.placeholder.displayName"
            />
          </div>
          <div class="form-row">
            <label for="userMcpEndpoint" data-i18n="mcp.form.endpoint">服务地址</label>
            <input id="userMcpEndpoint" type="text" placeholder="http://127.0.0.1:9000/mcp" />
          </div>
          <div class="form-row">
            <label for="userMcpTransport" data-i18n="mcp.form.transport">传输类型</label>
            <select id="userMcpTransport">
              <option value="">auto</option>
              <option value="sse">sse</option>
              <option value="http">http</option>
              <option value="streamable-http">streamable-http</option>
            </select>
          </div>
          <div class="form-row">
            <label for="userMcpDescription" data-i18n="mcp.form.description">服务描述（可选）</label>
            <textarea
              id="userMcpDescription"
              placeholder="用于记录服务作用"
              data-i18n-placeholder="mcp.placeholder.description"
            ></textarea>
          </div>
          <div class="form-row">
            <label for="userMcpHeaders" data-i18n="mcp.form.headers">Headers JSON（可选）</label>
            <textarea id="userMcpHeaders" placeholder='{"Authorization":"Bearer ..."}'></textarea>
            <div id="userMcpHeadersError" class="error-text"></div>
          </div>
          <div class="form-row">
            <label class="checkbox-row">
              <input id="userMcpEnabled" type="checkbox" />
              <span data-i18n="mcp.form.enabled">启用服务</span>
            </label>
          </div>
          <div class="form-row">
            <label for="userMcpStructPreview" data-i18n="mcp.form.preview">JSON 结构体预览（可复制）</label>
            <textarea id="userMcpStructPreview" class="code-preview" readonly></textarea>
          </div>
        </div>
        <div class="modal-actions">
          <button id="userMcpModalCancel" class="secondary btn-with-icon">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.cancel">取消</span>
          </button>
          <button id="userMcpModalSave" class="btn-with-icon">
            <i class="fa-solid fa-floppy-disk"></i><span data-i18n="common.save">保存</span>
          </button>
        </div>
      </div>
    </div>
    <div id="userMcpImportModal" class="modal">
      <div class="modal-card">
        <div class="modal-header">
          <div class="detail-title" data-i18n="userTools.mcp.import.title">导入 MCP 服务</div>
          <button id="userMcpImportClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div class="form-row">
            <label for="userMcpImportInput" data-i18n="mcp.import.label">MCP 结构体（JSON）</label>
            <textarea
              id="userMcpImportInput"
              placeholder='{"mcpServers":{"WebSearch":{"type":"sse","baseUrl":"https://...","headers":{"Authorization":"Bearer sk-..."}}}}'
            ></textarea>
          </div>
        </div>
        <div class="modal-actions">
          <button id="userMcpImportCancel" class="secondary btn-with-icon">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.cancel">取消</span>
          </button>
          <button id="userMcpImportConfirm" class="btn-with-icon">
            <i class="fa-solid fa-file-import"></i><span data-i18n="common.import">导入</span>
          </button>
        </div>
      </div>
    </div>
    <div id="userAccountModal" class="modal">
      <div class="modal-card">
        <div class="modal-header">
          <div id="userAccountModalTitle" class="detail-title" data-i18n="userAccounts.modal.create.title">
            新增用户
          </div>
          <button id="userAccountModalClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div class="form-row">
            <label for="userAccountFormUsername" data-i18n="userAccounts.modal.create.username">用户名</label>
            <input id="userAccountFormUsername" type="text" />
          </div>
          <div class="form-row">
            <label for="userAccountFormEmail" data-i18n="userAccounts.modal.create.email">邮箱</label>
            <input id="userAccountFormEmail" type="email" />
          </div>
          <div class="form-row">
            <label for="userAccountFormPassword" data-i18n="userAccounts.modal.create.password">密码</label>
            <input id="userAccountFormPassword" type="password" />
          </div>
          <div class="form-row">
            <label for="userAccountFormUnit" data-i18n="userAccounts.modal.create.unit">所属单位</label>
            <select id="userAccountFormUnit">
              <option value="" data-i18n="userAccounts.modal.create.unit.default">默认单位</option>
            </select>
          </div>
          <div class="form-row">
            <label for="userAccountFormStatus" data-i18n="userAccounts.modal.create.status">状态</label>
            <select id="userAccountFormStatus">
              <option value="active">active</option>
              <option value="disabled">disabled</option>
            </select>
          </div>
        </div>
        <div class="modal-actions">
          <button id="userAccountModalCancel" class="secondary btn-with-icon" type="button">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.cancel">取消</span>
          </button>
          <button id="userAccountModalSave" class="btn-with-icon" type="button">
            <i class="fa-solid fa-floppy-disk"></i><span data-i18n="common.save">保存</span>
          </button>
        </div>
      </div>
    </div>
    <div id="userAccountSeedModal" class="modal">
      <div class="modal-card">
        <div class="modal-header">
          <div class="detail-title" data-i18n="userAccounts.modal.seed.title">新增测试用户</div>
          <button id="userAccountSeedModalClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div class="form-row">
            <label for="userAccountSeedCount" data-i18n="userAccounts.modal.seed.count.label">每单位新增数量</label>
            <input id="userAccountSeedCount" type="number" min="1" step="1" />
          </div>
          <div class="form-row">
            <div id="userAccountSeedHint" class="muted" data-i18n="userAccounts.modal.seed.hint">
              将为每个单位随机生成测试用户，默认密码为 Test@123456。
            </div>
          </div>
        </div>
        <div class="modal-actions">
          <button id="userAccountSeedModalCancel" class="secondary btn-with-icon" type="button">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.cancel">取消</span>
          </button>
          <button id="userAccountSeedModalConfirm" class="btn-with-icon" type="button">
            <i class="fa-solid fa-flask"></i><span data-i18n="userAccounts.modal.seed.action">新增</span>
          </button>
        </div>
      </div>
    </div>
    <div id="userAccountSettingsModal" class="modal">
      <div class="modal-card modal-card-lg">
        <div class="modal-header">
          <div id="userAccountSettingsTitle" class="detail-title" data-i18n="userAccounts.modal.settings.title">
            用户设置
          </div>
          <button id="userAccountSettingsClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div class="form-row">
            <label data-i18n="userAccounts.modal.settings.user">用户</label>
            <div id="userAccountSettingsUser" class="muted">-</div>
          </div>
          <div class="form-row">
            <label for="userAccountQuotaInput" data-i18n="userAccounts.modal.settings.quota.label">每日额度</label>
            <div class="form-row-inline">
              <input id="userAccountQuotaInput" type="number" min="0" step="1" />
              <button id="userAccountQuotaSave" class="secondary btn-with-icon" type="button">
                <i class="fa-solid fa-floppy-disk"></i><span data-i18n="common.save">保存</span>
              </button>
            </div>
            <div id="userAccountQuotaMeta" class="muted" data-i18n="userAccounts.modal.settings.quota.meta">
              今日已用 0 / 剩余 0（总额 0）
            </div>
          </div>
          <div class="form-row">
            <label for="userAccountSettingsPasswordInput" data-i18n="userAccounts.modal.settings.password.label">
              重置密码
            </label>
            <div class="form-row-inline">
              <input id="userAccountSettingsPasswordInput" type="password" />
              <button id="userAccountSettingsPasswordSave" class="secondary btn-with-icon" type="button">
                <i class="fa-solid fa-key"></i><span data-i18n="userAccounts.modal.settings.password.action">重置</span>
              </button>
            </div>
          </div>
          <div class="form-row">
            <label for="userAccountSettingsRolesInput" data-i18n="userAccounts.modal.settings.roles.label">用户权限</label>
            <div class="form-row-inline">
              <select id="userAccountSettingsRolesInput">
                <option value="user" data-i18n="userAccounts.role.user">user</option>
                <option value="admin" data-i18n="userAccounts.role.admin">admin</option>
              </select>
              <button id="userAccountSettingsRolesSave" class="secondary btn-with-icon" type="button">
                <i class="fa-solid fa-floppy-disk"></i><span data-i18n="common.save">保存</span>
              </button>
            </div>
            <div class="muted" data-i18n="userAccounts.modal.settings.roles.hint">user / admin</div>
          </div>
          <div class="form-row">
            <label for="userAccountSettingsUnitSelect" data-i18n="userAccounts.modal.settings.unit.label">
              所属单位
            </label>
            <div class="form-row-inline">
              <select id="userAccountSettingsUnitSelect">
                <option value="" data-i18n="userAccounts.modal.settings.unit.default">默认单位</option>
              </select>
              <button id="userAccountSettingsUnitSave" class="secondary btn-with-icon" type="button">
                <i class="fa-solid fa-floppy-disk"></i><span data-i18n="common.save">保存</span>
              </button>
            </div>
            <div class="muted" data-i18n="userAccounts.modal.settings.unit.hint">
              变更单位后会自动匹配该层级的默认额度。
            </div>
          </div>
          <div class="form-row">
            <label for="userAccountToolDefault" data-i18n="userAccounts.modal.tool.default">
              使用默认权限
            </label>
            <label class="checkbox-row">
              <input id="userAccountToolDefault" type="checkbox" />
              <span data-i18n="userAccounts.modal.tool.defaultHint">默认全量工具，可用白名单覆盖</span>
            </label>
          </div>
          <div class="form-row">
            <label for="userAccountToolList" data-i18n="userAccounts.modal.tool.allowed">可用工具</label>
            <div id="userAccountToolList" class="tool-list"></div>
            <div id="userAccountToolEmpty" class="muted" data-i18n="userAccounts.modal.tool.empty">暂无工具</div>
            <div class="muted" data-i18n="userAccounts.modal.tool.tip">
              默认权限为全量工具，可在此配置白名单。
            </div>
          </div>
        </div>
        <div class="modal-actions">
          <button id="userAccountSettingsDelete" class="danger btn-with-icon" type="button">
            <i class="fa-solid fa-trash"></i><span data-i18n="common.delete">删除</span>
          </button>
          <button id="userAccountSettingsCancel" class="secondary btn-with-icon" type="button">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.close">关闭</span>
          </button>
        </div>
      </div>
    </div>
    <div id="orgUnitModal" class="modal">
      <div class="modal-card">
        <div class="modal-header">
          <div id="orgUnitModalTitle" class="detail-title" data-i18n="orgUnits.modal.title">
            新增单位
          </div>
          <button id="orgUnitModalClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div class="form-row">
            <label for="orgUnitModalName" data-i18n="orgUnits.modal.name">单位名称</label>
            <input id="orgUnitModalName" type="text" />
          </div>
          <div class="form-row">
            <label for="orgUnitModalParent" data-i18n="orgUnits.modal.parent">上级单位</label>
            <select id="orgUnitModalParent">
              <option value="" data-i18n="orgUnits.modal.parent.root">作为一级单位</option>
            </select>
          </div>
          <div class="form-row">
            <label for="orgUnitModalSortOrder" data-i18n="orgUnits.modal.sortOrder">排序</label>
            <input id="orgUnitModalSortOrder" type="number" min="0" step="1" />
          </div>
          <div class="form-row">
            <label for="orgUnitModalLeaders" data-i18n="orgUnits.modal.leaders">负责人</label>
            <input
              id="orgUnitModalLeaders"
              type="text"
              placeholder="用户ID逗号分隔"
              data-i18n-placeholder="orgUnits.form.leaders.placeholder"
            />
            <div class="muted" data-i18n="orgUnits.form.leaders.hint">
              填写负责人的用户ID，逗号分隔。
            </div>
          </div>
        </div>
        <div class="modal-actions">
          <button id="orgUnitModalCancel" class="secondary btn-with-icon" type="button">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.cancel">取消</span>
          </button>
          <button id="orgUnitModalSave" class="btn-with-icon" type="button">
            <i class="fa-solid fa-floppy-disk"></i><span data-i18n="common.save">保存</span>
          </button>
        </div>
      </div>
    </div>
<div id="toolDetailModal" class="modal tool-detail-modal">
      <div class="modal-card tool-detail-card">
        <div class="modal-header">
          <div id="toolDetailTitle" class="detail-title" data-i18n="tool.detail.title">工具详情</div>
          <button id="toolDetailClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div class="tool-detail-layout">
            <div class="tool-detail-left">
              <div id="toolDetailMeta" class="muted"></div>
              <div class="form-row">
                <label data-i18n="tool.detail.label.description">描述</label>
                <div id="toolDetailDesc" class="tool-desc"></div>
              </div>
              <div class="form-row">
                <label data-i18n="tool.detail.label.schema">输入结构</label>
                <pre id="toolDetailSchema" class="tool-schema"></pre>
              </div>
            </div>
            <div class="tool-detail-right mcp-test-panel">
              <div class="list-header">
                <label data-i18n="mcp.test.title">工具测试</label>
                <button id="mcpTestClearBtn" class="secondary btn-with-icon btn-compact" type="button">
                  <i class="fa-solid fa-broom"></i>
                  <span data-i18n="mcp.test.clear">清空</span>
                </button>
              </div>
              <div class="detail-header">
                <div>
                  <div id="mcpTestToolTitle" class="detail-title" data-i18n="mcp.test.empty">
                    请选择工具
                  </div>
                  <div id="mcpTestToolMeta" class="muted"></div>
                  <div id="mcpTestToolDesc" class="muted"></div>
                </div>
              </div>
              <div id="mcpTestForm" class="mcp-test-form"></div>
              <div class="detail-actions mcp-test-actions">
                <div class="actions">
                  <button id="mcpTestRunBtn" class="btn-with-icon" type="button" disabled>
                    <i class="fa-solid fa-play"></i>
                    <span data-i18n="mcp.test.run">测试</span>
                  </button>
                </div>
              </div>
              <div id="mcpTestStatus" class="muted mcp-test-status"></div>
              <div class="form-row">
                <label data-i18n="mcp.test.result">返回结果</label>
                <pre id="mcpTestResult" class="tool-schema"></pre>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-actions">
          <button id="toolDetailCloseBtn" class="secondary btn-with-icon">
            <i class="fa-solid fa-xmark"></i>
            <span data-i18n="tool.detail.close">关闭</span>
          </button>
        </div>
      </div>
    </div>
    <div id="workspacePreviewModal" class="modal">
      <div class="modal-card">
        <div class="modal-header">
          <div id="workspacePreviewTitle" class="detail-title" data-i18n="workspace.preview.title">文件预览</div>
          <button id="workspacePreviewClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div id="workspacePreviewMeta" class="muted"></div>
          <div id="workspacePreviewHint" class="muted"></div>
          <div id="workspacePreviewContainer" class="workspace-preview"></div>
        </div>
        <div class="modal-actions">
          <button id="workspacePreviewDownload" class="secondary btn-with-icon">
            <i class="fa-solid fa-download"></i><span data-i18n="workspace.action.download">下载</span>
          </button>
          <button id="workspacePreviewCloseBtn" class="secondary btn-with-icon">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.close">关闭</span>
          </button>
        </div>
      </div>
    </div>
    <input id="skillUploadInput" type="file" accept=".zip,.skill" style="display: none" />
    <input id="workspaceUploadInput" type="file" style="display: none" multiple />
    <input id="debugUploadInput" type="file" style="display: none" multiple />
    <div id="workspaceMenu" class="context-menu">
      <button id="workspaceNewFileMenuBtn" class="btn-with-icon" type="button">
        <i class="fa-solid fa-file-circle-plus"></i><span data-i18n="workspace.action.newFile">新建文件</span>
      </button>
      <button id="workspaceEditBtn" class="btn-with-icon" type="button">
        <i class="fa-solid fa-pen-to-square"></i><span data-i18n="common.edit">编辑</span>
      </button>
      <button id="workspaceRenameBtn" class="btn-with-icon" type="button">
        <i class="fa-solid fa-i-cursor"></i><span data-i18n="workspace.action.rename">重命名</span>
      </button>
      <button id="workspaceMoveBtn" class="btn-with-icon" type="button">
        <i class="fa-solid fa-arrow-right-arrow-left"></i><span data-i18n="workspace.action.move">移动</span>
      </button>
      <button id="workspaceCopyBtn" class="btn-with-icon" type="button">
        <i class="fa-solid fa-copy"></i><span data-i18n="workspace.action.copy">复制</span>
      </button>
      <button id="workspaceNewFolderBtn" class="btn-with-icon" type="button">
        <i class="fa-solid fa-folder-plus"></i><span data-i18n="workspace.action.newFolder">新建文件夹</span>
      </button>
      <button id="workspaceDownloadBtn" class="btn-with-icon" type="button">
        <i class="fa-solid fa-download"></i><span data-i18n="workspace.action.download">下载</span>
      </button>
      <button id="workspaceDeleteBtn" class="danger btn-with-icon" type="button">
        <i class="fa-solid fa-trash"></i><span data-i18n="workspace.action.delete">删除</span>
      </button>
    </div>
    <div id="debugQuestionMenu" class="context-menu debug-question-menu"></div>
    <div id="debugHistoryModal" class="modal">
      <div class="modal-card">
        <div class="modal-header">
          <div>
            <div class="detail-title" data-i18n="debug.history.title">调试历史</div>
            <div id="debugHistoryMeta" class="muted"></div>
          </div>
          <button id="debugHistoryClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div class="list-header">
            <label data-i18n="debug.history.list.title">会话列表</label>
          </div>
          <div id="debugHistoryList" class="list-body"></div>
        </div>
        <div class="modal-actions">
          <button id="debugHistoryCloseBtn" class="secondary btn-with-icon">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.close">关闭</span>
          </button>
        </div>
      </div>
    </div>
    <div id="throughputHistoryModal" class="modal">
      <div class="modal-card modal-card-lg">
        <div class="modal-header">
          <div>
            <div class="detail-title" data-i18n="throughput.history.title">压测历史</div>
            <div id="throughputHistoryMeta" class="muted"></div>
          </div>
          <button id="throughputHistoryClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div class="monitor-table-wrap">
              <table class="monitor-table throughput-history-table">
                <colgroup>
                  <col class="col-time" />
                  <col class="col-status" />
                  <col class="col-max-concurrency" />
                  <col class="col-concurrency-list" />
                  <col class="col-total" />
                  <col class="col-success-rate" />
                  <col class="col-avg-latency" />
                  <col class="col-rps" />
                  <col class="col-dataset" />
                  <col class="col-actions" />
                </colgroup>
                <thead>
                  <tr>
                    <th data-i18n="throughput.history.startedAt">开始时间</th>
                    <th data-i18n="throughput.history.status">状态</th>
                    <th data-i18n="throughput.history.maxConcurrency">最大并发</th>
                    <th data-i18n="throughput.history.concurrencyList">并发列表</th>
                    <th data-i18n="throughput.history.total">总请求</th>
                    <th data-i18n="throughput.history.successRate">成功率</th>
                    <th data-i18n="throughput.history.avgLatency">平均延迟</th>
                    <th data-i18n="throughput.history.rps">RPS</th>
                    <th data-i18n="throughput.history.dataset">题库</th>
                    <th data-i18n="throughput.history.action">操作</th>
                  </tr>
              </thead>
              <tbody id="throughputHistoryList"></tbody>
            </table>
            <div id="throughputHistoryEmpty" class="muted" data-i18n="throughput.history.empty">
              暂无压测历史
            </div>
          </div>
        </div>
        <div class="modal-actions">
          <button id="throughputHistoryCloseBtn" class="secondary btn-with-icon">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.close">关闭</span>
          </button>
        </div>
      </div>
    </div>
    <div id="monitorDetailModal" class="modal">
      <div class="modal-card">
        <div class="modal-header">
          <div id="monitorDetailTitle" class="detail-title">线程详情</div>
          <div class="modal-header-actions">
            <button id="monitorDetailExport" class="secondary btn-with-icon btn-compact" type="button">
              <i class="fa-solid fa-download"></i>
              <span data-i18n="monitor.detail.export">导出日志</span>
            </button>
            <button id="monitorDetailClose" class="icon-btn" type="button">×</button>
          </div>
        </div>
        <div class="modal-body">
          <div id="monitorDetailMeta" class="muted"></div>
          <div class="form-row">
            <label data-i18n="monitor.detail.question">问题</label>
            <div id="monitorDetailQuestion" class="log"></div>
          </div>
          <div class="form-row">
            <label data-i18n="monitor.detail.events">事件详情</label>
            <div id="monitorDetailEvents" class="log log-collapsible"></div>
          </div>
        </div>
        <div class="modal-actions">
          <button id="monitorDetailCloseBtn" class="secondary btn-with-icon">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.close">关闭</span>
          </button>
        </div>
      </div>
    </div>
    <div id="monitorStatusModal" class="modal">
      <div class="modal-card">
        <div class="modal-header">
          <div>
            <div id="monitorStatusTitle" class="detail-title">线程状态</div>
            <div id="monitorStatusMeta" class="muted"></div>
          </div>
          <button id="monitorStatusClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div class="list-header">
            <label data-i18n="monitor.status.list.title">线程列表</label>
          </div>
          <div id="monitorStatusList" class="list-body monitor-status-list"></div>
        </div>
        <div class="modal-actions">
          <button id="monitorStatusCloseBtn" class="secondary btn-with-icon">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.close">关闭</span>
          </button>
        </div>
      </div>
    </div>
    <div id="memoryModal" class="modal">
      <div class="modal-card modal-card-lg">
        <div class="modal-header">
          <div>
            <div id="memoryModalTitle" class="detail-title" data-i18n="memory.modal.title">记忆记录</div>
            <div id="memoryModalMeta" class="muted"></div>
          </div>
          <button id="memoryModalClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div class="detail-header memory-modal-header">
            <div class="detail-actions">
              <label class="checkbox-row">
                <input id="memoryModalEnableToggle" type="checkbox" />
                <span data-i18n="memory.modal.enable">启用长期记忆</span>
              </label>
              <button id="memoryModalClearBtn" class="danger btn-with-icon btn-compact">
                <i class="fa-solid fa-trash"></i><span data-i18n="common.clear">清空</span>
              </button>
            </div>
          </div>
          <div class="monitor-section-body">
            <div class="monitor-table-scroll">
              <table class="monitor-table memory-record-table">
                <colgroup>
                  <col class="col-memory-session" />
                  <col class="col-memory-record-time" />
                  <col class="col-memory-summary" />
                  <col class="col-memory-record-action" />
                </colgroup>
                <thead>
                  <tr>
                    <th data-i18n="memory.modal.table.session">会话</th>
                    <th data-i18n="memory.modal.table.updatedAt">更新时间</th>
                    <th data-i18n="memory.modal.table.content">记忆内容</th>
                    <th data-i18n="memory.modal.table.action">操作</th>
                  </tr>
                </thead>
                <tbody id="memoryModalRecordBody"></tbody>
              </table>
              <div id="memoryModalRecordEmpty" class="muted" data-i18n="memory.records.empty">暂无记忆记录</div>
            </div>
          </div>
        </div>
        <div class="modal-actions">
          <button id="memoryModalCloseBtn" class="secondary btn-with-icon">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.close">关闭</span>
          </button>
        </div>
      </div>
    </div>
    <div id="memoryRecordEditModal" class="modal">
      <div class="modal-card modal-card-lg">
        <div class="modal-header">
          <div>
            <div id="memoryRecordEditTitle" class="detail-title">编辑记忆</div>
            <div id="memoryRecordEditMeta" class="muted"></div>
          </div>
          <button id="memoryRecordEditClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div class="form-row">
            <label for="memoryRecordEditInput" data-i18n="memory.record.content">记忆内容</label>
            <textarea id="memoryRecordEditInput" class="memory-record-editor"></textarea>
          </div>
        </div>
        <div class="modal-actions">
          <button id="memoryRecordEditCloseBtn" class="secondary btn-with-icon">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.close">关闭</span>
          </button>
          <button id="memoryRecordEditSave" class="btn-with-icon">
            <i class="fa-solid fa-floppy-disk"></i><span data-i18n="common.save">保存</span>
          </button>
        </div>
      </div>
    </div>
    <div id="memoryQueueModal" class="modal">
      <div class="modal-card modal-card-lg">
        <div class="modal-header">
          <div>
            <div id="memoryQueueTitle" class="detail-title">记忆任务详情</div>
            <div id="memoryQueueMeta" class="muted"></div>
          </div>
          <button id="memoryQueueClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div class="form-row">
            <label data-i18n="memory.queue.request">请求内容</label>
            <div id="memoryQueueRequest" class="log"></div>
          </div>
          <div class="form-row">
            <label data-i18n="memory.queue.result">总结结果</label>
            <div id="memoryQueueResult" class="log"></div>
          </div>
        </div>
        <div class="modal-actions">
          <button id="memoryQueueCloseBtn" class="secondary btn-with-icon">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.close">关闭</span>
          </button>
        </div>
      </div>
    </div>
    <div id="monitorToolModal" class="modal">
      <div class="modal-card">
        <div class="modal-header">
          <div>
            <div id="monitorToolTitle" class="detail-title">工具调用</div>
            <div id="monitorToolMeta" class="muted"></div>
          </div>
          <button id="monitorToolClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div class="list-header">
            <label data-i18n="monitor.toolModal.list.title">调用线程</label>
          </div>
          <div id="monitorToolList" class="list-body monitor-status-list"></div>
        </div>
        <div class="modal-actions">
          <button id="monitorToolCloseBtn" class="secondary btn-with-icon">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.close">关闭</span>
          </button>
        </div>
      </div>
    </div>
    <div id="modelOutputPreviewModal" class="modal">
      <div class="modal-card modal-card-lg model-output-preview-card">
        <div class="modal-header">
          <div
            id="modelOutputPreviewTitle"
            class="detail-title"
            data-i18n="debug.output.previewTitle"
          >模型输出预览</div>
          <button id="modelOutputPreviewClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body model-output-preview-body">
          <div class="model-output-preview-content">
            <div id="modelOutputPreviewText" class="model-output-preview-pane model-output-preview-markdown"></div>
            <div id="modelOutputPreviewA2ui" class="model-output-preview-pane a2ui-output"></div>
          </div>
        </div>
      </div>
    </div>
    <div id="planBoardModal" class="modal">
      <div class="modal-card plan-board-card">
        <div class="modal-header">
          <div id="planBoardTitle" class="detail-title" data-i18n="debug.plan.title">计划看板</div>
          <button id="planBoardClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <div id="planBoardExplanation" class="plan-board-explanation"></div>
          <div id="planBoardList" class="plan-board-list"></div>
          <div id="planBoardEmpty" class="plan-board-empty" data-i18n="debug.plan.empty">暂无计划</div>
        </div>
      </div>
    </div>
    <div id="workspaceEditorModal" class="modal">
      <div class="modal-card">
        <div class="modal-header">
          <div>
            <div id="workspaceEditorTitle" class="detail-title">编辑文件</div>
            <div id="workspaceEditorPath" class="muted"></div>
          </div>
          <button id="workspaceEditorClose" class="icon-btn" type="button">×</button>
        </div>
        <div class="modal-body">
          <textarea id="workspaceEditorContent" class="workspace-editor-text"></textarea>
        </div>
        <div class="modal-actions">
          <button id="workspaceEditorCloseBtn" class="secondary btn-with-icon">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.close">关闭</span>
          </button>
          <button id="workspaceEditorSave" class="btn-with-icon">
            <i class="fa-solid fa-floppy-disk"></i><span data-i18n="common.save">保存</span>
          </button>
        </div>
      </div>
    </div>
    <div id="toastContainer" class="toast-container"></div>

  
    <div id="lspConfigModal" class="modal">
      <div class="modal-card modal-card-lg">
        <div class="modal-header">
          <div class="detail-title" data-i18n="lsp.config.title">LSP 配置</div>
          <button id="lspConfigModalClose" class="icon-btn" type="button">&times;</button>
        </div>
        <div class="modal-body">
          <div class="settings-grid">
            <div class="form-row">
              <label for="lspTimeout" data-i18n="lsp.config.timeout">请求超时（秒）</label>
              <input id="lspTimeout" type="number" min="0" step="1" placeholder="30" />
            </div>
            <div class="form-row">
              <label for="lspDiagnosticsDebounce" data-i18n="lsp.config.debounce">诊断去抖（毫秒）</label>
              <input id="lspDiagnosticsDebounce" type="number" min="0" step="10" placeholder="150" />
            </div>
            <div class="form-row">
              <label for="lspIdleTtl" data-i18n="lsp.config.idleTtl">空闲回收（秒）</label>
              <input id="lspIdleTtl" type="number" min="0" step="60" placeholder="1800" />
            </div>
            <div class="form-row">
              <label data-i18n="lsp.config.template">配置模板</label>
              <div class="form-row-inline">
                <select id="lspTemplateSelect">
                  <option value="" data-i18n="lsp.template.select">选择模板</option>
                  <option value="fullstack" data-i18n="lsp.template.fullstack">全栈</option>
                  <option value="frontend" data-i18n="lsp.template.frontend">前端</option>
                  <option value="backend" data-i18n="lsp.template.backend">后端</option>
                  <option value="cpp" data-i18n="lsp.template.cpp">C/C++</option>
                  <option value="ops" data-i18n="lsp.template.ops">运维</option>
                </select>
                <button id="lspTemplateApplyBtn" class="secondary btn-with-icon" type="button">
                  <i class="fa-solid fa-wand-magic-sparkles"></i>
                  <span data-i18n="lsp.template.apply">应用模板</span>
                </button>
              </div>
              <div class="muted" data-i18n="lsp.config.templateHint">
                选择模板后会覆盖服务列表，请先确认保存的配置。
              </div>
            </div>
            <div class="form-row">
              <label for="lspServers" data-i18n="lsp.config.servers">LSP 服务（JSON 数组）</label>
              <textarea
                id="lspServers"
                class="code-preview"
                placeholder='[{"id":"rust-analyzer","command":["rust-analyzer"],"extensions":["rs"],"root_markers":["Cargo.toml"],"enabled":true}]'
              ></textarea>
              <div class="muted" data-i18n="lsp.config.serversHint">
                每个服务需要 id/command，extensions 与 root_markers 用于匹配项目与文件类型。
              </div>
            </div>
          </div>
        </div>
        <div class="modal-actions">
          <button id="lspConfigModalCloseBtn" class="secondary btn-with-icon" type="button">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.close">关闭</span>
          </button>
          <button id="lspSaveBtn" class="btn-with-icon" type="button">
            <i class="fa-solid fa-check"></i><span data-i18n="common.save">保存</span>
          </button>
        </div>
      </div>
    </div>
    <div id="lspStatusModal" class="modal">
      <div class="modal-card">
        <div class="modal-header">
          <div class="detail-title" data-i18n="lsp.status.title">连接状态</div>
          <button id="lspStatusModalClose" class="icon-btn" type="button">&times;</button>
        </div>
        <div class="modal-body">
          <div id="lspStatusList" class="list-body"></div>
        </div>
        <div class="modal-actions">
          <button id="lspRefreshBtn" class="secondary btn-with-icon" type="button">
            <i class="fa-solid fa-arrows-rotate"></i><span data-i18n="common.refresh">刷新</span>
          </button>
          <button id="lspStatusModalCloseBtn" class="btn-with-icon" type="button">
            <i class="fa-solid fa-xmark"></i><span data-i18n="common.close">关闭</span>
          </button>
        </div>
      </div>
    </div>
    <div id="adminLoginModal" class="auth-overlay" aria-hidden="true">
      <div class="auth-card">
        <h2 data-i18n="auth.login.title">管理员登录</h2>
        <p class="auth-subtitle" data-i18n="auth.login.subtitle">首次进入请使用管理员账号</p>
        <form id="adminLoginForm" class="auth-form">
          <label for="adminLoginUsername" data-i18n="auth.login.username">账号</label>
          <input
            id="adminLoginUsername"
            type="text"
            autocomplete="username"
            placeholder="admin"
          />
          <label for="adminLoginPassword" data-i18n="auth.login.password">密码</label>
          <input
            id="adminLoginPassword"
            type="password"
            autocomplete="current-password"
            placeholder="admin"
          />
          <div id="adminLoginError" class="auth-error" role="alert"></div>
          <button id="adminLoginBtn" class="btn-with-icon" type="submit">
            <i class="fa-solid fa-right-to-bracket"></i>
            <span data-i18n="auth.login.action">登录</span>
          </button>
          <div class="auth-hint" data-i18n="auth.login.hint">默认账号：admin / admin</div>
        </form>
      </div>
    </div>
    <script src="./third/echarts/echarts.min.js?v=20260118-07"></script>
    <script src="./third/marked.min.js?v=20260118-07"></script>
    <script type="module" src="./app.js?v=20260124-03"></script>
</body>
</html>
