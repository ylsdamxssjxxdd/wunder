<svg id="my-svg" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="flowchart" style="max-width: 1572.02px; background-color: white;" viewBox="0 0 1572.015625 243" role="graphics-document document" aria-roledescription="flowchart-v2"><style>#my-svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#my-svg .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#my-svg .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#my-svg .error-icon{fill:#552222;}#my-svg .error-text{fill:#552222;stroke:#552222;}#my-svg .edge-thickness-normal{stroke-width:1px;}#my-svg .edge-thickness-thick{stroke-width:3.5px;}#my-svg .edge-pattern-solid{stroke-dasharray:0;}#my-svg .edge-thickness-invisible{stroke-width:0;fill:none;}#my-svg .edge-pattern-dashed{stroke-dasharray:3;}#my-svg .edge-pattern-dotted{stroke-dasharray:2;}#my-svg .marker{fill:#333333;stroke:#333333;}#my-svg .marker.cross{stroke:#333333;}#my-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#my-svg p{margin:0;}#my-svg .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#my-svg .cluster-label text{fill:#333;}#my-svg .cluster-label span{color:#333;}#my-svg .cluster-label span p{background-color:transparent;}#my-svg .label text,#my-svg span{fill:#333;color:#333;}#my-svg .node rect,#my-svg .node circle,#my-svg .node ellipse,#my-svg .node polygon,#my-svg .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#my-svg .rough-node .label text,#my-svg .node .label text,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-anchor:middle;}#my-svg .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#my-svg .rough-node .label,#my-svg .node .label,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-align:center;}#my-svg .node.clickable{cursor:pointer;}#my-svg .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#my-svg .arrowheadPath{fill:#333333;}#my-svg .edgePath .path{stroke:#333333;stroke-width:2.0px;}#my-svg .flowchart-link{stroke:#333333;fill:none;}#my-svg .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#my-svg .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#my-svg .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#my-svg .cluster text{fill:#333;}#my-svg .cluster span{color:#333;}#my-svg div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#my-svg .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#my-svg rect.text{fill:none;stroke-width:0;}#my-svg .icon-shape,#my-svg .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#my-svg .icon-shape p,#my-svg .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#my-svg .icon-shape rect,#my-svg .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#my-svg .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#my-svg .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#my-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker id="my-svg_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><g class="root"><g class="clusters"/><g class="edgePaths"><path d="M223.516,140L227.682,140C231.849,140,240.182,140,247.849,140C255.516,140,262.516,140,266.016,140L269.516,140" id="L_User_Context_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_User_Context_0" data-points="W3sieCI6MjIzLjUxNTYyNSwieSI6MTQwfSx7IngiOjI0OC41MTU2MjUsInkiOjE0MH0seyJ4IjoyNzMuNTE1NjI1LCJ5IjoxNDB9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M458.047,140L462.214,140C466.38,140,474.714,140,482.38,140C490.047,140,497.047,140,500.547,140L504.047,140" id="L_Context_LLM_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_Context_LLM_0" data-points="W3sieCI6NDU4LjA0Njg3NSwieSI6MTQwfSx7IngiOjQ4My4wNDY4NzUsInkiOjE0MH0seyJ4Ijo1MDguMDQ2ODc1LCJ5IjoxNDB9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M703.14,113L713.054,109.667C722.969,106.333,742.797,99.667,756.211,96.333C769.625,93,776.625,93,780.125,93L783.625,93" id="L_LLM_Decide_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_LLM_Decide_0" data-points="W3sieCI6NzAzLjE0MDI5MjU1MzE5MTQsInkiOjExM30seyJ4Ijo3NjIuNjI1LCJ5Ijo5M30seyJ4Ijo3ODcuNjI1LCJ5Ijo5M31d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M885.958,73.333L898.736,66.944C911.514,60.556,937.069,47.778,958.681,41.389C980.292,35,997.958,35,1006.792,35L1015.625,35" id="L_Decide_ToolPlan_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_Decide_ToolPlan_0" data-points="W3sieCI6ODg1Ljk1ODMzMzMzMzMzMzQsInkiOjczLjMzMzMzMzMzMzMzMzMzfSx7IngiOjk2Mi42MjUsInkiOjM1fSx7IngiOjEwMTkuNjI1LCJ5IjozNX1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1175.625,35L1179.792,35C1183.958,35,1192.292,35,1199.958,35C1207.625,35,1214.625,35,1218.125,35L1221.625,35" id="L_ToolPlan_ToolExec_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_ToolPlan_ToolExec_0" data-points="W3sieCI6MTE3NS42MjUsInkiOjM1fSx7IngiOjEyMDAuNjI1LCJ5IjozNX0seyJ4IjoxMjI1LjYyNSwieSI6MzV9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1390.016,35L1394.182,35C1398.349,35,1406.682,35,1419.538,45.487C1432.394,55.973,1449.771,76.947,1458.46,87.433L1467.149,97.92" id="L_ToolExec_Observe_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_ToolExec_Observe_0" data-points="W3sieCI6MTM5MC4wMTU2MjUsInkiOjM1fSx7IngiOjE0MTUuMDE1NjI1LCJ5IjozNX0seyJ4IjoxNDY5LjcwMTMzOTI4NTcxNDMsInkiOjEwMX1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M1466.3,179L1457.752,188.333C1449.205,197.667,1432.11,216.333,1405.697,225.667C1379.284,235,1343.552,235,1307.82,235C1272.089,235,1236.357,235,1201.324,235C1166.292,235,1131.958,235,1092.292,235C1052.625,235,1007.625,235,965.792,235C923.958,235,885.292,235,851.958,235C818.625,235,790.625,235,760.5,224.041C730.375,213.083,698.124,191.166,681.999,180.207L665.874,169.248" id="L_Observe_LLM_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_Observe_LLM_0" data-points="W3sieCI6MTQ2Ni4yOTk4MzU1MjYzMTU3LCJ5IjoxNzl9LHsieCI6MTQxNS4wMTU2MjUsInkiOjIzNX0seyJ4IjoxMzA3LjgyMDMxMjUsInkiOjIzNX0seyJ4IjoxMjAwLjYyNSwieSI6MjM1fSx7IngiOjEwOTcuNjI1LCJ5IjoyMzV9LHsieCI6OTYyLjYyNSwieSI6MjM1fSx7IngiOjg0Ni42MjUsInkiOjIzNX0seyJ4Ijo3NjIuNjI1LCJ5IjoyMzV9LHsieCI6NjYyLjU2NTQ2MDUyNjMxNTcsInkiOjE2N31d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M885.958,112.667L898.736,119.056C911.514,125.444,937.069,138.222,960.014,144.611C982.958,151,1003.292,151,1013.458,151L1023.625,151" id="L_Decide_Final_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_Decide_Final_0" data-points="W3sieCI6ODg1Ljk1ODMzMzMzMzMzMzQsInkiOjExMi42NjY2NjY2NjY2NjY2N30seyJ4Ijo5NjIuNjI1LCJ5IjoxNTF9LHsieCI6MTAyNy42MjUsInkiOjE1MX1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" data-id="L_User_Context_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_Context_LLM_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_LLM_Decide_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(962.625, 35)"><g class="label" data-id="L_Decide_ToolPlan_0" transform="translate(-32, -12)"><foreignObject width="64" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>工具调用</p></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_ToolPlan_ToolExec_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_ToolExec_Observe_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" data-id="L_Observe_LLM_0" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(962.625, 151)"><g class="label" data-id="L_Decide_Final_0" transform="translate(-32, -12)"><foreignObject width="64" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>最终回复</p></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-User-0" transform="translate(115.7578125, 140)"><rect class="basic label-container" style="" x="-107.7578125" y="-27" width="215.515625" height="54"/><g class="label" style="" transform="translate(-77.7578125, -12)"><rect/><foreignObject width="155.515625" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>用户输入(user_round)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-Context-1" transform="translate(365.78125, 140)"><rect class="basic label-container" style="" x="-92.265625" y="-39" width="184.53125" height="78"/><g class="label" style="" transform="translate(-62.265625, -24)"><rect/><foreignObject width="124.53125" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>上下文构建<br />(历史/工具/记忆)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-LLM-3" transform="translate(622.8359375, 140)"><rect class="basic label-container" style="" x="-114.7890625" y="-27" width="229.578125" height="54"/><g class="label" style="" transform="translate(-84.7890625, -12)"><rect/><foreignObject width="169.578125" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>模型调用(model_round)</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-Decide-5" transform="translate(846.625, 93)"><polygon points="59,0 118,-59 59,-118 0,-59" class="label-container" transform="translate(-58.5, 59)"/><g class="label" style="" transform="translate(-32, -12)"><rect/><foreignObject width="64" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>输出类型</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-ToolPlan-7" transform="translate(1097.625, 35)"><rect class="basic label-container" style="" x="-78" y="-27" width="156" height="54"/><g class="label" style="" transform="translate(-48, -12)"><rect/><foreignObject width="96" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>解析工具意图</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-ToolExec-9" transform="translate(1307.8203125, 35)"><rect class="basic label-container" style="" x="-82.1953125" y="-27" width="164.390625" height="54"/><g class="label" style="" transform="translate(-52.1953125, -12)"><rect/><foreignObject width="104.390625" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>执行工具/沙盒</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-Observe-11" transform="translate(1502.015625, 140)"><rect class="basic label-container" style="" x="-62" y="-39" width="124" height="78"/><g class="label" style="" transform="translate(-32, -24)"><rect/><foreignObject width="64" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>结果回填<br />事件记录</p></span></div></foreignObject></g></g><g class="node default" id="flowchart-Final-15" transform="translate(1097.625, 151)"><rect class="basic label-container" style="" x="-70" y="-39" width="140" height="78"/><g class="label" style="" transform="translate(-40, -24)"><rect/><foreignObject width="80" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>最终回复<br />释放会话锁</p></span></div></foreignObject></g></g></g></g></g></svg>