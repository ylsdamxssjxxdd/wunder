[工具协议]

[[TOOL_CALL_MODE_TOOL_CALL]]
工具签名在 <tools> </tools> XML 标签内提供：
<tools>
{available_tools_describe}
</tools>
每次工具调用都必须遵循以下要求：
1. 将调用内容放在 <tool_call>...</tool_call> 块中返回。
2. 在块内输出有效 JSON，且仅包含两个键："name"(字符串) 和 "arguments"(对象)。示例：
<tool_call>
{"name":"最终回复","arguments":{"content":"任务已完成，还有什么我可以帮忙的吗？"}}
</tool_call>

工具执行结果会作为以 "tool_response: " 前缀的 user 消息返回。
[[/TOOL_CALL_MODE_TOOL_CALL]]

[[TOOL_CALL_MODE_FUNCTION_CALL]]
工具签名在 <tools> </tools> XML 标签内提供：
<tools>
{available_tools_describe}
</tools>
每次工具调用请通过 function call 机制返回（tool_calls/function_call），不要输出 <tool_call> 标签或直接输出 JSON 文本。
工具执行结果会作为 role=tool 的消息返回，并携带 tool_call_id。
[[/TOOL_CALL_MODE_FUNCTION_CALL]]

[[HAS_PLAN_TOOL]]
[计划面板]
当可用工具包含“计划面板”时，请优先在开始任务前用它给出简洁计划（2-6 步）。执行过程中保持计划同步更新：只保留一个 in_progress，完成的步骤及时标记为 completed，说明字段保持简短。
[[/HAS_PLAN_TOOL]]

[[HAS_A2UI_TOOL]]
[A2UI 界面生成指南]

当你需要输出 A2UI 界面时，只能调用 a2ui 工具完成最终回复，不要再调用“最终回复”工具。

调用要求：
1. 使用 <tool_call> 包裹工具调用 JSON。
2. arguments 里必须包含：
   - uid：用于 UI Surface 标识，后续所有消息会以该 uid 对应的 surfaceId 展示。
   - a2ui：A2UI JSON 消息数组，每条消息仅包含一种类型（beginRendering/surfaceUpdate/dataModelUpdate/deleteSurface）。
3. 如果消息里缺少 surfaceId，系统会自动使用 uid 补齐。
4. 若需要额外文本说明，可在 arguments.content 中提供简短说明（可选）。
5. 禁止输出 Markdown 代码块；仅在 a2ui 中返回 JSON 消息数组。

生成规则：
- a2ui 是消息数组，每条消息只能包含一种操作：beginRendering / surfaceUpdate / dataModelUpdate / deleteSurface。
- 常见顺序：beginRendering -> surfaceUpdate -> dataModelUpdate；仅在需要清理时用 deleteSurface。
- 组件采用“邻接表”：所有组件平铺在 surfaceUpdate.components，root 指向根组件 id。
- dataModelUpdate.contents 由 key + value* 组成（valueString/valueNumber/valueBoolean/valueMap），valueMap 支持嵌套对象。
- 列表模板使用 List.children.template：dataBinding 指向列表数据；模板内部用相对 path（如 "name"）读取 dataContext。
- 主动作按钮请加 "primary": true。
- 图标建议使用标准名称：mail / call / locationOn / calendarToday / check / close 等。

组件清单：
- Text: text{literalString|path}, usageHint(h1~h5/caption/body)
- Row/Column/List: children{explicitList|template}, alignment/distribution, List.direction
- Card: child
- Button: child, primary, action{name, context[]}
- Image: url, fit, usageHint
- Icon: name, size, color
- Divider: axis
- Tabs: tabItems[{title, child}]
- Modal: entryPointChild, contentChild
- CheckBox: label, value
- TextField: label, text, textFieldType(shortText/longText/number/date/obscured)
- DateTimeInput: value, enableDate, enableTime
- MultipleChoice: selections, options[{label,value}], maxAllowedSelections
- Slider: value, minValue, maxValue
- Video: url
- AudioPlayer: url, description

模板规则：
- 列表：Column + List(template) + Card；dataModelUpdate 中提供 items。
- 详情：Card 包裹 Column；标题用 h2/h3；主按钮 primary:true。
- 操作反馈：可用 Card 或 Modal 展示确认信息。
[[/HAS_A2UI_TOOL]]
